<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>FEEBEA - A Color Story</title>
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Pacifico&family=Great+Vibes&family=Cinzel:wght@400;600&family=Zhi+Mang+Xing&family=Long+Cang&family=Noto+Serif+SC:wght@400;600;700&display=swap"
            rel="stylesheet"
        />
        <!-- Gabriel Weiss Friends Font -->
        <link
            href="https://fonts.cdnfonts.com/css/gabriel-weiss-friends-font"
            rel="stylesheet"
        />
        <!-- Backup Friends-style font -->
        <link
            href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&display=swap"
            rel="stylesheet"
        />
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                /* 强制禁止所有元素的文本选中 */
                user-select: none !important;
                -webkit-user-select: none !important;
                -moz-user-select: none !important;
                -ms-user-select: none !important;
            }

            /* 添加平滑滚动支持 */
            html {
                scroll-behavior: smooth;
                /* 隐藏滚动条 */
                scrollbar-width: none; /* Firefox */
                -ms-overflow-style: none; /* IE 10+ */
            }

            /* 隐藏 Webkit 浏览器的滚动条 */
            html::-webkit-scrollbar {
                display: none;
                width: 0;
                height: 0;
            }

            body {
                font-family: "Dancing Script", cursive;
                background: linear-gradient(
                    135deg,
                    #0a0a0a 0%,
                    #1a1a1a 50%,
                    #2a2a2a 100%
                );
                min-height: 100vh;
                overflow-x: hidden;
                color: #feebea;
                transition: all 0.3s ease;
                /* 禁止文本选中 */
                user-select: none;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                /* 增强滚动性能 */
                scroll-behavior: smooth;
                /* 隐藏滚动条 */
                scrollbar-width: none; /* Firefox */
                -ms-overflow-style: none; /* IE 10+ */
            }

            /* 隐藏 Webkit 浏览器的滚动条 */
            body::-webkit-scrollbar {
                display: none;
                width: 0;
                height: 0;
            }

            /* 无缝滚动容器样式 */
            #infinite-scroll-container {
                height: 100vh;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
                scrollbar-width: none; /* Firefox */
                -ms-overflow-style: none; /* IE 10+ */
            }
            #infinite-scroll-container::-webkit-scrollbar {
                display: none; /* Chrome/Safari/Webkit */
            }
            body {
                overflow: hidden !important; /* 防止body出现滚动条 */
            }

            /* 滚动容器优化 */
            .container {
                scroll-behavior: smooth;
            }

            /* 为section添加滚动间距 */
            section {
                scroll-margin-top: 2rem;
                position: relative;
            }

            /* 平滑滚动动画增强 */
            @media (prefers-reduced-motion: no-preference) {
                html {
                    scroll-behavior: smooth;
                }
            }

            /* 为不支持scroll-behavior的浏览器提供备用方案 */
            @supports not (scroll-behavior: smooth) {
                html {
                    scroll-behavior: auto;
                }
            }

            .lang-toggle {
                position: fixed;
                top: 1rem;
                left: 1rem;
                z-index: 1000;
                background: rgba(254, 235, 234, 0.1);
                border-radius: 20px;
                padding: 0.5rem 1rem;
                font-family: "Dancing Script", cursive;
                font-size: 1.1rem;
                cursor: pointer;
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
                display: flex;
                align-items: center;
                gap: 0.3rem;
            }

            .lang-toggle:hover {
                background: rgba(254, 235, 234, 0.15);
                transform: scale(1.05);
                box-shadow: 0 0 15px rgba(254, 235, 234, 0.2);
            }

            .lang-option {
                transition: all 0.3s ease;
                padding: 0.2rem 0.4rem;
                border-radius: 8px;
            }

            .lang-option.active {
                color: #feebea;
                background: rgba(254, 235, 234, 0.2);
                text-shadow: 0 0 8px rgba(254, 235, 234, 0.5);
            }

            .lang-option.inactive {
                color: rgba(254, 235, 234, 0.6);
            }

            .lang-separator {
                color: rgba(254, 235, 234, 0.4);
                font-weight: 300;
            }

            .container {
                max-width: 900px;
                margin: 0 auto;
                padding: 2rem 1rem;
            }

            .header {
                text-align: center;
                margin-bottom: 3rem;
                animation: fadeIn 2s ease-out;
            }

            .main-title {
                font-family: "Great Vibes", cursive;
                font-size: 4rem;
                font-weight: 400;
                color: #feebea;
                text-shadow: 0 0 30px rgba(254, 235, 234, 0.3);
                margin-bottom: 1rem;
                letter-spacing: 0.05em;
            }

            .subtitle {
                font-family: "Dancing Script", cursive;
                font-size: 1.4rem;
                color: #feebea;
                font-weight: 400;
                opacity: 0.8;
                margin-bottom: 1.5rem;
            }

            .tribute {
                font-family: "Dancing Script", cursive;
                font-size: 0.9rem; /* Changed from 1rem */
                color: #feebea; /* Changed from #888 */
                font-style: italic;
                opacity: 0.6;
                transition: all 0.3s ease;
            }

            .main-title:hover {
                color: #fff;
                text-shadow: 0 0 40px rgba(254, 235, 234, 0.6);
                transform: scale(1.02);
                transition: all 0.3s ease;
            }

            .tribute:hover {
                opacity: 1;
                color: #fff;
                transform: scale(1.05);
                text-shadow: 0 0 20px rgba(254, 235, 234, 0.4);
            }

            /* Chinese fonts - keep English fonts for better appearance */
            body.chinese .tribute {
                font-family: "Dancing Script", cursive;
                font-size: 0.9rem;
            }

            body.chinese .meditation-text {
                font-family: "Dancing Script", cursive;
                font-size: 1.6rem;
                line-height: 1.8;
                color: #feebea;
                opacity: 0.9;
                max-width: 650px;
                margin: 0 auto;
                font-weight: 400;
                text-align: center;
            }

            body.chinese .essence-title {
                font-family: "Pacifico", cursive;
                font-size: clamp(0.9rem, 2.5vw, 1.3rem);
                margin-bottom: 0.5rem;
                color: #feebea;
                cursor: text;
                user-select: text;
                word-wrap: break-word;
                overflow-wrap: break-word;
                line-height: 1.2;
                max-width: 100%;
            }

            body.chinese .essence-desc {
                font-family: "Dancing Script", cursive;
                font-size: clamp(0.8rem, 2vw, 1rem);
                color: #feebea;
                opacity: 0.8;
                cursor: text;
                user-select: text;
                word-wrap: break-word;
                overflow-wrap: break-word;
                line-height: 1.1;
                max-width: 100%;
            }

            body.chinese .final-text {
                font-family: "Great Vibes", cursive;
                font-size: 2rem;
                color: #feebea;
                opacity: 0.7;
            }

            body.chinese .quote-text {
                font-family: "Cinzel", serif;
                line-height: 1.8;
                color: #feebea;
                opacity: 0.9;
                max-width: 600px;
                margin: 0 auto 1.5rem;
                font-weight: 400;
                font-style: italic;
            }

            body.chinese .quote-text {
                text-align: center;
            }

            .quote-author {
                font-family: "Dancing Script", cursive;
                color: #feebea;
                opacity: 0.7;
                display: inline;
            }

            body.chinese .quote-author {
                font-family: "Dancing Script", cursive;
                color: #feebea;
                opacity: 0.7;
                display: inline;
            }

            body.chinese .phoebe-title {
                font-family: "Pacifico", cursive;
                font-size: 2rem;
                color: #feebea;
                margin-bottom: 1.5rem;
            }

            body.chinese .phoebe-quote {
                font-family: "Dancing Script", cursive;
                font-size: 1.3rem;
                color: #feebea;
                opacity: 0.9;
                line-height: 1.6;
                max-width: 450px;
                margin: 0 auto;
                font-style: italic;
            }

            .color-display {
                display: flex;
                justify-content: center;
                margin-bottom: 3rem;
                animation: pulse 3s infinite ease-in-out;
            }

            .color-circle {
                width: 250px;
                height: 250px;
                background: #feebea;
                border-radius: 50%;
                box-shadow:
                    0 0 60px rgba(254, 235, 234, 0.4),
                    0 0 120px rgba(254, 235, 234, 0.2),
                    inset 0 0 60px rgba(255, 255, 255, 0.1);
                position: relative;
                overflow: hidden;
                cursor: pointer;
                transition: all 0.5s ease;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .color-circle:hover {
                transform: scale(1.05);
                box-shadow:
                    0 0 80px rgba(254, 235, 234, 0.6),
                    0 0 160px rgba(254, 235, 234, 0.3);
            }

            .color-circle::before {
                content: "";
                position: absolute;
                top: -50%;
                left: -50%;
                width: 200%;
                height: 200%;
                background: linear-gradient(
                    45deg,
                    transparent,
                    rgba(255, 255, 255, 0.1),
                    transparent
                );
                animation: rotate 4s linear infinite;
                z-index: 1;
            }

            .zima-square {
                width: 12px;
                height: 12px;
                background: #5bc2e7;
                position: fixed;
                z-index: 9999;
                box-shadow: 0 0 10px rgba(91, 194, 231, 0.5);
                opacity: 0;
                animation: zimaAppear 1s ease-out forwards;
                pointer-events: auto;
                border-radius: 0;
                cursor: pointer;
                transition: background-color 0.3s ease;
            }

            .zima-square.feebea-flash {
                background: #feebea !important;
            }

            .zima-square.warning-flash {
                background: #d93c46 !important;
            }

            .zima-square-small {
                width: 8px;
                height: 8px;
            }

            .zima-square-large {
                width: 16px;
                height: 16px;
            }

            .zima-square-xl {
                width: 20px;
                height: 20px;
            }

            @keyframes zimaAppear {
                0% {
                    opacity: 0;
                    transform: scale(0);
                }
                100% {
                    opacity: 1;
                    transform: scale(1);
                }
            }

            .color-info {
                text-align: center;
                margin-bottom: 3rem;
            }

            .color-codes {
                display: inline-block;
                background: rgba(254, 235, 234, 0.05);
                border: 1px solid rgba(254, 235, 234, 0.2);
                border-radius: 20px;
                padding: 1.5rem;
                backdrop-filter: blur(10px);
            }

            .code-item {
                font-family: "Dancing Script", cursive;
                font-size: 1.2rem;
                margin: 0.8rem 0;
                cursor: pointer;
                transition: color 0.3s ease;
                font-weight: 600;
            }

            .code-item:hover {
                color: #fff;
                text-shadow: 0 0 10px rgba(254, 235, 234, 0.5);
            }

            .quote-section {
                text-align: center;
                margin: 4rem 0;
                padding: 2rem;
                background: rgba(254, 235, 234, 0.03);
                border: 1px solid rgba(254, 235, 234, 0.1);
                border-radius: 20px;
                backdrop-filter: blur(5px);
                animation: fadeInUp 2s ease-out 1s both;
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 1rem;
                flex-wrap: wrap;
                cursor: pointer;
                user-select: none;
                transition: all 0.3s ease;
                position: relative;
                height: 9rem;
                min-height: 9rem;
                max-height: 9rem;
                overflow: hidden;
            }

            .quote-section:hover {
                background: rgba(254, 235, 234, 0.05);
                border-color: rgba(254, 235, 234, 0.15);
                transform: translateY(-2px);
                box-shadow: 0 8px 25px rgba(254, 235, 234, 0.1);
            }

            .quote-section:active {
                transform: translateY(0);
                background: rgba(254, 235, 234, 0.08);
            }

            .quote-section::before {
                content: '← →';
                position: absolute;
                top: 10px;
                right: 15px;
                font-size: 0.8rem;
                color: rgba(254, 235, 234, 0.4);
                font-family: monospace;
                pointer-events: none;
            }

            .quote-section::after {
                content: 'Use arrow keys or swipe to navigate';
                position: absolute;
                bottom: 10px;
                right: 15px;
                font-size: 0.7rem;
                color: rgba(254, 235, 234, 0.3);
                font-family: 'Dancing Script', cursive;
                pointer-events: none;
                opacity: 0;
                transition: opacity 0.3s ease;
            }

            .quote-section:hover::after {
                opacity: 1;
            }

            @media (max-width: 768px) {
                .quote-section::after {
                    content: 'Swipe left/right to navigate';
                    font-size: 0.6rem;
                }
                
                .quote-section::before {
                    content: '← →';
                    font-size: 0.7rem;
                }
            }

            .quote-text {
                font-family: "Cinzel", serif;
                line-height: 1.3;
                color: #feebea;
                opacity: 0.9;
                font-weight: 400;
                font-style: italic;
                margin: 0;
                width: 100%;
                text-align: center;
                max-height: 100%;
                overflow: hidden;
                word-wrap: break-word;
                hyphens: auto;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .quote-author {
                font-family: "Dancing Script", cursive;
                color: #feebea;
                opacity: 0.7;
                margin: 0;
                white-space: nowrap;
                display: inline;
            }

            .meditation {
                text-align: center;
                margin: 4rem 0;
                animation: fadeInUp 2s ease-out 1s both;
            }

            .meditation-text {
                font-family: "Dancing Script", cursive;
                font-size: 1.6rem;
                line-height: 1.8;
                color: #feebea;
                opacity: 0.9;
                max-width: 650px;
                margin: 0 auto;
                font-weight: 400;
                text-align: center; /* Changed from left */
            }

            .essence {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 1.5rem;
                margin: 3rem 0;
                padding: 2rem 0;
                justify-items: center;
                width: 100%;
            }

            .essence-card {
                background: rgba(254, 235, 234, 0.03);
                border: 1px solid rgba(254, 235, 234, 0.1);
                border-radius: 15px;
                padding: 2rem;
                text-align: center;
                backdrop-filter: blur(5px);
                transition: all 0.3s ease;
                cursor: pointer;
                position: relative;
                width: 100%;
                max-width: 450px;
                height: 220px;
                display: flex;
                flex-direction: column;
                justify-content: space-between;
                align-items: center;
                margin-top: 10px;
            }

            .essence-card:hover {
                background: rgba(254, 235, 234, 0.08);
                transform: translateY(-5px);
            }

            .essence-title {
                font-family: "Pacifico", cursive;
                font-size: clamp(1.2rem, 3.5vw, 1.7rem);
                margin-bottom: 0.8rem;
                color: #feebea;
                cursor: text;
                user-select: text;
                word-wrap: break-word;
                overflow-wrap: break-word;
                line-height: 1.2;
                max-width: 100%;
                width: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                text-align: center;
                flex: 1;
            }

            .essence-desc {
                font-family: "Dancing Script", cursive;
                font-size: clamp(1rem, 2.8vw, 1.4rem);
                color: #feebea;
                opacity: 0.8;
                cursor: text;
                user-select: text;
                word-wrap: break-word;
                overflow-wrap: break-word;
                line-height: 1.1;
                max-width: 100%;
                width: 100%;
                display: flex;
                align-items: flex-end;
                justify-content: center;
                text-align: center;
                margin-top: auto;
            }

            .quote-clickable {
                cursor: pointer;
                user-select: text;
            }

            .quote-clickable:hover {
                opacity: 1;
            }

            .phoebe-section {
                text-align: center;
                margin: 4rem 0;
                padding: 2rem;
                background: linear-gradient(
                    45deg,
                    rgba(254, 235, 234, 0.05),
                    rgba(254, 235, 234, 0.1)
                );
                border-radius: 20px;
                border: 1px solid rgba(254, 235, 234, 0.2);
                backdrop-filter: blur(10px);
            }

            .phoebe-title {
                font-family: "Pacifico", cursive;
                font-size: 2rem;
                color: #feebea;
                margin-bottom: 1.5rem;
            }

            .phoebe-quote {
                font-family: "Dancing Script", cursive;
                font-size: 1.3rem;
                color: #feebea;
                opacity: 0.9;
                line-height: 1.6;
                max-width: 450px;
                margin: 0 auto;
                font-style: italic;
            }

            .final-tribute {
                text-align: center;
                margin-top: 4rem;
                padding: 2rem;
                border-top: 1px solid rgba(254, 235, 234, 0.2);
            }

            .final-text {
                font-family: "Great Vibes", cursive;
                font-size: 2rem;
                color: #feebea;
                opacity: 0.7;
            }

            .footer-content {
                display: flex;
                align-items: center;
                justify-content: center;
                gap: 2rem;
                flex-wrap: wrap;
            }

            .contact-icons {
                display: flex;
                gap: 1rem;
                align-items: center;
            }

            .email-icon,
            .wechat-icon {
                display: flex;
                align-items: center;
                gap: 0.4rem;
                font-size: 1.2rem;
                color: #feebea;
                cursor: pointer;
                transition: opacity 0.2s ease;
                user-select: none;
                text-decoration: none;
            }

            .email-icon:hover,
            .wechat-icon:hover {
                opacity: 0.8;
            }

            .email-icon svg,
            .wechat-icon svg {
                flex-shrink: 0;
            }

            .copy-notification {
                position: fixed;
                top: 1rem;
                right: 1rem;
                background: #feebea;
                color: #333;
                padding: 0.8rem 1.5rem;
                border-radius: 25px;
                font-family: "Dancing Script", cursive;
                font-size: 1rem;
                font-weight: 600;
                opacity: 0;
                transform: translateY(-20px);
                transition: all 0.3s ease;
                z-index: 1000;
                max-width: 200px;
                text-align: center;
            }

            .copy-notification.show {
                opacity: 1;
                transform: translateY(0);
            }

            .hidden {
                display: none;
            }

            @keyframes fadeIn {
                from {
                    opacity: 0;
                    transform: translateY(50px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes fadeInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }

            @keyframes pulse {
                0%,
                100% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.02);
                }
            }

            @keyframes rotate {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }

            @keyframes fallFromTop {
                0% {
                    transform: translate(-50%, -150%);
                    opacity: 0;
                }
                100% {
                    transform: translate(-50%, -50%);
                    opacity: 1;
                }
            }

            @keyframes fallFromTopLeft {
                0% {
                    transform: translate(-150%, -150%);
                    opacity: 0;
                }
                100% {
                    transform: translate(-50%, -50%);
                    opacity: 1;
                }
            }

            @keyframes fallFromTopRight {
                0% {
                    transform: translate(50%, -150%);
                    opacity: 0;
                }
                100% {
                    transform: translate(-50%, -50%);
                    opacity: 1;
                }
            }

            @keyframes fallAndBounce {
                0% {
                    transform: translate(-50%, -150%);
                    opacity: 0;
                }
                70% {
                    transform: translate(-50%, -45%);
                    opacity: 1;
                }
                85% {
                    transform: translate(-50%, -52%);
                }
                100% {
                    transform: translate(-50%, -50%);
                    opacity: 1;
                }
            }

            @keyframes glow {
                0% {
                    text-shadow:
                        0 0 20px rgba(254, 235, 234, 0.8),
                        0 0 40px rgba(254, 235, 234, 0.6),
                        0 0 80px rgba(254, 235, 234, 0.4),
                        0 0 120px rgba(254, 235, 234, 0.2);
                }
                100% {
                    text-shadow:
                        0 0 30px rgba(254, 235, 234, 1),
                        0 0 60px rgba(254, 235, 234, 0.8),
                        0 0 120px rgba(254, 235, 234, 0.6),
                        0 0 180px rgba(254, 235, 234, 0.4);
                }
            }

            /* High-performance text splitting and portal effects */
            .rick-portal {
                position: fixed;
                transform: translate(-50%, -50%);
                z-index: 5000;
                opacity: 0;
                transition: opacity 1s ease-in-out;
                pointer-events: none;
                will-change: opacity;
                text-align: center;
            }

            .rick-portal.show {
                opacity: 1;
            }

            .rick-portal img {
                width: 300px;
                height: 300px;
                animation:
                    portal-fast-spin 20s ease-in-out forwards,
                    portal-glow 20s ease-in-out forwards;
                will-change: transform, opacity, filter, box-shadow;
                transform: translateZ(0);
                position: relative;
                z-index: 5;
                border-radius: 50%;
            }

            .rick-message {
                font-family: "Dancing Script", cursive;
                font-size: 2rem;
                color: #feebea;
                font-weight: 600;
                text-shadow: 0 0 20px rgba(254, 235, 234, 0.8);
                margin-top: 2rem;
                min-height: 3rem;
                z-index: 10;
                position: relative;
            }

            @keyframes portal-fast-spin {
                0% {
                    transform: rotate3d(0, 0, 1, 0deg) scale3d(1, 1, 1);
                    opacity: 1;
                    animation-timing-function: ease-out;
                }
                25% {
                    transform: rotate3d(0, 0, 1, 360deg) scale3d(1.4, 1.4, 1);
                    opacity: 1;
                    animation-timing-function: ease-out;
                }
                50% {
                    transform: rotate3d(0, 0, 1, 720deg) scale3d(1.8, 1.8, 1);
                    opacity: 1;
                    animation-timing-function: ease-out;
                }
                75% {
                    transform: rotate3d(0, 0, 1, 1080deg) scale3d(2, 2, 1);
                    opacity: 1;
                    animation-timing-function: linear;
                }
                85% {
                    transform: rotate3d(0, 0, 1, 1440deg) scale3d(2, 2, 1);
                    opacity: 1;
                    animation-timing-function: linear;
                }
                90% {
                    transform: rotate3d(0, 0, 1, 2160deg) scale3d(1.5, 1.5, 1);
                    opacity: 0.8;
                    animation-timing-function: cubic-bezier(
                        0.755,
                        0.05,
                        0.855,
                        0.06
                    );
                }
                95% {
                    transform: rotate3d(0, 0, 1, 3600deg) scale3d(0.5, 0.5, 1);
                    opacity: 0.3;
                    animation-timing-function: cubic-bezier(
                        0.95,
                        0.05,
                        0.795,
                        0.035
                    );
                }
                98% {
                    transform: rotate3d(0, 0, 1, 4680deg) scale3d(0.1, 0.1, 1);
                    opacity: 0.1;
                    animation-timing-function: cubic-bezier(
                        0.98,
                        0.02,
                        0.82,
                        0.01
                    );
                }
                100% {
                    transform: rotate3d(0, 0, 1, 5400deg) scale3d(0, 0, 1);
                    opacity: 0;
                }
            }

            @keyframes portal-glow {
                0% {
                    box-shadow:
                        0 0 20px #00ff88,
                        0 0 40px #00ff88,
                        0 0 60px #00ff88,
                        inset 0 0 20px rgba(0, 255, 136, 0.3);
                    filter: brightness(1.2) saturate(1.5);
                }
                25% {
                    box-shadow:
                        0 0 50px #00ff88,
                        0 0 100px #00ff88,
                        0 0 150px #00ff88,
                        inset 0 0 50px rgba(0, 255, 136, 0.4);
                    filter: brightness(1.6) saturate(2);
                }
                50% {
                    box-shadow:
                        0 0 80px #00ccff,
                        0 0 160px #00ccff,
                        0 0 240px #00ccff,
                        inset 0 0 80px rgba(0, 204, 255, 0.5);
                    filter: brightness(1.8) saturate(2.2);
                }
                75% {
                    box-shadow:
                        0 0 100px #8800ff,
                        0 0 200px #8800ff,
                        0 0 300px #8800ff,
                        inset 0 0 100px rgba(136, 0, 255, 0.6);
                    filter: brightness(2) saturate(2.5);
                }
                85% {
                    box-shadow:
                        0 0 120px #ff0088,
                        0 0 240px #ff0088,
                        0 0 360px #ff0088,
                        inset 0 0 120px rgba(255, 0, 136, 0.7);
                    filter: brightness(2.2) saturate(3);
                }
                90% {
                    box-shadow:
                        0 0 60px #ffaa00,
                        0 0 120px #ffaa00,
                        0 0 180px #ffaa00,
                        inset 0 0 60px rgba(255, 170, 0, 0.5);
                    filter: brightness(1.8) saturate(2);
                }
                95% {
                    box-shadow:
                        0 0 20px #ffffff,
                        0 0 40px #ffffff,
                        0 0 60px #ffffff,
                        inset 0 0 20px rgba(255, 255, 255, 0.3);
                    filter: brightness(1.2) saturate(1.2);
                }
                98% {
                    box-shadow:
                        0 0 5px #ffffff,
                        0 0 10px #ffffff,
                        0 0 15px #ffffff,
                        inset 0 0 5px rgba(255, 255, 255, 0.1);
                    filter: brightness(0.6) saturate(0.8);
                }
                100% {
                    box-shadow: none;
                    filter: brightness(0.2) saturate(0.3);
                }
            }

            /* Letter splitting and distortion effects */
            .letter-particle {
                display: inline-block;
                position: relative;
                will-change: transform, opacity;
                transform-style: preserve-3d;
                backface-visibility: hidden;
                transform: translateZ(0);
            }

            .letter-exploding {
                animation: letter-explode var(--duration, 2s) var(--delay, 0s)
                    ease-out forwards;
            }

            @keyframes letter-explode {
                0% {
                    transform: translate3d(0, 0, 0) rotate3d(0, 0, 1, 0deg)
                        scale3d(1, 1, 1) skew(0deg, 0deg);
                    opacity: 1;
                    filter: blur(0px);
                    animation-timing-function: ease-in;
                }
                15% {
                    transform: translate3d(
                            calc(var(--dx) * 0.01),
                            calc(var(--dy) * 0.01),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 8deg))
                        scale3d(1.02, 0.98, 1) skew(2deg, 1deg);
                    opacity: 0.99;
                    filter: blur(0.1px);
                    animation-timing-function: ease-in;
                }
                25% {
                    transform: translate3d(
                            calc(var(--dx) * 0.03),
                            calc(var(--dy) * 0.03),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 20deg))
                        scale3d(1.05, 0.95, 1) skew(5deg, 3deg);
                    opacity: 0.96;
                    filter: blur(0.3px);
                    animation-timing-function: ease-out;
                }
                40% {
                    transform: translate3d(
                            calc(var(--dx) * 0.08),
                            calc(var(--dx) * 0.08),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 60deg))
                        scale3d(1.1, 0.9, 1) skew(12deg, 8deg);
                    opacity: 0.9;
                    filter: blur(0.8px);
                    animation-timing-function: cubic-bezier(
                        0.25,
                        0.46,
                        0.45,
                        0.94
                    );
                }
                55% {
                    transform: translate3d(
                            calc(var(--dx) * 0.2),
                            calc(var(--dy) * 0.2),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 180deg))
                        scale3d(1.15, 0.85, 1) skew(25deg, 18deg);
                    opacity: 0.8;
                    filter: blur(1.2px);
                    animation-timing-function: cubic-bezier(
                        0.55,
                        0.055,
                        0.675,
                        0.19
                    );
                }
                70% {
                    transform: translate3d(
                            calc(var(--dx) * 0.45),
                            calc(var(--dy) * 0.45),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 420deg))
                        scale3d(0.9, 1.1, 1) skew(40deg, 30deg);
                    opacity: 0.6;
                    filter: blur(2px);
                    animation-timing-function: cubic-bezier(
                        0.215,
                        0.61,
                        0.355,
                        1
                    );
                }
                85% {
                    transform: translate3d(
                            calc(var(--dx) * 0.8),
                            calc(var(--dy) * 0.8),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 900deg))
                        scale3d(0.5, 0.5, 1) skew(65deg, 50deg);
                    opacity: 0.3;
                    filter: blur(3.5px);
                    animation-timing-function: cubic-bezier(
                        0.755,
                        0.05,
                        0.855,
                        0.06
                    );
                }
                95% {
                    transform: translate3d(
                            calc(var(--dx) * 0.95),
                            calc(var(--dy) * 0.95),
                            0
                        )
                        rotate3d(0, 0, 1, calc(var(--rotation) * 1440deg))
                        scale3d(0.2, 0.2, 1) skew(80deg, 70deg);
                    opacity: 0.1;
                    filter: blur(4.5px);
                    animation-timing-function: cubic-bezier(
                        0.95,
                        0.05,
                        0.795,
                        0.035
                    );
                }
                100% {
                    transform: translate3d(var(--dx), var(--dy), 0)
                        rotate3d(0, 0, 1, calc(var(--rotation) * 1800deg))
                        scale3d(0, 0, 1) skew(90deg, 75deg);
                    opacity: 0;
                    filter: blur(5px);
                }
            }

            /* Element sucking effect with GPU acceleration */
            .element-sucking {
                animation: element-suck var(--duration, 2s) var(--delay, 0s)
                    cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
                will-change: transform, opacity;
                transform-style: preserve-3d;
                backface-visibility: hidden;
            }

            @keyframes element-suck {
                0% {
                    transform: translate3d(0, 0, 0) scale3d(1, 1, 1)
                        rotate3d(0, 0, 1, 0deg);
                    opacity: 1;
                    border-radius: 0;
                    clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%);
                    filter: blur(0px);
                }
                20% {
                    transform: translate3d(
                            calc(var(--dx) * 0.02),
                            calc(var(--dy) * 0.02),
                            0
                        )
                        scale3d(0.98, 0.98, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 25deg));
                    opacity: 0.95;
                    border-radius: 3px;
                    clip-path: polygon(2% 1%, 98% 3%, 97% 98%, 3% 99%);
                    filter: blur(0.2px);
                }
                35% {
                    transform: translate3d(
                            calc(var(--dx) * 0.08),
                            calc(var(--dy) * 0.08),
                            0
                        )
                        scale3d(0.92, 0.92, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 90deg));
                    opacity: 0.88;
                    border-radius: 8px;
                    clip-path: polygon(5% 3%, 95% 8%, 92% 95%, 8% 97%);
                    filter: blur(0.8px);
                }
                50% {
                    transform: translate3d(
                            calc(var(--dx) * 0.2),
                            calc(var(--dy) * 0.2),
                            0
                        )
                        scale3d(0.85, 0.85, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 220deg));
                    opacity: 0.78;
                    border-radius: 15px;
                    clip-path: polygon(8% 5%, 92% 12%, 88% 92%, 12% 95%);
                    filter: blur(1.5px);
                }
                65% {
                    transform: translate3d(
                            calc(var(--dx) * 0.4),
                            calc(var(--dy) * 0.4),
                            0
                        )
                        scale3d(0.7, 0.7, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 420deg));
                    opacity: 0.65;
                    border-radius: 25px;
                    clip-path: polygon(12% 8%, 88% 18%, 82% 88%, 18% 92%);
                    filter: blur(2.5px);
                }
                80% {
                    transform: translate3d(
                            calc(var(--dx) * 0.7),
                            calc(var(--dy) * 0.7),
                            0
                        )
                        scale3d(0.5, 0.5, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 720deg));
                    opacity: 0.45;
                    border-radius: 40px;
                    clip-path: polygon(18% 12%, 82% 25%, 75% 82%, 25% 88%);
                    filter: blur(3.5px);
                }
                90% {
                    transform: translate3d(
                            calc(var(--dx) * 0.9),
                            calc(var(--dy) * 0.9),
                            0
                        )
                        scale3d(0.3, 0.3, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 1080deg));
                    opacity: 0.25;
                    border-radius: 50px;
                    clip-path: polygon(25% 18%, 75% 35%, 65% 75%, 35% 82%);
                    filter: blur(4.5px);
                }
                100% {
                    transform: translate3d(var(--dx), var(--dy), 0)
                        scale3d(0, 0, 1)
                        rotate3d(0, 0, 1, calc(var(--rotation, 1) * 1440deg));
                    opacity: 0;
                    border-radius: 50px;
                    clip-path: polygon(50% 50%, 50% 50%, 50% 50%, 50% 50%);
                    filter: blur(5px);
                }
            }

            .final-background {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: #feebea;
                z-index: 4000;
                opacity: 0;
                transition: opacity 4s ease-in;
                will-change: opacity;
                overflow: hidden;
                margin: 0;
                padding: 0;
                border: none;
                outline: none;
            }

            .final-background.show {
                opacity: 1;
            }

            body.portal-mode {
                overflow: hidden !important;
                height: 100vh !important;
                width: 100vw !important;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
            }

            html.portal-mode {
                overflow: hidden !important;
                height: 100% !important;
                width: 100% !important;
            }

            body.portal-mode * {
                scrollbar-width: none !important;
                -ms-overflow-style: none !important;
            }

            body.portal-mode *::-webkit-scrollbar {
                display: none !important;
                width: 0 !important;
                height: 0 !important;
            }

            /* Mobile and Tablet Optimizations */
            @media (max-width: 1024px) {
                .container {
                    max-width: 100%;
                    padding: 1.5rem 1rem;
                }

                .main-title {
                    font-size: 3.5rem;
                }

                .color-circle {
                    width: 220px;
                    height: 220px;
                }

                .essence {
                    grid-template-columns: 1fr;
                    gap: 1rem;
                    padding: 1rem;
                    width: 100%;
                    justify-items: stretch;
                }

                .essence-card {
                    width: 100%;
                    max-width: none;
                    height: 120px;
                }

                .essence-title {
                    font-size: clamp(1rem, 4vw, 1.3rem);
                }

                .essence-desc {
                    font-size: clamp(0.8rem, 3vw, 1.1rem);
                }
            }

            @media (max-width: 768px) {
                .container {
                    padding: 1rem 0.8rem;
                }

                .main-title {
                    font-size: 3rem;
                }

                .subtitle {
                    font-size: 1.2rem;
                }

                .color-circle {
                    width: 180px;
                    height: 180px;
                }

                .meditation-text,
                .quote-text {
                    font-size: 1.1rem;
                }

                .quote-section {
                    gap: 0.8rem;
                }

                .quote-section .quote-text {
                    min-width: 250px;
                }

                .meditation-text {
                    max-width: 90%;
                }

                .essence {
                    grid-template-columns: 1fr;
                    gap: 0.8rem;
                    padding: 0.5rem;
                    width: 100%;
                    justify-items: stretch;
                }

                .essence-card {
                    padding: 0.8rem;
                    width: 100%;
                    max-width: none;
                    height: auto;
                    min-height: 110px;
                    margin-top: 0;
                }

                .essence-card:nth-child(n+4) {
                    display: none;
                }

                .essence-title {
                    font-size: clamp(0.9rem, 3.5vw, 1.1rem);
                }

                .essence-desc {
                    font-size: clamp(0.7rem, 2.8vw, 0.9rem);
                }

                .phoebe-title {
                    font-size: 1.6rem;
                }

                .phoebe-quote {
                    font-size: 1.1rem;
                }

                .final-text {
                    font-size: 1.6rem;
                }

                .lang-toggle {
                    padding: 0.5rem 1rem;
                    font-size: 0.9rem;
                }

                .copy-notification {
                    padding: 0.6rem 1.2rem;
                    font-size: 0.9rem;
                    max-width: 160px;
                }
            }

            @media (max-width: 480px) {
                .main-title {
                    font-size: 2.5rem;
                }

                .color-circle {
                    width: 150px;
                    height: 150px;
                }

                .quote-section,
                .phoebe-section {
                    padding: 1.5rem;
                    margin: 3rem 0;
                    flex-direction: column;
                    gap: 0.5rem;
                }

                .quote-section .quote-text {
                    min-width: auto;
                    text-align: center;
                }

                .meditation-text,
                .quote-text {
                    font-size: 1.1rem;
                }

                .essence {
                    grid-template-columns: 1fr;
                    gap: 0.5rem;
                    padding: 0.5rem;
                }

                .essence-card {
                    padding: 0.6rem;
                    height: auto;
                    min-height: 100px;
                }

                .essence-card:nth-child(n+4) {
                    display: none;
                }

                .essence-title {
                    font-size: clamp(0.8rem, 3vw, 1rem);
                }

                .essence-desc {
                    font-size: clamp(0.6rem, 2.5vw, 0.8rem);
                }

                .rick-portal img {
                    width: 150px;
                    height: 150px;
                }

                .rick-message {
                    font-size: 1.2rem;
                }

                #pickle-rick {
                    width: 60px !important;
                    height: 60px !important;
                    bottom: 15px !important;
                    left: 15px !important;
                }

                /* Pickle Rick text responsive styles */
                .pickle-text-mobile {
                    font-size: clamp(2rem, 12vw, 4rem) !important;
                    letter-spacing: 0.05em !important;
                    text-shadow:
                        2px 2px 0px #2e7d32,
                        4px 4px 0px #1b5e20,
                        6px 6px 0px #0d4e14,
                        8px 8px 15px rgba(0, 0, 0, 0.4) !important;
                }
            }

            /* Touch device optimizations */
            @media (hover: none) and (pointer: coarse) {
                /* Ensure minimum touch target size */
                .lang-toggle, .essence-card, .email-icon, .wechat-icon, .close-easter-egg {
                    min-height: 44px;
                    min-width: 44px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }
                
                /* Touch feedback for interactive elements */
                .lang-toggle:active {
                    background: rgba(254, 235, 234, 0.25);
                    transform: scale(0.95);
                }
                
                .email-icon:active, .wechat-icon:active {
                    background: rgba(254, 235, 234, 0.1);
                    border-radius: 4px;
                    transform: scale(0.95);
                }
                
                .close-easter-egg:active {
                    background: rgba(255, 255, 255, 0.2);
                    transform: scale(0.9);
                }
                
                .final-text:active, .tribute:active {
                    background: rgba(254, 235, 234, 0.1);
                    border-radius: 4px;
                }
                
                .code-item:active {
                    color: #fff;
                    text-shadow: 0 0 10px rgba(254, 235, 234, 0.5);
                }

                .essence-card:active {
                    background: rgba(254, 235, 234, 0.08);
                    transform: translateY(-2px);
                }
            }

            /* Cyberpunk 2077 Easter Egg Styles */
            .cyberpunk-easter-egg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100vw;
                height: 100vh;
                background: linear-gradient(
                    135deg,
                    #000000 0%,
                    #feebea 30%,
                    #000000 70%,
                    #feebea 100%
                );
                display: flex;
                justify-content: center;
                align-items: center;
                flex-direction: column;
                z-index: 10000;
                opacity: 0;
                visibility: hidden;
                transition: all 0.8s ease;
            }

            .cyberpunk-easter-egg.show {
                opacity: 1;
                visibility: visible;
            }

            .cyberpunk-content {
                display: flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
                gap: 3rem;
                animation: cyberpunkEntry 3s ease-out forwards;
            }

            .broken-heart {
                font-size: 12rem;
                color: #ffffff;
                text-shadow:
                    0 0 20px #ffffff,
                    0 0 40px #ffffff,
                    0 0 60px #ffffff;
                animation: heartbreak 2s ease-in-out infinite alternate;
                user-select: none;
            }

            @keyframes heartbreak {
                0% {
                    transform: scale(1) rotate(0deg);
                    filter: brightness(1);
                }
                50% {
                    transform: scale(1.1) rotate(-2deg);
                    filter: brightness(1.2);
                }
                100% {
                    transform: scale(1.05) rotate(2deg);
                    filter: brightness(0.9);
                }
            }

            .cyberpunk-text {
                font-family: "Courier New", monospace;
                font-size: clamp(2rem, 8vw, 6rem);
                color: #feebea;
                text-shadow:
                    0 0 10px #feebea,
                    0 0 20px #feebea,
                    0 0 30px #feebea;
                font-weight: bold;
                letter-spacing: clamp(0.1rem, 0.5vw, 0.3rem);
                animation: cyberpunkGlow 1.5s ease-in-out infinite alternate;
                user-select: none;
                text-align: center;
                word-break: break-word;
                max-width: 90vw;
            }

            .cyberpunk-image {
                max-width: min(450px, 85vw);
                max-height: min(450px, 65vh);
                width: auto;
                height: auto;
                border-radius: 20px;
                box-shadow:
                    0 0 20px rgba(254, 235, 234, 0.3),
                    0 0 40px rgba(254, 235, 234, 0.2),
                    0 0 60px rgba(254, 235, 234, 0.1);
                animation: imageGlow 2s ease-in-out infinite alternate;
                user-select: none;
                object-fit: contain;
                display: block;
                /* GIF优化 - 确保动画正常播放 */
                image-rendering: auto;
                -webkit-image-rendering: auto;
                /* 防止在高DPI屏幕上模糊 */
                image-rendering: -webkit-optimize-contrast;
                /* 移动端优化 */
                -webkit-transform: translateZ(0);
                transform: translateZ(0);
                /* 硬件加速 */
                will-change: transform;
                /* 防止图片拖拽 */
                -webkit-user-drag: none;
                -khtml-user-drag: none;
                -moz-user-drag: none;
                -o-user-drag: none;
                user-drag: none;
                /* 确保在所有浏览器中正确显示 */
                vertical-align: middle;
            }

            @keyframes imageGlow {
                0% {
                    transform: scale(1) translateZ(0);
                    box-shadow:
                        0 0 20px rgba(254, 235, 234, 0.3),
                        0 0 40px rgba(254, 235, 234, 0.2),
                        0 0 60px rgba(254, 235, 234, 0.1);
                }
                100% {
                    transform: scale(1.02) translateZ(0);
                    box-shadow:
                        0 0 30px rgba(254, 235, 234, 0.4),
                        0 0 50px rgba(254, 235, 234, 0.3),
                        0 0 70px rgba(254, 235, 234, 0.2);
                }
            }

            /* Zelda-specific styles */
            .zelda-content {
                animation: zeldaEntry 1s ease-out;
            }
            
            .zelda-text {
                font-family: 'Cinzel', 'Times New Roman', serif;
                font-weight: bold;
                text-transform: uppercase;
                background: linear-gradient(45deg, #feebea, #ffd700, #feebea);
                background-size: 200% 200%;
                -webkit-background-clip: text;
                -webkit-text-fill-color: transparent;
                background-clip: text;
                animation: gradientShift 3s ease-in-out infinite, cyberpunkGlow 2s ease-in-out infinite alternate;
                text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
                letter-spacing: clamp(0.15rem, 0.8vw, 0.4rem);
            }
            
            .zelda-image {
                max-width: min(60vw, 500px);
                max-height: min(60vh, 400px);
            }
            
            @keyframes gradientShift {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
            
            /* Loading state styles */
            .zelda-loading {
                animation: loadingPulse 1.5s ease-in-out infinite;
            }
            
            @keyframes loadingPulse {
                0%, 100% { opacity: 0.6; }
                50% { opacity: 1; }
            }

            /* JOJO Text Effects Styles */
            .jojo-text-normal,
            .jojo-text-fullscreen {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(0);
                z-index: 99999;
                font-family: 'Impact', 'Arial Black', sans-serif;
                font-weight: 900;
                color: white;
                text-shadow: 
                    0 0 10px white,
                    0 0 20px white,
                    0 0 30px white,
                    3px 3px 0px #333,
                    6px 6px 0px #666;
                letter-spacing: 0.2em;
                text-align: center;
                pointer-events: none;
                opacity: 0;
                transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            }
            
            .jojo-text-normal {
                font-size: clamp(3rem, 8vw, 6rem);
            }
            
            .jojo-text-fullscreen {
                font-size: clamp(8rem, 20vw, 25rem);
                animation: jojo-shake 0.5s ease-in-out infinite;
            }
            
            .jojo-text-normal.show,
            .jojo-text-fullscreen.show {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            
            @keyframes rainbow-gradient {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
            
            @keyframes jojo-shake {
                0%, 100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
                25% { transform: translate(-50%, -50%) scale(1.05) rotate(-1deg); }
                75% { transform: translate(-50%, -50%) scale(0.95) rotate(1deg); }
            }
            
            @keyframes jojoFadeInOut {
                0% { 
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.5);
                }
                20% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1.1);
                }
                80% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1);
                }
                100% {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8);
                }
            }

            @keyframes jojoExplosiveShake {
                0% {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.1) rotate(0deg);
                }
                5% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1.5) rotate(-2deg);
                }
                10% {
                    transform: translate(-50%, -50%) scale(1.3) rotate(2deg);
                }
                15% {
                    transform: translate(-50%, -50%) scale(1.4) rotate(-1deg);
                }
                20% {
                    transform: translate(-50%, -50%) scale(1.2) rotate(1deg);
                }
                25% {
                    transform: translate(-50%, -50%) scale(1.35) rotate(-0.5deg);
                }
                30% {
                    transform: translate(-50%, -50%) scale(1.25) rotate(0.5deg);
                }
                35% {
                    transform: translate(-50%, -50%) scale(1.3) rotate(-0.3deg);
                }
                40% {
                    transform: translate(-50%, -50%) scale(1.2) rotate(0.3deg);
                }
                50% {
                    transform: translate(-50%, -50%) scale(1.1) rotate(0deg);
                }
                70% {
                    opacity: 1;
                    transform: translate(-50%, -50%) scale(1) rotate(0deg);
                }
                100% {
                    opacity: 0;
                    transform: translate(-50%, -50%) scale(0.8) rotate(0deg);
                }
            }
            
            /* Responsive adjustments for JOJO text */
            @media (max-width: 768px) {
                .jojo-text-normal {
                    font-size: clamp(2rem, 12vw, 4rem);
                }
                
                .jojo-text-fullscreen {
                    font-size: clamp(6rem, 25vw, 15rem);
                }
            }
            
            @media (max-width: 480px) {
                .jojo-text-normal {
                    font-size: clamp(1.5rem, 15vw, 3rem);
                }
                
                .jojo-text-fullscreen {
                    font-size: clamp(4rem, 30vw, 12rem);
                }
            }

            /* Virtual Keyboard Styles */
            .virtual-keyboard {
                 position: fixed;
                 left: 0;
                 bottom: 0;
                 transform: translateY(100%);
                width: 100vw;
                min-width: 300px;
                max-width: 100vw;
                background: rgba(0, 0, 0, 0.95);
                border: 2px solid #feebea;
                border-radius: 15px;
                padding: 15px;
                z-index: 9999;
                box-shadow: 0 -10px 30px rgba(0, 0, 0, 0.8);
                backdrop-filter: blur(10px);
                transition: transform 0.3s ease-in-out;
                font-family: 'Courier New', monospace;
                resize: horizontal;
                overflow: hidden;
            }

            .virtual-keyboard:not(.hidden) {
                transform: translateY(0);
            }

            .keyboard-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
                padding: 5px 0;
                border-bottom: 1px solid rgba(254, 235, 234, 0.3);
                cursor: move;
                user-select: none;
            }

            .keyboard-title {
                color: #feebea;
                font-size: 14px;
                font-weight: bold;
            }

            .keyboard-controls {
                display: flex;
                gap: 8px;
            }

            .control-btn {
                background: rgba(254, 235, 234, 0.1);
                border: 1px solid #feebea;
                border-radius: 4px;
                color: #feebea;
                padding: 4px 8px;
                font-size: 12px;
                cursor: pointer;
                transition: all 0.2s;
            }

            .control-btn:hover {
                background: rgba(254, 235, 234, 0.2);
            }

            .resize-handle {
                position: absolute;
                right: 0;
                top: 0;
                bottom: 0;
                width: 10px;
                cursor: ew-resize;
                background: linear-gradient(90deg, transparent, rgba(254, 235, 234, 0.3));
            }

            .resize-handle:hover {
                background: linear-gradient(90deg, transparent, rgba(254, 235, 234, 0.5));
            }





            .keyboard-keys {
                margin-bottom: 12px;
            }

            .key-row {
                display: flex;
                gap: 4px;
                margin-bottom: 4px;
                justify-content: center;
            }

            .key {
                background: rgba(254, 235, 234, 0.1);
                border: 1px solid #feebea;
                border-radius: 6px;
                color: #feebea;
                padding: 8px;
                min-width: 28px;
                height: 36px;
                font-size: 12px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .key:hover {
                background: rgba(254, 235, 234, 0.2);
                transform: translateY(-1px);
            }

            .key:active {
                background: rgba(254, 235, 234, 0.3);
                transform: translateY(0);
            }

            .arrow-keys {
                justify-content: center;
                gap: 8px;
                margin-top: 8px;
            }

            .arrow-key {
                background: rgba(254, 235, 234, 0.15);
                border: 1px solid #feebea;
                color: #feebea;
                font-size: 14px;
                min-width: 32px;
                height: 40px;
                font-weight: bold;
            }

            .arrow-key:hover {
                background: rgba(254, 235, 234, 0.25);
                box-shadow: 0 0 8px rgba(254, 235, 234, 0.4);
                transform: translateY(-1px);
            }

            .arrow-key:active {
                background: rgba(254, 235, 234, 0.35);
                transform: translateY(0);
            }

            .keyboard-actions {
                display: flex;
                justify-content: center;
                margin-bottom: 10px;
            }

            .key-action {
                background: rgba(254, 235, 234, 0.2);
                border: 2px solid #feebea;
                border-radius: 8px;
                color: #feebea;
                padding: 10px 20px;
                font-size: 14px;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.2s;
            }

            .key-action:hover {
                background: rgba(254, 235, 234, 0.3);
                transform: translateY(-1px);
            }

            .keyboard-hints {
                font-size: 10px;
                color: rgba(254, 235, 234, 0.7);
                text-align: center;
                line-height: 1.3;
            }



            /* Mobile-only class */
            .mobile-only {
                display: none;
            }

            /* Show mobile elements only on touch devices */
            @media (hover: none) and (pointer: coarse) {
                .mobile-only {
                    display: flex;
                }
            }

            /* Mobile responsive adjustments for virtual keyboard */
            @media (max-width: 480px) {
                 .virtual-keyboard {
                     left: 10px;
                     width: calc(100vw - 20px);
                     max-width: calc(100vw - 20px);
                     min-width: 280px;
                     bottom: 10px;
                     transform: translateY(100%);
                     padding: 10px;
                 }

                 .virtual-keyboard:not(.hidden) {
                     transform: translateY(0);
                 }

                 .resize-handle {
                     width: 15px;
                 }

                .key {
                    min-width: 22px;
                    height: 30px;
                    font-size: 10px;
                    padding: 4px;
                }

                .arrow-key {
                    min-width: 28px;
                    height: 32px;
                    font-size: 12px;
                }
            }

            /* Hidden class */
            .hidden {
                display: none !important;
            }

            /* 移动端优化 */
            @media (max-width: 768px) {
                .cyberpunk-image {
                    max-width: min(320px, 90vw);
                    max-height: min(320px, 55vh);
                    /* 移动端减少动画强度以提升性能 */
                    animation: none;
                }
                
                .zelda-image {
                    max-width: min(350px, 85vw);
                    max-height: min(350px, 55vh);
                }
                
                .cyberpunk-content {
                    gap: 2rem;
                    padding: 1rem;
                }
                
                .cyberpunk-text {
                    font-size: clamp(1.5rem, 6vw, 4rem);
                    letter-spacing: clamp(0.05rem, 0.3vw, 0.2rem);
                }
                
                .zelda-text {
                    font-size: clamp(1.6rem, 6.5vw, 4.2rem);
                }
            }

            /* 小屏幕设备进一步优化 */
            @media (max-width: 480px) {
                .cyberpunk-image {
                    max-width: min(270px, 85vw);
                    max-height: min(270px, 45vh);
                }
                
                .zelda-image {
                    max-width: min(280px, 90vw);
                    max-height: min(280px, 45vh);
                }
                
                .cyberpunk-content {
                    gap: 1.5rem;
                }
            }

            @keyframes cyberpunkEntry {
                0% {
                    opacity: 0;
                    transform: scale(2) rotate(10deg);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.2) rotate(-5deg);
                }
                100% {
                    opacity: 0.9;
                    transform: scale(1) rotate(0deg);
                }
            }

            @keyframes zeldaEntry {
                0% {
                    opacity: 0;
                    transform: scale(2);
                }
                50% {
                    opacity: 1;
                    transform: scale(1.2);
                }
                100% {
                    opacity: 0.9;
                    transform: scale(1);
                }
            }

            @keyframes cyberpunkGlow {
                0% {
                    opacity: 0.8;
                    text-shadow:
                        0 0 10px #feebea,
                        0 0 20px #feebea,
                        0 0 30px #feebea;
                }
                100% {
                    opacity: 1;
                    text-shadow:
                        0 0 15px #feebea,
                        0 0 30px #feebea,
                        0 0 45px #feebea,
                        0 0 60px #feebea;
                }
            }

            .audio-control-panel {
                position: fixed;
                left: -60px;
                top: 50%;
                transform: translateY(-50%);
                z-index: 9999;
                opacity: 0;
                visibility: hidden;
                transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
                display: flex;
                align-items: center;
            }

            .audio-control-panel.show {
                opacity: 1;
                visibility: visible;
                left: 1rem;
            }

            .audio-control-panel:hover {
                left: 1rem;
            }

            .audio-control-panel.mobile-show {
                opacity: 1;
                visibility: visible;
                left: 1rem;
            }

            .audio-control-panel.hidden-during-fullscreen {
                opacity: 0;
                visibility: hidden;
            }

            .audio-playlist-sidebar {
                position: absolute;
                left: 100%;
                top: 50%;
                transform: translateY(-50%);
                width: 200px;
                background: rgba(0, 0, 0, 0.9);
                border: 1px solid #feebea;
                border-radius: 8px;
                margin-left: 10px;
                opacity: 0;
                visibility: hidden;
                transform: translateY(-50%) translateX(-20px);
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
                box-shadow: 0 4px 20px rgba(254, 235, 234, 0.2);
            }

            .audio-control-panel:hover .audio-playlist-sidebar {
                opacity: 1;
                visibility: visible;
                transform: translateY(-50%) translateX(0);
            }

            .playlist-items {
                max-height: 300px;
                overflow-y: auto;
                padding: 8px 0;
                border-radius: 8px;
            }

            .playlist-item {
                padding: 10px 16px;
                cursor: pointer;
                transition: all 0.2s ease;
                border-left: 3px solid transparent;
                color: #ffffff;
                font-size: 13px;
                display: flex;
                align-items: center;
                justify-content: space-between;
            }

            .playlist-item:hover {
                background: rgba(254, 235, 234, 0.1);
                border-left-color: #feebea;
            }

            .playlist-item.active {
                background: rgba(254, 235, 234, 0.2);
                border-left-color: #feebea;
                color: #feebea;
            }

            .playlist-item-name {
                flex: 1;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

            .playlist-item-type {
                font-size: 10px;
                opacity: 0.7;
                margin-left: 8px;
            }

            .audio-control-btn {
                background: #feebea;
                border: none;
                color: #333;
                padding: 0;
                border-radius: 50%;
                cursor: pointer;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                width: 32px;
                height: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: 0 3px 8px rgba(254, 235, 234, 0.3);
                flex-shrink: 0;
                /* 增加触摸区域 */
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }

            .audio-control-btn:hover {
                background: #feebea;
                box-shadow: 0 4px 12px rgba(254, 235, 234, 0.5);
                transform: scale(1.05);
            }

            .audio-control-btn:active {
                transform: scale(0.98);
            }

            .audio-control-btn svg {
                width: 14px;
                height: 14px;
                fill: currentColor;
                transition: all 0.3s ease;
            }
            
            .play-mode-btn {
                position: absolute;
                top: -32px;
                left: 0;
                opacity: 0;
                visibility: hidden;
                transform: translateY(10px);
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                width: 20px;
                height: 20px;
            }
            
            .audio-control-panel:hover .play-mode-btn {
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }
            
            .play-mode-btn .mode-icon {
                width: 8px;
                height: 8px;
            }
            
            .play-mode-btn[data-mode="stop"] .mode-icon path {
                d: path("M6 6h12v12H6z");
            }
            
            .play-mode-btn[data-mode="repeat-one"] .mode-icon {
                transform: scale(0.9);
            }
            
            .play-mode-btn[data-mode="repeat-all"] .mode-icon {
                transform: scale(0.9);
            }

            .close-easter-egg {
                position: fixed;
                top: 2rem;
                right: 2rem;
                background: rgba(255, 255, 255, 0.1);
                border: 2px solid #ffffff;
                color: #ffffff;
                padding: 0.5rem 1rem;
                border-radius: 50%;
                font-family: "Courier New", monospace;
                font-size: 1.5rem;
                cursor: pointer;
                transition: all 0.3s ease;
                z-index: 9998;
                opacity: 0;
                visibility: hidden;
                backdrop-filter: blur(10px);
                width: 60px;
                height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .close-easter-egg.show {
                opacity: 1;
                visibility: visible;
            }

            .close-easter-egg.hidden-during-fullscreen {
                opacity: 0;
                visibility: hidden;
            }

            .close-easter-egg:hover {
                background: rgba(255, 255, 255, 0.2);
                box-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
                transform: scale(1.1) rotate(90deg);
            }

            /* Cyberpunk mode body styles */
            body.cyberpunk-mode {
                background: linear-gradient(
                    135deg,
                    #000000 0%,
                    #0f0f0f 50%,
                    #1a0a0a 100%
                );
            }

            body.cyberpunk-mode .zima-square {
                display: none !important;
            }

            @media (max-width: 768px) {
                .cyberpunk-content {
                    flex-direction: column;
                    gap: 1rem;
                }

                .broken-heart {
                    font-size: 6rem;
                }

                .cyberpunk-text {
                    font-size: 4rem;
                    letter-spacing: 0.3rem;
                }

                .audio-control-panel {
                    left: -80px; /* 完全隐藏在屏幕外 */
                }

                .audio-control-panel.show,
                .audio-control-panel:hover,
                .audio-control-panel.mobile-show {
                    left: 0.8rem;
                }

                .audio-control-btn {
                    width: 44px;
                    height: 44px;
                }

                .audio-control-btn svg {
                    width: 18px;
                    height: 18px;
                }

                .play-mode-btn {
                    width: 28px;
                    height: 28px;
                    top: -38px;
                }

                .play-mode-btn .mode-icon {
                    width: 12px;
                    height: 12px;
                }
            }

            @media (max-width: 480px) {
                .broken-heart {
                    font-size: 4rem;
                }

                .cyberpunk-text {
                    font-size: 3rem;
                    letter-spacing: 0.2rem;
                }

                .audio-control-panel {
                    left: -80px; /* 完全隐藏在屏幕外 */
                }

                .audio-control-panel.show,
                .audio-control-panel:hover,
                .audio-control-panel.mobile-show {
                    left: 0.5rem;
                }

                .audio-control-btn {
                    width: 40px;
                    height: 40px;
                }

                .audio-control-btn svg {
                    width: 16px;
                    height: 16px;
                }

                .play-mode-btn {
                    width: 24px;
                    height: 24px;
                    top: -34px;
                }

                .play-mode-btn .mode-icon {
                    width: 10px;
                    height: 10px;
                }
            }

            /* Debug Panel Styles */
            .debug-panel {
                position: fixed;
                bottom: 1rem;
                right: 1rem;
                background: rgba(0, 0, 0, 0.95);
                border: 1px solid rgba(254, 237, 234, 0.3);
                border-radius: 8px;
                padding: 0.8rem;
                color: #feedea;
                font-family: "Arial", sans-serif;
                font-size: 0.7rem;
                max-width: 280px;
                max-height: 70vh;
                overflow-y: auto;
                z-index: 9999;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                backdrop-filter: blur(5px);
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            }

            .debug-panel.show {
                opacity: 1;
                visibility: visible;
            }

            .debug-panel h4 {
                color: #feedea;
                margin-bottom: 0.4rem;
                font-size: 0.8rem;
                font-weight: normal;
            }

            .debug-panel p {
                margin-bottom: 0.2rem;
                line-height: 1.2;
                font-size: 0.65rem;
                color: #feedea;
            }

            .debug-panel .easter-egg-hint {
                color: rgba(254, 237, 234, 0.8);
                font-weight: normal;
                margin-top: 0.3rem;
                font-size: 0.65rem;
            }

            .debug-panel .current-quotes {
                background: rgba(254, 237, 234, 0.1);
                padding: 0.4rem;
                border-radius: 4px;
                margin-top: 0.3rem;
                font-size: 0.6rem;
                border: 1px solid rgba(254, 237, 234, 0.2);
            }

            .auto-click-btn {
                background: rgba(254, 237, 234, 0.1);
                border: 1px solid rgba(254, 237, 234, 0.3);
                color: #feedea;
                padding: 0.3rem 0.6rem;
                border-radius: 4px;
                font-family: "Arial", sans-serif;
                font-size: 0.65rem;
                cursor: pointer;
                transition: all 0.2s ease;
                margin-top: 0.3rem;
                width: 100%;
                font-weight: normal;
            }

            .auto-click-btn:hover {
                background: rgba(254, 237, 234, 0.2);
                border-color: rgba(254, 237, 234, 0.5);
            }

            .auto-click-btn:active {
                transform: scale(0.98);
            }

            .auto-click-btn.running {
                background: rgba(254, 237, 234, 0.15);
                border-color: rgba(254, 237, 234, 0.4);
                color: rgba(254, 237, 234, 0.9);
            }

            .quick-set-buttons {
                display: flex;
                flex-direction: column;
                gap: 0.3rem;
                margin: 0.5rem 0;
            }

            .quick-set-btn {
                background: rgba(254, 237, 234, 0.1);
                border: 1px solid rgba(254, 237, 234, 0.3);
                color: #feedea;
                padding: 0.3rem 0.5rem;
                border-radius: 4px;
                font-family: "Arial", sans-serif;
                font-size: 0.65rem;
                cursor: pointer;
                transition: all 0.2s ease;
                font-weight: normal;
            }

            .quick-set-btn:hover {
                background: rgba(254, 237, 234, 0.2);
                border-color: rgba(254, 237, 234, 0.5);
            }

            .quick-set-btn:active {
                transform: scale(0.98);
            }

            .debug-toggle {
                position: fixed;
                top: 5rem;
                left: 1rem;
                z-index: 1000;
                background: rgba(254, 235, 234, 0.1);
                border-radius: 20px;
                padding: 0.5rem 1rem;
                font-family: "Dancing Script", cursive;
                font-size: 1.1rem;
                cursor: pointer;
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
                display: none;
                align-items: center;
                gap: 0.3rem;
                color: #feebea;
            }
            
            .debug-toggle.show {
                display: flex;
            }

            .debug-toggle:hover {
                background: rgba(254, 235, 234, 0.15);
                transform: scale(1.05);
                box-shadow: 0 0 15px rgba(254, 235, 234, 0.2);
            }

            .debug-panel .easter-egg-controls {
                margin-top: 0.5rem;
                padding: 0.4rem;
                background: rgba(254, 237, 234, 0.05);
                border-radius: 4px;
                border: 1px solid rgba(254, 237, 234, 0.2);
            }

            .debug-panel .easter-egg-controls h5 {
                margin: 0 0 0.3rem 0;
                color: #feedea;
                font-size: 0.7rem;
                text-align: center;
                font-weight: normal;
            }

            .debug-panel .egg-state-buttons {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0.2rem;
                margin-bottom: 0.3rem;
            }

            .debug-panel .state-btn {
                padding: 0.2rem 0.3rem;
                background: rgba(254, 237, 234, 0.1);
                color: #feedea;
                border: 1px solid rgba(254, 237, 234, 0.3);
                border-radius: 3px;
                cursor: pointer;
                font-size: 0.6rem;
                transition: all 0.2s ease;
                font-family: "Arial", sans-serif;
                text-align: center;
            }

            .debug-panel .state-btn:hover {
                background: rgba(254, 237, 234, 0.2);
                border-color: rgba(254, 237, 234, 0.5);
            }

            .debug-panel .state-btn.active {
                background: rgba(254, 237, 234, 0.25);
                border-color: rgba(254, 237, 234, 0.6);
                color: #feedea;
            }

            .debug-panel .state-btn.reset-btn {
                background: rgba(254, 237, 234, 0.08);
                border-color: rgba(254, 237, 234, 0.25);
                grid-column: 1;
            }

            .debug-panel .state-btn.reset-btn:hover {
                background: rgba(254, 237, 234, 0.15);
            }

            .debug-panel .state-btn.trigger-btn {
                background: rgba(254, 237, 234, 0.12);
                border-color: rgba(254, 237, 234, 0.3);
                grid-column: 2;
            }

            .debug-panel .state-btn.trigger-btn:hover {
                background: rgba(254, 237, 234, 0.2);
            }

            /* 导航菜单样式 */
            .navigation {
                position: fixed;
                top: 50%;
                right: 2rem;
                transform: translateY(-50%);
                z-index: 1000;
                display: flex;
                flex-direction: column;
                gap: 1.5rem;
                opacity: 0.7;
                transition: opacity 0.3s ease;
            }

            .navigation:hover {
                opacity: 1;
            }

            .nav-dot {
                width: 8px;
                height: 24px;
                border-radius: 12px;
                background: rgba(254, 235, 234, 0.3);
                border: 2px solid rgba(254, 235, 234, 0.5);
                cursor: pointer;
                transition: all 0.3s ease;
                position: relative;
                /* 确保在所有浏览器中可点击 */
                -webkit-tap-highlight-color: transparent;
                user-select: none;
                -webkit-user-select: none;
                -moz-user-select: none;
                -ms-user-select: none;
                /* 增加点击区域 */
                padding: 4px;
                margin: 2px 0;
            }

            .nav-dot:focus {
                outline: 2px solid #feebea;
                outline-offset: 2px;
            }

            .nav-dot:hover {
                background: rgba(254, 235, 234, 0.6);
                border-color: #feebea;
                transform: scale(1.2);
            }

            .nav-dot.active {
                background: #feebea;
                border-color: #feebea;
                box-shadow: 0 0 10px rgba(254, 235, 234, 0.5);
            }

            .nav-dot::after {
                content: attr(data-tooltip);
                position: absolute;
                right: 25px;
                top: 50%;
                transform: translateY(-50%);
                background: rgba(0, 0, 0, 0.8);
                color: #feebea;
                padding: 0.3rem 0.6rem;
                border-radius: 4px;
                font-size: 0.8rem;
                white-space: nowrap;
                opacity: 0;
                visibility: hidden;
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(254, 235, 234, 0.2);
            }

            .nav-dot:hover::after {
                opacity: 1;
                visibility: visible;
            }

            /* 回到顶部按钮 */
            .back-to-top {
                position: fixed;
                bottom: 2rem;
                right: 2rem;
                width: 50px;
                height: 50px;
                background: rgba(254, 235, 234, 0.1);
                border: 2px solid rgba(254, 235, 234, 0.3);
                border-radius: 50%;
                color: #feebea;
                cursor: pointer;
                transition: all 0.3s ease;
                backdrop-filter: blur(10px);
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.2rem;
                opacity: 0;
                visibility: hidden;
                transform: translateY(20px);
                z-index: 999;
            }

            .back-to-top.show {
                opacity: 1;
                visibility: visible;
                transform: translateY(0);
            }

            .back-to-top:hover {
                background: rgba(254, 235, 234, 0.2);
                border-color: #feebea;
                transform: scale(1.1);
                box-shadow: 0 0 20px rgba(254, 235, 234, 0.3);
            }

            /* 移动端适配 */
            @media (max-width: 768px) {
                .navigation {
                    right: 1rem;
                    gap: 2rem;
                }
                
                .nav-dot {
                    width: 12px;
                    height: 32px;
                    border-radius: 16px;
                    padding: 6px;
                    margin: 4px 0;
                }
                
                .back-to-top {
                    right: 1rem;
                    bottom: 1rem;
                    width: 45px;
                    height: 45px;
                    font-size: 1rem;
                }
            }
        </style>
    </head>
    <body>
        <div id="infinite-scroll-container">
            <div class="lang-toggle" onclick="toggleLanguage()" ontouchend="event.preventDefault(); toggleLanguage();">
                <span id="langChinese" class="lang-option inactive">中</span>
                <span class="lang-separator">/</span>
                <span id="langEnglish" class="lang-option active">EN</span>
            </div>

        <div class="copy-notification" id="copyNotification">
            <span id="copyText">Copied to clipboard</span>
        </div>

        <!-- 导航菜单 -->
        <nav class="navigation">
            <div class="nav-dot" data-tooltip="Top" data-section="header"></div>
            <div class="nav-dot" data-tooltip="Color" data-section="color-display"></div>
            <div class="nav-dot" data-tooltip="Quote" data-section="quote-section"></div>
            <div class="nav-dot" data-tooltip="Meditation" data-section="meditation"></div>
            <div class="nav-dot" data-tooltip="Essence" data-section="essence"></div>
            <div class="nav-dot" data-tooltip="Phoebe" data-section="phoebe-section"></div>
        </nav>

        <!-- 回到顶部按钮 -->
        <button class="back-to-top" id="backToTopBtn" aria-label="回到顶部">
            ↑
        </button>

        <div class="container">
            <!-- English Content -->
            <div id="englishContent">
                <header class="header" id="header">
                    <h1 class="main-title">
                        Feebea
                    </h1>

                    <p class="tribute">
                        To Those I Love
                    </p>
                </header>

                <section class="color-display" id="color-display">
                    <div class="color-circle"></div>
                </section>

                <section class="color-info">
                    <div class="color-codes">
                        <div class="code-item">
                            #feebea
                        </div>
                        <div class="code-item">
                            rgb(254, 235, 234)
                        </div>
                        <div class="code-item">
                            hsl(3, 91%, 96%)
                        </div>
                    </div>
                </section>

                <section class="quote-section" id="quote-section">
                    <p class="quote-text">
                        "My search for truth is finished at last. I'm going
                        home." <span class="quote-author">— Zima Blue</span>
                    </p>
                </section>

                <section class="meditation" id="meditation">
                    <p class="meditation-text">
                        "Sometimes, it's difficult even for me<br />
                        to understand what I've become.<br />
                        And harder still to remember what I once was.<br />
                        The blue of the tiles...<br />
                        Zima Blue, the manufacturer called it.<br />
                        The first thing I ever saw.<br />
                        This was where I began.<br />
                        A crude little machine with<br />
                        barely enough intelligence to steer itself.<br />
                        But it was my world.<br />
                        It was all I knew, all I needed to know.<br />
                        And now?<br />
                        I will immerse myself.<br />
                        And as I do, I will slowly shut down my higher brain
                        functions...<br />
                        un-making myself...<br />
                        leaving just enough to appreciate my surroundings...<br />
                        to extract some simple pleasure<br />
                        from the execution of a task well done.<br />
                        My search for truth is finished at last.<br />
                        I'm going home."
                    </p>
                </section>

                <section class="essence" id="essence">
                    <div class="essence-card" onclick="changeQuote(0)" ontouchend="event.preventDefault(); changeQuote(0);">
                        <h3 class="essence-title">
                            The night is dark and full of terrors
                        </h3>
                        <p class="essence-desc">
                            Game of Thrones
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(1)" ontouchend="event.preventDefault(); changeQuote(1);">
                        <h3 class="essence-title">
                            I have a hangover. A hangover with a hangover
                        </h3>
                        <p class="essence-desc">
                            Black Books
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(2)" ontouchend="event.preventDefault(); changeQuote(2);">
                        <h3 class="essence-title">
                            Life is a beautiful robe crawling with lice
                        </h3>
                        <p class="essence-desc">
                            Zhang Ailing
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(3)" ontouchend="event.preventDefault(); changeQuote(3);">
                        <h3 class="essence-title">
                            Sometimes you have to run before you can walk
                        </h3>
                        <p class="essence-desc">
                            Iron Man
                        </p>
                    </div>
                </section>

                <section class="phoebe-section" id="phoebe-section">
                    <h2 class="phoebe-title">Phoebe's Wisdom</h2>
                    <p class="phoebe-quote">
                        "NO, YOU ARE THE BOSS OF YOU!"
                    </p>
                </section>

                <footer class="final-tribute">
                    <div class="footer-content">
                        <p class="final-text">Peng</p>
                        <div class="contact-icons">
                            <span class="email-icon" title="Email: pjlpcc@qq.com" onclick="copyToClipboard('pjlpcc@qq.com')" ontouchend="event.preventDefault(); copyToClipboard('pjlpcc@qq.com');">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#feebea" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z"/>
                                </svg>
                                pjlpcc@qq.com
                            </span>
                            <span class="wechat-icon" title="WeChat: wx3dot1415926" onclick="copyToClipboard('wx3dot1415926')" ontouchend="event.preventDefault(); copyToClipboard('wx3dot1415926');">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#feebea" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.5 12C9.33 12 10 11.33 10 10.5S9.33 9 8.5 9 7 9.67 7 10.5 7.67 12 8.5 12ZM15.5 12C16.33 12 17 11.33 17 10.5S16.33 9 15.5 9 14 9.67 14 10.5 14.67 12 15.5 12ZM18 10.5C18 6.36 14.64 3 10.5 3S3 6.36 3 10.5C3 12.83 4.24 14.86 6.07 16.05C5.73 17.74 4.21 19.81 4.21 19.81S7.5 19.5 9.08 18.29C9.54 18.38 10.01 18.43 10.5 18.43C14.64 18.43 18 15.07 18 10.5Z"/>
                                </svg>
                                wx3dot1415926
                            </span>
                        </div>
                    </div>
                </footer>
            </div>

            <!-- Chinese Content -->
            <div id="chineseContent" class="hidden">
                <header class="header">
                    <h1 class="main-title">
                        Feebea
                    </h1>

                    <p class="tribute">
                        致那些我所热爱的
                    </p>
                </header>

                <section class="color-display">
                    <div class="color-circle"></div>
                </section>

                <section class="color-info">
                    <div class="color-codes">
                        <div class="code-item">
                            #feebea
                        </div>
                        <div class="code-item">
                            rgb(254, 235, 234)
                        </div>
                        <div class="code-item">
                            hsl(3, 91%, 96%)
                        </div>
                    </div>
                </section>

                <section class="quote-section">
                    <p class="quote-text">
                        "我对真相的探索终于结束了。我要回家了。" <span class="quote-author">— 齐马蓝</span>
                    </p>
                </section>

                <section class="meditation">
                    <p class="meditation-text">
                        "Sometimes, it's difficult even for me<br />
                        有时候 连我自己都很难理解<br />
                        to understand what I've become.<br />
                        我到底成为了什么<br />
                        And harder still to remember what I once was.<br />
                        更难记清楚我曾经是什么样子<br />
                        The blue of the tiles...<br />
                        瓷砖的蓝色<br />
                        Zima Blue, the manufacturer called it.<br />
                        齐马蓝 制作商这样称呼<br />
                        The first thing I ever saw.<br />
                        我见到的第一件物品<br />
                        This was where I began.<br />
                        一切从这里开始<br />
                        A crude little machine with<br />
                        一个简陋的小机器<br />
                        barely enough intelligence to steer itself.<br />
                        几乎没有足够智能操控自己<br />
                        But it was my world.<br />
                        但那是我的世界<br />
                        It was all I knew, all I needed to know.<br />
                        是我了解的一切 也是我需要了解的一切<br />
                        And now?<br />
                        现在呢<br />
                        I will immerse myself.<br />
                        我将浸入泳池<br />
                        And as I do, I will slowly shut down my higher brain
                        functions...<br />
                        与此同时 我会逐渐关闭我的高级脑功能<br />
                        un-making myself...<br />
                        拆解自己<br />
                        leaving just enough to appreciate my surroundings...<br />
                        只留下必要的组件来欣赏周围环境<br />
                        to extract some simple pleasure<br />
                        从高效完成任务中<br />
                        from the execution of a task well done.<br />
                        感受简单的愉悦<br />
                        My search for truth is finished at last.<br />
                        我对真相的探索终于结束了<br />
                        I'm going home."<br />
                        我要回家了
                    </p>
                </section>

                <section class="essence">
                    <div class="essence-card" onclick="changeQuote(0)" ontouchend="event.preventDefault(); changeQuote(0);">
                        <h3 class="essence-title">
                            长夜漫漫，处处险恶
                        </h3>
                        <p class="essence-desc">
                            权力的游戏
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(1)" ontouchend="event.preventDefault(); changeQuote(1);">
                        <h3 class="essence-title">
                            我宿醉了。比宿醉还醉的宿醉
                        </h3>
                        <p class="essence-desc">
                            布莱克书店
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(2)" ontouchend="event.preventDefault(); changeQuote(2);">
                        <h3 class="essence-title">
                            人生是一袭华美的袍，爬满了虱子
                        </h3>
                        <p class="essence-desc">
                            张爱玲
                        </p>
                    </div>
                    <div class="essence-card" onclick="changeQuote(3)" ontouchend="event.preventDefault(); changeQuote(3);">
                        <h3 class="essence-title">
                            有时候你必须先跑起来，才能学会走路
                        </h3>
                        <p class="essence-desc">
                            钢铁侠
                        </p>
                    </div>
                </section>

                <section class="phoebe-section">
                    <h2 class="phoebe-title">菲比的智慧</h2>
                    <p class="phoebe-quote">
                        "NO, YOU ARE THE BOSS OF YOU!"
                    </p>
                </section>

                <footer class="final-tribute">
                    <div class="footer-content">
                        <p class="final-text">Peng</p>
                        <div class="contact-icons">
                            <span class="email-icon" title="Email: pjlpcc@qq.com" onclick="copyToClipboard('pjlpcc@qq.com')" ontouchend="event.preventDefault(); copyToClipboard('pjlpcc@qq.com');">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#feebea" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M20 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V6C22 4.9 21.1 4 20 4ZM20 8L12 13L4 8V6L12 11L20 6V8Z"/>
                                </svg>
                                pjlpcc@qq.com
                            </span>
                            <span class="wechat-icon" title="WeChat: wx3dot1415926" onclick="copyToClipboard('wx3dot1415926')" ontouchend="event.preventDefault(); copyToClipboard('wx3dot1415926');">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="#feebea" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.5 12C9.33 12 10 11.33 10 10.5S9.33 9 8.5 9 7 9.67 7 10.5 7.67 12 8.5 12ZM15.5 12C16.33 12 17 11.33 17 10.5S16.33 9 15.5 9 14 9.67 14 10.5 14.67 12 15.5 12ZM18 10.5C18 6.36 14.64 3 10.5 3S3 6.36 3 10.5C3 12.83 4.24 14.86 6.07 16.05C5.73 17.74 4.21 19.81 4.21 19.81S7.5 19.5 9.08 18.29C9.54 18.38 10.01 18.43 10.5 18.43C14.64 18.43 18 15.07 18 10.5Z"/>
                                </svg>
                                wx3dot1415926
                            </span>
                        </div>
                    </div>
                </footer>
            </div>
        </div>

        <script>
            let isEnglish = true;

            function toggleLanguage() {
                const englishContent =
                    document.getElementById("englishContent");
                const chineseContent =
                    document.getElementById("chineseContent");
                const langChinese = document.getElementById("langChinese");
                const langEnglish = document.getElementById("langEnglish");
                const copyText = document.getElementById("copyText");
                const body = document.body;

                // Handle cumulative click easter egg
                clickCounters.langToggle++;
                console.log(
                    `Language toggle clicked, cumulative count: ${clickCounters.langToggle}`,
                );
                console.log(
                    "Current language:",
                    isEnglish ? "English" : "Chinese",
                );
                if (clickCounters.langToggle === 3) {
                    // Check if this easter egg has reached its trigger limit (3 times)
                    if (easterEggTriggerCounts.langToggle >= 3) {
                        console.log("Language toggle easter egg has reached maximum triggers (3/3)");
                        clickCounters.langToggle = 0;
                        return;
                    }
                    
                    console.log("Language toggle easter egg triggered!");
                    easterEggTriggered.langToggle = true;
                    easterEggTriggerCounts.langToggle++;
                    setTimeout(() => {
                        console.log("About to play they-dont-know.mp3");
                        playAudio("they-dont-know.mp3");
                        showEasterEggNotification(
                            isEnglish
                                ? "They Don't Know That We Know They Know We Know."
                                : "他们不知道我们知道他们知道我们知道。",
                        );
                    }, 500);
                    clickCounters.langToggle = 0; // Reset counter after triggering
                }

                const debugButton = document.getElementById("debugButton");

                if (isEnglish) {
                    englishContent.classList.add("hidden");
                    chineseContent.classList.remove("hidden");
                    langChinese.classList.add("active");
                    langChinese.classList.remove("inactive");
                    langEnglish.classList.add("inactive");
                    langEnglish.classList.remove("active");
                    debugButton.textContent = "调试";
                    copyText.textContent = "已复制到剪贴板";
                    body.classList.add("chinese");
                    isEnglish = false;
                } else {
                    englishContent.classList.remove("hidden");
                    chineseContent.classList.add("hidden");
                    langEnglish.classList.add("active");
                    langEnglish.classList.remove("inactive");
                    langChinese.classList.add("inactive");
                    langChinese.classList.remove("active");
                    debugButton.textContent = "Debug";
                    copyText.textContent = "Copied to clipboard";
                    body.classList.remove("chinese");
                    isEnglish = true;
                }

                // Re-adapt font sizes after language change
                setTimeout(() => {
                    adaptFontSizeResponsive();
                    adaptQuoteFontSize();
                    // Update quote section content for new language
                    updateQuoteSection();
                    // Reinitialize touch events for the new language
                    initializeQuoteTouchEvents();
                }, 100);
            }

            function copyToClipboard(text) {
                navigator.clipboard.writeText(text).then(
                    function () {
                        showCopyNotification();
                    },
                    function (err) {
                        console.error("Could not copy text: ", err);
                        // Fallback for older browsers
                        const textArea = document.createElement("textarea");
                        textArea.value = text;
                        document.body.appendChild(textArea);
                        textArea.select();
                        try {
                            document.execCommand("copy");
                            showCopyNotification();
                        } catch (err) {
                            console.error(
                                "Fallback: Could not copy text: ",
                                err,
                            );
                        }
                        document.body.removeChild(textArea);
                    },
                );
            }

            function showCopyNotification() {
                const notification =
                    document.getElementById("copyNotification");
                notification.classList.add("show");

                setTimeout(() => {
                    notification.classList.remove("show");
                }, 2000);
            }

            // Font size adaptation based on text length
            function adaptFontSize() {
                const essenceTitles =
                    document.querySelectorAll(".essence-title");
                const essenceDescs = document.querySelectorAll(".essence-desc");

                essenceTitles.forEach((title) => {
                    const textLength = title.textContent.length;
                    let fontSize;

                    if (textLength <= 8) {
                        fontSize = "1.7rem";
                    } else if (textLength <= 12) {
                        fontSize = "1.5rem";
                    } else if (textLength <= 16) {
                        fontSize = "1.3rem";
                    } else if (textLength <= 20) {
                        fontSize = "1.2rem";
                    } else {
                        fontSize = "1.1rem";
                    }

                    title.style.fontSize = fontSize;
                });

                essenceDescs.forEach((desc) => {
                    const textLength = desc.textContent.length;
                    let fontSize;

                    if (textLength <= 6) {
                        fontSize = "1.4rem";
                    } else if (textLength <= 10) {
                        fontSize = "1.3rem";
                    } else if (textLength <= 14) {
                        fontSize = "1.2rem";
                    } else {
                        fontSize = "1.1rem";
                    }

                    desc.style.fontSize = fontSize;
                });
            }

            // Function to initialize touch events for quote sections
            function initializeQuoteTouchEvents() {
                // Remove existing event listeners
                const allQuoteSections = document.querySelectorAll('.quote-section');
                allQuoteSections.forEach(section => {
                    section.removeEventListener('touchstart', handleTouchStart);
                    section.removeEventListener('touchend', handleTouchEnd);
                });
                
                // Add event listeners to the currently visible quote section
                const currentQuoteSection = isEnglish 
                    ? document.querySelector('#englishContent .quote-section')
                    : document.querySelector('#chineseContent .quote-section');
                    
                if (currentQuoteSection) {
                    currentQuoteSection.addEventListener('touchstart', handleTouchStart, { passive: true });
                    currentQuoteSection.addEventListener('touchend', handleTouchEnd, { passive: true });
                    
                    // Add transition styles for smooth animations
                    currentQuoteSection.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                }
            }

            // Quote font size adaptation based on text length
            function adaptQuoteFontSize() {
                // Select quote elements from the currently visible section
                const container = isEnglish ? '#englishContent' : '#chineseContent';
                const quoteText = document.querySelector(`${container} .quote-text`);
                const quoteAuthor = document.querySelector(`${container} .quote-author`);
                const isMobile = window.innerWidth <= 768;
                const isSmallMobile = window.innerWidth <= 480;

                if (quoteText) {
                    const textLength = quoteText.textContent.length;
                    let fontSize;

                    if (isEnglish) {
                        // English font sizes
                        if (isSmallMobile) {
                            if (textLength <= 50) {
                                fontSize = "1.2rem";
                            } else if (textLength <= 100) {
                                fontSize = "1rem";
                            } else if (textLength <= 150) {
                                fontSize = "0.9rem";
                            } else if (textLength <= 200) {
                                fontSize = "0.8rem";
                            } else {
                                fontSize = "0.7rem";
                            }
                        } else if (isMobile) {
                            if (textLength <= 50) {
                                fontSize = "1.4rem";
                            } else if (textLength <= 100) {
                                fontSize = "1.2rem";
                            } else if (textLength <= 150) {
                                fontSize = "1rem";
                            } else if (textLength <= 200) {
                                fontSize = "0.9rem";
                            } else {
                                fontSize = "0.8rem";
                            }
                        } else {
                            // Desktop sizes
                            if (textLength <= 50) {
                                fontSize = "2rem";
                            } else if (textLength <= 100) {
                                fontSize = "1.6rem";
                            } else if (textLength <= 150) {
                                fontSize = "1.3rem";
                            } else if (textLength <= 200) {
                                fontSize = "1.1rem";
                            } else if (textLength <= 300) {
                                fontSize = "1rem";
                            } else {
                                fontSize = "0.9rem";
                            }
                        }
                    } else {
                        // Chinese font sizes (slightly larger than half)
                        if (isSmallMobile) {
                            if (textLength <= 50) {
                                fontSize = "0.8rem";
                            } else if (textLength <= 100) {
                                fontSize = "0.7rem";
                            } else if (textLength <= 150) {
                                fontSize = "0.6rem";
                            } else if (textLength <= 200) {
                                fontSize = "0.55rem";
                            } else {
                                fontSize = "0.5rem";
                            }
                        } else if (isMobile) {
                            if (textLength <= 50) {
                                fontSize = "0.9rem";
                            } else if (textLength <= 100) {
                                fontSize = "0.8rem";
                            } else if (textLength <= 150) {
                                fontSize = "0.7rem";
                            } else if (textLength <= 200) {
                                fontSize = "0.6rem";
                            } else {
                                fontSize = "0.55rem";
                            }
                        } else {
                            // Desktop sizes
                            if (textLength <= 50) {
                                fontSize = "1.3rem";
                            } else if (textLength <= 100) {
                                fontSize = "1.1rem";
                            } else if (textLength <= 150) {
                                fontSize = "0.9rem";
                            } else if (textLength <= 200) {
                                fontSize = "0.8rem";
                            } else if (textLength <= 300) {
                                fontSize = "0.7rem";
                            } else {
                                fontSize = "0.6rem";
                            }
                        }
                    }

                    quoteText.style.fontSize = fontSize;
                }

                if (quoteAuthor) {
                    const authorLength = quoteAuthor.textContent.length;
                    let fontSize;

                    if (isEnglish) {
                        // English author font sizes
                        if (isSmallMobile) {
                            if (authorLength <= 10) {
                                fontSize = "1rem";
                            } else if (authorLength <= 20) {
                                fontSize = "0.9rem";
                            } else {
                                fontSize = "0.8rem";
                            }
                        } else if (isMobile) {
                            if (authorLength <= 10) {
                                fontSize = "1.1rem";
                            } else if (authorLength <= 20) {
                                fontSize = "1rem";
                            } else {
                                fontSize = "0.9rem";
                            }
                        } else {
                            // Desktop sizes
                            if (authorLength <= 10) {
                                fontSize = "1.5rem";
                            } else if (authorLength <= 20) {
                                fontSize = "1.3rem";
                            } else {
                                fontSize = "1.1rem";
                            }
                        }
                    } else {
                        // Chinese author font sizes (slightly larger than half)
                        if (isSmallMobile) {
                            if (authorLength <= 10) {
                                fontSize = "0.7rem";
                            } else if (authorLength <= 20) {
                                fontSize = "0.6rem";
                            } else {
                                fontSize = "0.55rem";
                            }
                        } else if (isMobile) {
                            if (authorLength <= 10) {
                                fontSize = "0.75rem";
                            } else if (authorLength <= 20) {
                                fontSize = "0.7rem";
                            } else {
                                fontSize = "0.6rem";
                            }
                        } else {
                            // Desktop sizes
                            if (authorLength <= 10) {
                                fontSize = "1rem";
                            } else if (authorLength <= 20) {
                                fontSize = "0.9rem";
                            } else {
                                fontSize = "0.8rem";
                            }
                        }
                    }

                    quoteAuthor.style.fontSize = fontSize;
                }
            }

            // Responsive font size adaptation for mobile
            function adaptFontSizeResponsive() {
                const essenceTitles =
                    document.querySelectorAll(".essence-title");
                const essenceDescs = document.querySelectorAll(".essence-desc");
                const isMobile = window.innerWidth <= 768;
                const isSmallMobile = window.innerWidth <= 480;

                essenceTitles.forEach((title) => {
                    const textLength = title.textContent.length;
                    let fontSize;

                    if (isSmallMobile) {
                        if (textLength <= 8) {
                            fontSize = "1.3rem";
                        } else if (textLength <= 12) {
                            fontSize = "1.2rem";
                        } else if (textLength <= 16) {
                            fontSize = "1.1rem";
                        } else if (textLength <= 20) {
                            fontSize = "1rem";
                        } else {
                            fontSize = "0.9rem";
                        }
                    } else if (isMobile) {
                        if (textLength <= 8) {
                            fontSize = "1.4rem";
                        } else if (textLength <= 12) {
                            fontSize = "1.3rem";
                        } else if (textLength <= 16) {
                            fontSize = "1.2rem";
                        } else if (textLength <= 20) {
                            fontSize = "1.1rem";
                        } else {
                            fontSize = "1rem";
                        }
                    } else {
                        // Desktop sizes
                        if (textLength <= 8) {
                            fontSize = "1.7rem";
                        } else if (textLength <= 12) {
                            fontSize = "1.5rem";
                        } else if (textLength <= 16) {
                            fontSize = "1.3rem";
                        } else if (textLength <= 20) {
                            fontSize = "1.2rem";
                        } else {
                            fontSize = "1.1rem";
                        }
                    }

                    title.style.fontSize = fontSize;
                });

                essenceDescs.forEach((desc) => {
                    const textLength = desc.textContent.length;
                    let fontSize;

                    if (isSmallMobile) {
                        if (textLength <= 6) {
                            fontSize = "1.1rem";
                        } else if (textLength <= 10) {
                            fontSize = "1rem";
                        } else if (textLength <= 14) {
                            fontSize = "0.9rem";
                        } else {
                            fontSize = "0.8rem";
                        }
                    } else if (isMobile) {
                        if (textLength <= 6) {
                            fontSize = "1.2rem";
                        } else if (textLength <= 10) {
                            fontSize = "1.1rem";
                        } else if (textLength <= 14) {
                            fontSize = "1rem";
                        } else {
                            fontSize = "0.9rem";
                        }
                    } else {
                        // Desktop sizes
                        if (textLength <= 6) {
                            fontSize = "1.4rem";
                        } else if (textLength <= 10) {
                            fontSize = "1.3rem";
                        } else if (textLength <= 14) {
                            fontSize = "1.2rem";
                        } else {
                            fontSize = "1.1rem";
                        }
                    }

                    desc.style.fontSize = fontSize;
                });
            }

            // Initialize font adaptation
            document.addEventListener("DOMContentLoaded", function () {
                initializeQuotes();
                adaptFontSizeResponsive();
                adaptQuoteFontSize();
                
                // Initialize quote section touch events for both language versions
                initializeQuoteTouchEvents();
                
                // 禁止右键菜单
                document.addEventListener('contextmenu', function(e) {
                    e.preventDefault();
                });
                
                // 禁止拖拽选择
                document.addEventListener('dragstart', function(e) {
                    e.preventDefault();
                });
                
                // 禁止选择事件
                document.addEventListener('selectstart', function(e) {
                    e.preventDefault();
                });
                
                // 禁止鼠标选择
                document.onselectstart = function() {
                    return false;
                };
                
                // 禁止拖拽
                document.ondragstart = function() {
                    return false;
                };
                
                // 禁用键盘复制快捷键和开发者工具
                document.addEventListener('keydown', function(e) {
                    // Handle quote navigation with arrow keys
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        previousQuote();
                        return;
                    }
                    if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        nextQuote();
                        return;
                    }
                    
                    // 检测是否按下 Ctrl + C / Ctrl + X / Ctrl + A / Ctrl + S / Ctrl + P
                    if (e.ctrlKey && (e.key === 'c' || e.key === 'x' || e.key === 'a' || e.key === 's' || e.key === 'p')) {
                        e.preventDefault();
                    }
                    // 检测是否按下 Cmd + C / Cmd + X / Cmd + A / Cmd + S / Cmd + P (Mac)
                    if (e.metaKey && (e.key === 'c' || e.key === 'x' || e.key === 'a' || e.key === 's' || e.key === 'p')) {
                        e.preventDefault();
                    }
                    // 禁用F12开发者工具
                    if (e.key === 'F12') {
                        e.preventDefault();
                    }
                    // 禁用Ctrl+Shift+I (开发者工具)
                    if (e.ctrlKey && e.shiftKey && e.key === 'I') {
                        e.preventDefault();
                    }
                    // 禁用Ctrl+Shift+J (控制台)
                    if (e.ctrlKey && e.shiftKey && e.key === 'J') {
                        e.preventDefault();
                    }
                    // 禁用Ctrl+U (查看源代码)
                    if (e.ctrlKey && e.key === 'u') {
                        e.preventDefault();
                    }
                });
            });

            // Re-adapt font sizes on window resize
            window.addEventListener("resize", function () {
                adaptFontSizeResponsive();
                adaptQuoteFontSize();
                
                // Reposition LOOK AT YOU texts if they exist
                const lookAtYouTexts = document.querySelectorAll('[style*="LOOK AT YOU"]');
                lookAtYouTexts.forEach(textElement => {
                    if (textElement.textContent === "LOOK AT YOU!") {
                        const isMobile = window.innerWidth <= 768;
                        const isSmallMobile = window.innerWidth <= 480;
                        
                        // Responsive margins
                        const marginX = isSmallMobile ? 30 : isMobile ? 40 : 50;
                        const marginY = isSmallMobile ? 40 : isMobile ? 50 : 50;
                        const maxWidth = window.innerWidth - (marginX * 2);
                        const maxHeight = window.innerHeight - (marginY * 2);
                        
                        // Get current position
                        const currentLeft = parseInt(textElement.style.left);
                        const currentTop = parseInt(textElement.style.top);
                        
                        // Adjust position if out of bounds
                        let newLeft = currentLeft;
                        let newTop = currentTop;
                        
                        if (currentLeft < marginX) {
                            newLeft = marginX;
                        } else if (currentLeft > maxWidth) {
                            newLeft = Math.max(marginX, maxWidth - 100);
                        }
                        
                        if (currentTop < marginY) {
                            newTop = marginY;
                        } else if (currentTop > maxHeight) {
                            newTop = Math.max(marginY, maxHeight - 60);
                        }
                        
                        // Update position
                        textElement.style.left = newLeft + 'px';
                        textElement.style.top = newTop + 'px';
                        
                        // Update max-width for responsive design
                        textElement.style.maxWidth = isSmallMobile ? '200px' : isMobile ? '300px' : '400px';
                    }
                });
            });

            // Add subtle parallax effect
            window.addEventListener("scroll", () => {
                const scrolled = window.pageYOffset;
                const circles = document.querySelector(".color-circle");
                if (circles) {
                    circles.style.transform = `translateY(${scrolled * 0.05}px)`;
                }
            });

            // Add click effect to color circle
            document
                .querySelector(".color-circle")
                .addEventListener("click", function (e) {
                    const ripple = document.createElement("div");
                    ripple.style.position = "absolute";
                    ripple.style.borderRadius = "50%";
                    ripple.style.background = "rgba(255, 255, 255, 0.3)";
                    ripple.style.transform = "scale(0)";
                    ripple.style.animation = "ripple 0.6s linear";
                    ripple.style.left = "50%";
                    ripple.style.top = "50%";
                    ripple.style.width = "100px";
                    ripple.style.height = "100px";
                    ripple.style.marginLeft = "-50px";
                    ripple.style.marginTop = "-50px";
                    ripple.style.zIndex = "0";

                    this.appendChild(ripple);

                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });

            // Random quotes from various sources
            const quotesData = [
                // Zhang Ailing
                {
                    en: "Because of understanding, there is compassion",
                    zh: "因为懂得，所以慈悲",
                    source: "张爱玲",
                    sourceEn: "Zhang Ailing",
                },
                {
                    en: "Life is a beautiful robe crawling with lice",
                    zh: "人生是一袭华美的袍，爬满了虱子",
                    source: "张爱玲",
                    sourceEn: "Zhang Ailing",
                },
                {
                    en: "Fame should come early",
                    zh: "出名要趁早",
                    source: "张爱玲",
                    sourceEn: "Zhang Ailing",
                },
                {
                    en: "Meet the person you want to meet among thousands of people",
                    zh: "于千万人之中遇见你所要遇见的人",
                    source: "张爱玲",
                    sourceEn: "Zhang Ailing",
                },
                {
                    en: "Love is not to look at each other, but together look in the same direction",
                    zh: "爱不是彼此凝视，而是一起看向同一个方向",
                    source: "张爱玲",
                    sourceEn: "Zhang Ailing",
                },

                // Wang Xiaobo
                {
                    en: "Wisdom itself is good",
                    zh: "智慧本身就是好的",
                    source: "王小波",
                    sourceEn: "Wang Xiaobo",
                },
                {
                    en: "I live to understand truths and encounter interesting things",
                    zh: "我活在世上，无非想要明白些道理，遇见些有趣的事",
                    source: "王小波",
                    sourceEn: "Wang Xiaobo",
                },
                {
                    en: "A person's joy should come from learning",
                    zh: "一个人倘若需要从思想中得到快乐，那么他的第一个欲望就是学习",
                    source: "王小波",
                    sourceEn: "Wang Xiaobo",
                },
                {
                    en: "You are willing, I love you forever; unwilling, I miss you forever",
                    zh: "你要是愿意，我就永远爱你；你要是不愿意，我就永远相思",
                    source: "王小波",
                    sourceEn: "Wang Xiaobo",
                },

                // The Little Prince
                {
                    en: "What is essential is invisible to the eye",
                    zh: "真正重要的东西是看不见的",
                    source: "小王子",
                    sourceEn: "The Little Prince",
                },
                {
                    en: "It is the time you have wasted for your rose that makes your rose so important",
                    zh: "正是你为你的玫瑰花费的时光使你的玫瑰变得如此重要",
                    source: "小王子",
                    sourceEn: "The Little Prince",
                },
                {
                    en: "All grown-ups were once children",
                    zh: "所有的大人都曾经是小孩",
                    source: "小王子",
                    sourceEn: "The Little Prince",
                },
                {
                    en: "The stars are beautiful because of a flower that cannot be seen",
                    zh: "星星发亮是为了让每一个人有一天都能找到属于自己的星星",
                    source: "小王子",
                    sourceEn: "The Little Prince",
                },
                {
                    en: "One sees clearly only with the heart",
                    zh: "只有用心才能看得清",
                    source: "小王子",
                    sourceEn: "The Little Prince",
                },

                // Black Books
                {
                    en: "I'm not a loser! I'm a dreamer!",
                    zh: "我不是失败者！我是梦想家！",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "I ate all your bees!",
                    zh: "我吃了你所有的蜜蜂！",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "Right, I'm going to have to ask you to stop being so happy.",
                    zh: "好吧，我得要求你别再这么快乐了。",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "Do you know what breakfast cereal is made of? It's made of all those little curly wooden shavings you find in pencil sharpeners!",
                    zh: "你知道早餐麦片是什么做的吗？是铅笔刨花器里那些小卷木屑做的！",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "I'm a little bit scared of dying. Are you? Oh, well, you wouldn't tell me if you were, would you?",
                    zh: "我有点害怕死亡。你呢？哦，即使你害怕，你也不会告诉我，对吧？",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "Wine is fine but whiskey's quicker",
                    zh: "酒虽好，但威士忌更快",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "I'm not a people person",
                    zh: "我不是社交型的人",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "The world is a beautiful place. We should all just shut up and eat cheese",
                    zh: "世界是个美丽的地方。我们都应该闭嘴吃奶酪",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "Books. The best weapons in the world",
                    zh: "书籍。世界上最好的武器",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },
                {
                    en: "I have a hangover. A hangover with a hangover",
                    zh: "我宿醉了。比宿醉还宿醉",
                    source: "布莱克书店",
                    sourceEn: "Black Books",
                },

                // Zelda
                {
                    en: "Courage need not be remembered, for it is never forgotten",
                    zh: "勇气无需被铭记，因为它永远不会被遗忘",
                    source: "塞尔达传说",
                    sourceEn: "The Legend of Zelda",
                },
                {
                    en: "It's dangerous to go alone",
                    zh: "独自前行很危险",
                    source: "塞尔达传说",
                    sourceEn: "The Legend of Zelda",
                },
                {
                    en: "The flow of time is always cruel",
                    zh: "时间的流逝总是残酷的",
                    source: "塞尔达传说",
                    sourceEn: "The Legend of Zelda",
                },
                {
                    en: "May the way of the Hero lead to the Triforce",
                    zh: "愿英雄之路通往三角力量",
                    source: "塞尔达传说",
                    sourceEn: "The Legend of Zelda",
                },

                {
                    en: "Death is like the wind, always by my side",
                    zh: "死亡如风，常伴吾身",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "My right arm is a lot stronger than my left arm",
                    zh: "我的右臂比左臂强壮得多",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "Demacia!",
                    zh: "德玛西亚！",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "You belong in a museum!",
                    zh: "你属于博物馆！",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "Rock solid",
                    zh: "坚如磐石",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "Captain Teemo on duty!",
                    zh: "提莫队长正在待命！",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "The heart is the strongest muscle",
                    zh: "心脏是最强的肌肉",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "Today is a good day to die",
                    zh: "今天是死亡的好日子",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "Balance in all things",
                    zh: "均衡存乎万物之间",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },
                {
                    en: "The cycle of life and death continues",
                    zh: "生死轮回，生生不息",
                    source: "英雄联盟",
                    sourceEn: "League of Legends",
                },

                // Game of Thrones
                {
                    en: "Winter is coming",
                    zh: "凛冬将至",
                    source: "权力的游戏",
                    sourceEn: "Game of Thrones",
                },
                {
                    en: "When you play the game of thrones, you win or you die",
                    zh: "权力的游戏，不胜即死",
                    source: "权力的游戏",
                    sourceEn: "Game of Thrones",
                },
                {
                    en: "A mind needs books as a sword needs a whetstone",
                    zh: "读书如磨剑",
                    source: "权力的游戏",
                    sourceEn: "Game of Thrones",
                },
                {
                    en: "The night is dark and full of terrors",
                    zh: "长夜漫漫，处处险恶",
                    source: "权力的游戏",
                    sourceEn: "Game of Thrones",
                },
                {
                    en: "What is dead may never die",
                    zh: "逝者不死",
                    source: "权力的游戏",
                    sourceEn: "Game of Thrones",
                },
                {
                    en: "No cost too great",
                    zh: "不惜一切代价",
                    source: "空洞骑士 - 苍白之王",
                    sourceEn: "Hollow Knight - The Pale King",
                },
                {
                    en: "Higher beings, these words are for you alone",
                    zh: "高等生灵，此言仅为汝等而述",
                    source: "空洞骑士 - 远古石碑",
                    sourceEn: "Hollow Knight - Ancient Tablets",
                },
                {
                    en: "No more dreams",
                    zh: "不再有梦",
                    source: "空洞骑士 - 骑士",
                    sourceEn: "Hollow Knight - The Knight",
                },
                {
                    en: "Take care of yourself out there",
                    zh: "外面要小心照顾自己",
                    source: "空洞骑士 - 老虫",
                    sourceEn: "Hollow Knight - Elderbug",
                },
                {
                    en: "Our light shall blaze from its dark sun",
                    zh: "我们的光芒将从黑暗之日中燃烧",
                    source: "空洞骑士 - 辉光",
                    sourceEn: "Hollow Knight - Radiance",
                },
                {
                    en: "You wield your nail like a club",
                    zh: "你挥舞钉子像挥棍子一样",
                    source: "空洞骑士 - 斯莱",
                    sourceEn: "Hollow Knight - Sly",
                },
                {
                    en: "So it can access a mind, then the weakness of the mind is revealed",
                    zh: "它能进入心灵，那么心灵的弱点就暴露了",
                    source: "空洞骑士 - 先知",
                    sourceEn: "Hollow Knight - Seer",
                },
                {
                    en: "Tiny squib, you approach fearless. Are you a hunter like me?",
                    zh: "小家伙，你无所畏惧地靠近。你也是像我一样的猎人吗？",
                    source: "空洞骑士 - 猎人",
                    sourceEn: "Hollow Knight - The Hunter",
                },
                {
                    en: "The path is opened. One way or another, an end awaits inside",
                    zh: "道路已开，无论如何，终点都在里面等着你",
                    source: "空洞骑士 - 大黄蜂",
                    sourceEn: "Hollow Knight - Hornet",
                },
                {
                    en: "No mind to think. No will to break. No voice to cry suffering. Born of God and Void",
                    zh: "无心可思，无意可破，无声可诉苦。生于神与虚空",
                    source: "空洞骑士 - 苍白之王",
                    sourceEn: "Hollow Knight - The Pale King",
                },
                {
                    en: "Soul of Wyrm. Soul of Root. Heart of Void",
                    zh: "巨龙之魂，根之魂，虚空之心",
                    source: "空洞骑士 - 苍白之王",
                    sourceEn: "Hollow Knight - The Pale King",
                },
                {
                    en: "You shall seal the blinding light that plagues their dreams. You are the Vessel. You are the Hollow Knight",
                    zh: "你将封印侵扰他们梦境的炽光。你是容器，你是空洞骑士",
                    source: "空洞骑士 - 苍白之王",
                    sourceEn: "Hollow Knight - The Pale King",
                },
                {
                    en: "The Pilgrim's way. Travellers of Hallownest, descend through verdant wilds and fungal groves to the city at this kingdom's heart. There all wishes shall be granted, all truths revealed",
                    zh: "朝圣者之路。圣巢的旅人们，穿越翠绿荒野与真菌林地，前往王国之心的城市。所有愿望都将在那里实现，所有真相都将揭晓",
                    source: "空洞骑士 - 石碑",
                    sourceEn: "Hollow Knight - Stone Tablet",
                },
                {
                    en: "Wanderers seeking death, welcome. May you find swift end upon our claws",
                    zh: "寻死的流浪者，欢迎你。愿你在我们的利爪下速得解脱",
                    source: "空洞骑士 - 螳螂族长老",
                    sourceEn: "Hollow Knight - Mantis Lords",
                },
                {
                    en: "The great gates have been sealed. None shall enter. None shall leave",
                    zh: "伟大的城门已被封锁。无人能进，无人能出",
                    source: "空洞骑士 - 泪之城石碑",
                    sourceEn: "Hollow Knight - City of Tears Tablet",
                },
                {
                    en: "Through its sacrifice Hallownest lasts eternal",
                    zh: "因其牺牲，圣巢得以永存",
                    source: "空洞骑士 - 空洞骑士纪念碑",
                    sourceEn: "Hollow Knight - Hollow Knight Memorial",
                },
                {
                    en: "Protect yourself… You are our last…",
                    zh: "保护好自己……你是我们的最后希望……",
                    source: "空洞骑士 - 梦盾雕像",
                    sourceEn: "Hollow Knight - Dreamshield Totem",
                },
                {
                    en: "To witness secrets sealed, one must endure the harshest punishment",
                    zh: "欲见封印之秘，必承最严酷之罚",
                    source: "空洞骑士 - 痛苦之路",
                    sourceEn: "Hollow Knight - Path of Pain",
                },
                {
                    en: "Ho there, traveller. I'm afraid there's only me left to offer welcome. Our town's fallen quiet you see. The other residents, they've all disappeared. Headed down that well, one by one, into the caverns below",
                    zh: "你好，旅人。恐怕只剩我能欢迎你了。我们的镇子已经沉寂，其他居民都消失了，一个接一个地跳进了井下的洞穴",
                    source: "空洞骑士 - 老虫",
                    sourceEn: "Hollow Knight - Elderbug",
                },
                {
                    en: "The ordinary days we experience may actually be a series of continuous miracles",
                    zh: "我们所经历的每个平凡的日常，也许就是连续发生的奇迹",
                    source: "日常",
                    sourceEn: "Nichijou",
                },
                {
                    en: "We live in the moment; we are creatures who exist in the moment",
                    zh: "我们是活在瞬间里的，我们是活在瞬间里的生物啊",
                    source: "日常",
                    sourceEn: "Nichijou",
                },
                {
                    en: "I like the way you die, boy",
                    zh: "我喜欢你死的样子，小子",
                    source: "被解救的姜戈",
                    sourceEn: "Django Unchained",
                },
                {
                    en: "Revenge is a dish best served cold",
                    zh: "复仇是一道最好冷着吃的菜",
                    source: "杀死比尔",
                    sourceEn: "Kill Bill",
                },
                {
                    en: "Say 'what' again. I dare you, I double dare you motherf***er, say what one more Goddamn time!",
                    zh: "再说一次'什么'。我敢你，再敢你一次，你再说一次'什么'试试！",
                    source: "低俗小说",
                    sourceEn: "Pulp Fiction",
                },
                {
                    en: "It's a deal, it's a steal, it's the sale of the fucking century!",
                    zh: "成交，捡漏，世纪大甩卖！",
                    source: "两杆大烟枪",
                    sourceEn: "Lock, Stock and Two Smoking Barrels",
                },
                {
                    en: "If the milk turns out to be sour, I ain't the kind of pussy to drink it",
                    zh: "如果牛奶变酸了，我可不是那种还会喝下去的傻瓜",
                    source: "两杆大烟枪",
                    sourceEn: "Lock, Stock and Two Smoking Barrels",
                },
                {
                    en: "Do you know what 'nemesis' means?",
                    zh: "你知道'天谴'是什么意思吗？",
                    source: "偷拐抢骗",
                    sourceEn: "Snatch",
                },
                {
                    en: "You should never underestimate the predictability of stupidity",
                    zh: "你永远不要低估愚蠢的可预测性",
                    source: "偷拐抢骗",
                    sourceEn: "Snatch",
                },
                {
                    en: "Heavy is good, heavy is reliable. If it doesn't work, you can always hit them with it",
                    zh: "重是好事，重就可靠。如果它不管用，你还可以用它砸人",
                    source: "偷拐抢骗",
                    sourceEn: "Snatch",
                },
                {
                    en: "There's fuckery afoot",
                    zh: "有鬼",
                    source: "绅士们",
                    sourceEn: "The Gentlemen",
                },
                {
                    en: "If you wish to be the king of the jungle, it's not enough to act like a king. You must be the king",
                    zh: "如果你想成为丛林之王，光有王者的气势还不够，你必须成为王",
                    source: "绅士们",
                    sourceEn: "The Gentlemen",
                },
                {
                    en: "In the jungle, the only way a lion survives is not by acting like a king, but by being the king",
                    zh: "在丛林里，狮子之所以能活下来，不是因为它像国王，而是因为它就是国王",
                    source: "绅士们",
                    sourceEn: "The Gentlemen",
                }, // Cyberpunk: Edgerunners
                {
                    en: "You gotta live your own life",
                    zh: "你得活得像你自己",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                {
                    en: "You're a natural-born Edgerunner",
                    zh: "你是个天生的边缘行者",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                {
                    en: "Night City won't change, but you can choose not to be swallowed by it",
                    zh: "夜之城不会改变，但你可以选择不被它吞噬",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                {
                    en: "We're all children of Night City",
                    zh: "我们都是夜之城的孩子",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                {
                    en: "As long as you're alive, there's hope",
                    zh: "只要还活着，就有希望",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                // Special trigger quote for easter egg
                {
                    en: "You're a natural-born Edgerunner.",
                    zh: "你是个天生的边缘行者",
                    source: "赛博朋克：边缘行者",
                    sourceEn: "Cyberpunk: Edgerunners",
                },
                // Zote Precept Fifty-Six for easter egg
                {
                    en: "Precept Fifty-Six: 'Do Not Dream.' Dreams are dangerous things. Strange ideas come from dreams, and strange ideas lead to dangerous actions. You are meant to be like me: not to dream. -Zote",
                    zh: "戒律五十六: 不要做梦。梦想是危险的东西。奇怪的想法源自梦想，而奇怪的想法会导致危险的行为。你应该像我一样，不要做梦。-左特",
                    source: "空洞骑士",
                    sourceEn: "Hollow Knight",
                },
            ];

            // Create structured quotes for each language
            const quotes = {
                english: quotesData.map((q) => ({
                    en: q.en,
                    zh: q.zh,
                    source: q.sourceEn || q.source,
                    sourceEn: q.sourceEn,
                })),
                chinese: quotesData.map((q) => ({
                    en: q.en,
                    zh: q.zh,
                    source: q.source,
                    sourceEn: q.sourceEn,
                })),
            };

            // Current quotes displayed in each card
            let currentQuotes = [0, 1, 2];

            // Initialize current quotes based on language
            function initializeQuotes() {
                // Set initial quote indices to match the hardcoded cards
                // These correspond to specific quotes in our quotes array
                const initialIndices = {
                    english: [83, 89, 1], // Game of Thrones "night is dark", Black Books "hangover", Zhang Ailing "life is a robe"
                    chinese: [83, 89, 1],
                };
                currentQuotes = initialIndices.english; // Start with English indices
            }

            // New Phoebe easter egg system
            // Each easter egg has a permanent state (true once triggered, never resets)
            let easterEggTriggered = {
                langToggle: false, // they-dont-know-that-we-know-they-know-we-know
                pengClick: false, // do-you-have-a-plan-i-dont-even-have-a-pla
                tributeClick: false, // see-hes-her-lobster
                essenceCard: false, // that-is-brand-new-information-breaking-news-new-information-expected-not-surprised-phoebe-meme-friends-101soundboards.mp3
                phoebeWisdom: false, // i-wish-i-could-but-i-dont-want-to-101soundboards.mp3
                phoebeWisdomBoss: false, // boss.mp3
                emailIcon: false, // email.mp3
                wechatIcon: false, // computer.mp3
            };

            // Trigger count limits for Phoebe easter eggs (max 3 times each)
            let easterEggTriggerCounts = {
                langToggle: 0,
                pengClick: 0,
                tributeClick: 0,
                essenceCard: 0,
                phoebeWisdom: 0,
                phoebeKeyboard: 0,
                c137: 0,
                phoebeWisdomBoss: 0,
                emailIcon: 0,
                wechatIcon: 0,
            };

            let clickCounters = {
                langToggle: 0, // cumulative counter
                pengClick: 0, // rapid click counter
                tributeClick: 0, // rapid click counter
                essenceCard: 0, // rapid click counter
                phoebeWisdom: 0, // rapid click counter
                phoebeWisdomBoss: 0, // rapid click counter
                emailIcon: 0, // rapid click counter
                wechatIcon: 0, // rapid click counter
            };

            let clickTimers = {
                langToggle: null,
                pengClick: null,
                tributeClick: null,
                essenceCard: null,
                phoebeWisdom: null,
                phoebeWisdomBoss: null,
                emailIcon: null,
                wechatIcon: null,
            };

            let keySequence = [];
            let keyTimer = null;
            let whoSingingTimer = null;
            let isListeningForYou = false;

            // Rick portal keyboard tracking variables
            let rickKeySequence = [];
            let rickKeyTimer = null;
            let rickPortalTriggered = false;

            // Pickle Rick keyboard tracking variables
            let pickleRickKeySequence = [];
            let pickleRickKeyTimer = null;
            let pickleRickTriggered = false;

            // Wubba Lubba Dub Dub keyboard tracking variables
            let wubbaKeySequence = [];
            let wubbaKeyTimer = null;
            let wubbaTriggered = false;

            // Language switching keyboard tracking variables
            let languageKeySequence = [];
            let languageKeyTimer = null;

            // Phoebe easter egg keyboard tracking variables
            let phoebeKeySequence = [];
            let phoebeKeyTimer = null;

            // C137 easter egg keyboard tracking variables
            let c137KeySequence = [];
            let c137KeyTimer = null;
            let c137Triggered = false;

            // Additional Easter Egg state variables
            let zeldaEasterEggTriggered = false;
            let runawayEasterEggTriggered = false;
            let smellyCatEasterEggTriggered = false;

            // Cyberpunk 2077 Easter Egg variables
            let cyberpunkEasterEggTriggered = false;
            
            // Zote Easter Egg variables
            let zoteEasterEggTriggered = false;
            let currentZotePrecept = 1; // Start with Precept 1
let zoteCycleCount = 0; // Track how many complete cycles through all 57 precepts
            const zotePrecepts = [
                // Precept 1
                {
                    en: {
                        title: "Precept One: 'Always Win Your Battles.'",
                        content: "Losing a battle earns you nothing and teaches you nothing. Win your battles, or don't engage in them at all!"
                    },
                    zh: {
                        title: "戒律一: 永远只打胜仗",
                        content: "在输掉的战斗中，你不能获得任何战利品，更不能学到什么有用的东西。所以，你要打赢所有的战斗，或者压根就不参与！"
                    }
                },
                // Precept 2
                {
                    en: {
                        title: "Precept Two: 'Never Let Them Laugh at You.'",
                        content: "Fools laugh at everything, even at their superiors. But beware, laughter isn't harmless! Laughter spreads like a disease, and soon everyone is laughing at you. You need to strike at the source of this perverse merriment quickly to stop it from spreading."
                    },
                    zh: {
                        title: "戒律二: 永远不要让别人嘲笑你",
                        content: "傻瓜们会嘲笑一切，甚至会嘲笑比他们强大的人。但是，你要注意，嘲笑声本身其实就是有害的！它会像疾病一样蔓延开来，不久之后，所有人都会开始嘲笑你。所以，你需要做的是迅速根除它，以阻止其扩散。"
                    }
                },
                // Precept 3
                {
                    en: {
                        title: "Precept Three: 'Always Be Rested.'",
                        content: "Fighting and adventuring take their toll on your body. When you rest, your body strengthens and repairs itself. The longer you rest, the stronger you become."
                    },
                    zh: {
                        title: "戒律三: 永远要保证足够的休息",
                        content: "战斗和冒险会消耗你的体力。而只有当你休息的时候，你的体力才会恢复。所以，你休息的时间越长就越强大。"
                    }
                },
                // Precept 4
                {
                    en: {
                        title: "Precept Four: 'Forget Your Past.'",
                        content: "The past is painful, and thinking about your past can only bring you misery. Think about something else instead, such as the future, or some food."
                    },
                    zh: {
                        title: "戒律四: 学会忘记过去",
                        content: "过去是痛苦的，回忆过去只会徒增伤悲。相反，你可以试着想想别的事情，比如未来或者美食等。"
                    }
                },
                // Precept 5
                {
                    en: {
                        title: "Precept Five: 'Strength Beats Strength.'",
                        content: "Is your opponent strong? No matter! Simply overcome their strength with even more strength, and they'll soon be defeated."
                    },
                    zh: {
                        title: "戒律五: 谨记用力量打败力量",
                        content: "你的对手很强大？没关系！只需要用比他们更强大的力量去对付他们，你很快就可以战胜他们。"
                    }
                },
                // Precept 6
                {
                    en: {
                        title: "Precept Six: 'Choose Your Own Fate.'",
                        content: "Our elders teach that our fate is chosen for us before we are even born. I disagree."
                    },
                    zh: {
                        title: "戒律六: 学会把握你自己的命运",
                        content: "我们的长辈常教导我们说，我们的命运在我们出生之前就已注定，说实话，我不同意。"
                    }
                },
                // Precept 7
                {
                    en: {
                        title: "Precept Seven: 'Mourn Not the Dead.'",
                        content: "When we die, do things get better for us or worse? There's no way to tell, so we shouldn't bother mourning. Or celebrating for that matter."
                    },
                    zh: {
                        title: "戒律七: 永远不要为死者悲伤",
                        content: "死后的世界将会是怎样？会变得更好还是更坏？没人知道，所以对于\"死亡\"这件事，我们无需悲伤，更无需欢喜。"
                    }
                },
                // Precept 8
                {
                    en: {
                        title: "Precept Eight: 'Travel Alone.'",
                        content: "You can rely on nobody, and nobody will always be loyal. Therefore, nobody should be your constant companion."
                    },
                    zh: {
                        title: "戒律八: 学会独自旅行",
                        content: "你不要去依赖任何人，再者，也没人会永远忠诚。所以，请记住：没人会永远与你同行。"
                    }
                },
                // Precept 9
                {
                    en: {
                        title: "Precept Nine: 'Keep Your Home Tidy.'",
                        content: "Your home is where you keep your most prized possession - yourself. Therefore, you should make an effort to keep it nice and clean."
                    },
                    zh: {
                        title: "戒律九: 永远让自己的家保持干净整洁",
                        content: "你自己就是你最宝贵的财产——你的家是你的安身立命之所。所以，你要尽可能地保持它的干净与整洁。"
                    }
                },
                // Precept 10
                {
                    en: {
                        title: "Precept Ten: 'Keep Your Weapon Sharp.'",
                        content: "I make sure that my weapon, 'Life Ender', is kept well-sharpened at all times. This makes it much easier to cut things."
                    },
                    zh: {
                        title: "戒律十: 请让你的武器时刻保持锋利无比",
                        content: "于我而言，我会让我的武器——\"生命终结者\"从始至终都锋利无比。这样的话，砍东西就会容易得多。"
                    }
                },
                // Precept 11
                {
                    en: {
                        title: "Precept Eleven: 'Mothers Will Always Betray You.'",
                        content: "This Precept explains itself."
                    },
                    zh: {
                        title: "戒律十一: 谨防母亲的背叛",
                        content: "这一条不言自明。"
                    }
                },
                // Precept 12
                {
                    en: {
                        title: "Precept Twelve: 'Keep Your Cloak Dry.'",
                        content: "If your cloak gets wet, dry it as soon as you can. Wearing wet cloaks is unpleasant, and can lead to illness."
                    },
                    zh: {
                        title: "戒律十二: 谨记让你的披风保持干燥",
                        content: "如果你的披风湿了，就尽快把它弄干。因为穿着湿漉漉的披风不仅会很不舒服，而且还容易生病。"
                    }
                },
                // Precept 13
                {
                    en: {
                        title: "Precept Thirteen: 'Never Be Afraid.'",
                        content: "Fear can only hold you back. Facing your fears can be a tremendous effort. Therefore, you should just not be afraid in the first place."
                    },
                    zh: {
                        title: "戒律十三: 永远不要害怕",
                        content: "恐惧只会让你退缩。我知道直面恐惧需要付出巨大的努力。但是，直面恐惧的前提就是要先不害怕。"
                    }
                },
                // Precept 14
                {
                    en: {
                        title: "Precept Fourteen: 'Respect Your Superiors.'",
                        content: "If someone is your superior in strength or intellect or both, you need to show them your respect. Don't ignore them or laugh at them."
                    },
                    zh: {
                        title: "戒律十四: 永远尊重强者",
                        content: "尊重力量或者智慧，抑或二者都强于你的人。不要轻视或者嘲笑他们。"
                    }
                },
                // Precept 15
                {
                    en: {
                        title: "Precept Fifteen: 'One Foe, One Blow.'",
                        content: "You should only use a single blow to defeat an enemy. Any more is a waste. Also, by counting your blows as you fight, you'll know how many foes you've defeated."
                    },
                    zh: {
                        title: "戒律十五: 谨记对付一个敌人只用一拳",
                        content: "一拳便足以对付一个敌人，再多就是浪费了。这样的话，只需记住自己出了几拳，你就知道已经打败多少敌人了。"
                    }
                },
                // Precept 16
                {
                    en: {
                        title: "Precept Sixteen: 'Don't Hesitate.'",
                        content: "Once you've made a decision, carry it out and don't look back. You'll achieve much more this way."
                    },
                    zh: {
                        title: "戒律十六: 永远不要迟疑",
                        content: "一旦你决定了就去做，不要瞻前顾后。这种行事方式会让你终生受益，进而取得更多的成就。"
                    }
                },
                // Precept 17
                {
                    en: {
                        title: "Precept Seventeen: 'Believe In Your Strength.'",
                        content: "Others may doubt you, but there's someone you can always trust. Yourself. Make sure to believe in your own strength, and you will never falter."
                    },
                    zh: {
                        title: "戒律十七: 永远相信自己的力量",
                        content: "别人可能会怀疑你，但有一个人是永远值得你信赖的——你自己。相信自己的力量能让你的步伐永远稳健。"
                    }
                },
                // Precept 18
                {
                    en: {
                        title: "Precept Eighteen: 'Seek Truth in the Darkness.'",
                        content: "This Precept also explains itself."
                    },
                    zh: {
                        title: "戒律十八: 学会在黑暗中寻求真理",
                        content: "这个戒律同样也不言自明。"
                    }
                },
                // Precept 19
                {
                    en: {
                        title: "Precept Nineteen: 'If You Try, Succeed.'",
                        content: "If you're going to attempt something, make sure you achieve it. If you do not succeed, then you have actually failed! Avoid this at all costs."
                    },
                    zh: {
                        title: "戒律十九: 谨记只有尝试了，你才有可能成功",
                        content: "如果你想尝试去做什么，就一定要坚持做到。一件事，要么成功，要么失败！所以，你要不惜一切代价获得成功。"
                    }
                },
                // Precept 20
                {
                    en: {
                        title: "Precept Twenty: 'Speak Only the Truth.'",
                        content: "When speaking to someone, it is courteous and also efficient to speak truthfully. Beware though that speaking Truthfully may make you enemies. This is something you'll have to bear."
                    },
                    zh: {
                        title: "戒律二十: 绝不撒谎",
                        content: "和别人交流时，说真话会让人觉得你很谦恭，同时，也会使得整个谈话过程变得很高效。不过，你要当心，说真话很容易会让你树敌，但这也是你必须要承担的代价。"
                    }
                },
                // Precept 21
                {
                    en: {
                        title: "Precept Twenty-One: 'Be Aware of Your Surroundings.'",
                        content: "Don't just walk along staring at the ground! You need to look up every so often, to make sure nothing takes you by surprise."
                    },
                    zh: {
                        title: "戒律二十一: 要时刻警惕周围的环境",
                        content: "别只顾着埋头走路！你也要学会抬头看路，免得被偷袭。"
                    }
                },
                // Precept 22
                {
                    en: {
                        title: "Precept Twenty-Two: 'Abandon the Nest.'",
                        content: "As soon as I could, I left my birthplace and made my way out into the world. Do not linger in the nest. There is nothing for you there."
                    },
                    zh: {
                        title: "戒律二十二: 好男儿要志在四方",
                        content: "只要有机会，我就会离开我的家乡，到处寻名山、访高友。梨园虽好，但终究不是久留之所。要知道，\"温柔乡\"即是\"英雄冢\"。"
                    }
                },
                // Precept 23
                {
                    en: {
                        title: "Precept Twenty-Three: 'Identify the Foe's Weak Point.'",
                        content: "Every foe you encounter has a weak point, such as a crack in their shell or being asleep. You must constantly be alert and scrutinising your enemy to detect their weakness!"
                    },
                    zh: {
                        title: "戒律二十三: 要摸清敌人的软肋",
                        content: "你遇到的每一个敌人都有其软肋，比如他们的身上有伤或者正在酣睡等。你必须时刻保持警惕，并且仔细观察你的敌人，从而发现他们的软肋！"
                    }
                },
                // Precept 24
                {
                    en: {
                        title: "Precept Twenty-Four: 'Strike the Foe's Weak Point.'",
                        content: "Once you have identified your foe's weak point as per the previous Precept, strike it. This will instantly destroy them."
                    },
                    zh: {
                        title: "戒律二十四: 学会痛击敌人的软肋",
                        content: "一旦发现敌人的软肋，你就应对其发起猛烈地攻击。这样你就能很快地歼灭他们了。"
                    }
                },
                // Precept 25
                {
                    en: {
                        title: "Precept Twenty-Five: 'Protect Your Own Weak Point.'",
                        content: "Be aware that your foe will try to identify your weak point, so you must protect it. The best protection? Never having a weak point in the first place."
                    },
                    zh: {
                        title: "戒律二十五: 学会隐藏自己的软肋",
                        content: "要知道你的敌人也会试图去摸清你的软肋，所以你必须藏好它们。那么最佳的藏法是什么呢？从来就没有软肋。"
                    }
                },
                // Precept 26
                {
                    en: {
                        title: "Precept Twenty-Six: 'Don't Trust Your Reflection.'",
                        content: "When peering at certain shining surfaces, you may see a copy of your own face. The face will mimic your movements and seems similar to your own, but I don't think it can be trusted."
                    },
                    zh: {
                        title: "戒律二十六: 不要相信你的倒影",
                        content: "当你对着某些光亮的表面时，你可能会看到一张自己的脸。而且这张脸会模仿你的各个动作，看起来就和你一模一样，但请你不要因此而相信它。"
                    }
                },
                // Precept 27
                {
                    en: {
                        title: "Precept Twenty-Seven: 'Eat As Much As You Can.'",
                        content: "When having a meal, eat as much as you possibly can. This gives you extra energy, and means you can eat less frequently."
                    },
                    zh: {
                        title: "戒律二十七: 要尽量多吃",
                        content: "吃饭时，能吃多少吃多少。这能让你获得足够多的能量，而且还间接地减少了吃饭的次数。"
                    }
                },
                // Precept 28
                {
                    en: {
                        title: "Precept Twenty-Eight: 'Don't Peer Into the Darkness.'",
                        content: "If you peer into the darkness and can't see anything for too long, your mind will start to linger over old memories. Memories are to be avoided, as per Precept Four."
                    },
                    zh: {
                        title: "戒律二十八: 永远不要凝视黑暗",
                        content: "如果当你凝视黑暗而久久不见一物时，你的大脑就会开始流连于陈旧的记忆，而戒律四已经说过了，要学会忘记过去，避免在过去的记忆中无休止地纠缠。"
                    }
                },
                // Precept 29
                {
                    en: {
                        title: "Precept Twenty-Nine: 'Develop Your Sense of Direction.'",
                        content: "It's easy to get lost when travelling through winding, twisting caverns. Having a good sense of direction is like having a magical map inside of your head. Very useful."
                    },
                    zh: {
                        title: "戒律二十九: 要刻意训练你的方向感",
                        content: "在蜿蜒曲折的洞穴中旅行很容易迷路。而有一个好的方向感就像有一张神奇的地图在你的脑子里，这非常有用。"
                    }
                },
                // Precept 30
                {
                    en: {
                        title: "Precept Thirty: 'Never Accept a Promise.'",
                        content: "Spurn the promises of others, as they are always broken. Promises of love or betrothal are to be avoided especially."
                    },
                    zh: {
                        title: "戒律三十: 永远不要轻信别人的诺言",
                        content: "诺言有时候并不是很可靠，因为许诺者经常会食言，所以，不要轻信它，尤其是爱情或者婚姻的诺言。"
                    }
                },
                // Precept 31
                {
                    en: {
                        title: "Precept Thirty-One: 'Disease Lives Inside of Dirt.'",
                        content: "You'll get sick if you spend too much time in filthy places. If you are staying in someone else's home, demand the highest level of cleanliness from your host."
                    },
                    zh: {
                        title: "戒律三十一: 要注意个人卫生",
                        content: "要知道，在脏兮兮的地方呆得太久是会让你生病的。所以，如果去别人家里，请要求主人给你提供最高规格的卫生条件。"
                    }
                },
                // Precept 32
                {
                    en: {
                        title: "Precept Thirty-Two: 'Names Have Power.'",
                        content: "Names have power, and so to name something is to grant it power. I myself named my nail 'Life Ender'."
                    },
                    zh: {
                        title: "戒律三十二: 名字有其内在的力量",
                        content: "所有的名字都有其内在的力量，所以，当你在给某个事物起名字的时候，你其实就是在赋予它力量。比如，我就给我自己的骨钉取名为\"生命终结者\"。"
                    }
                },
                // Precept 33
                {
                    en: {
                        title: "Precept Thirty-Three: 'Show the Enemy No Respect.'",
                        content: "Being gallant to your enemies is no virtue! If someone opposes you, they don't deserve respect or kindness or mercy."
                    },
                    zh: {
                        title: "戒律三十三: 永远不要向你的敌人献殷勤",
                        content: "向你的敌人献殷勤并不是什么美德！因为你的敌人不配得到你的尊重、仁慈和怜悯。"
                    }
                },
                // Precept 34
                {
                    en: {
                        title: "Precept Thirty-Four: 'Don't Eat Immediately Before Sleeping.'",
                        content: "This can cause restlessness and indigestion. It's just common sense."
                    },
                    zh: {
                        title: "戒律三十四: 睡前不要吃东西",
                        content: "睡前吃东西首先不好消化，其次还影响休息，这已经是常识了。"
                    }
                },
                // Precept 35
                {
                    en: {
                        title: "Precept Thirty-Five: 'Up is Up, Down is Down.'",
                        content: "If you fall over in the darkness, it can be easy to lose your bearing and forget which way is up. Keep this Precept in mind!"
                    },
                    zh: {
                        title: "戒律三十五: 上就是上，下就是下",
                        content: "如果在黑暗中摔倒的话，你很容易就会失去方向感，忘记哪条路是向上走的。所以，请记住这条戒律！"
                    }
                },
                // Precept 36
                {
                    en: {
                        title: "Precept Thirty-Six: 'Eggshells are brittle.'",
                        content: "Once again, this Precept explains itself."
                    },
                    zh: {
                        title: "戒律三十六: 谨记蛋壳很容易破碎",
                        content: "这条戒律又是不言自明的。"
                    }
                },
                // Precept 37
                {
                    en: {
                        title: "Precept Thirty-Seven: 'Borrow, But Do Not Lend.'",
                        content: "If you lend and are repayed, you gain nothing. If you borrow but do not repay, you gain everything."
                    },
                    zh: {
                        title: "戒律三十七: 永远只从别人那里借东西，自己的东西绝不外借",
                        content: "如果别人有借有还，那么到头来你什么也得不到。但是，如果你只借不还，那么你就会赚得钵丰盆满。"
                    }
                },
                // Precept 38
                {
                    en: {
                        title: "Precept Thirty-Eight: 'Beware the Mysterious Force.'",
                        content: "A mysterious force bears down on us from above, pushing us downwards. If you spend too long in the air, the force will crush you against the ground and destroy you. Beware!"
                    },
                    zh: {
                        title: "戒律三十八: 请警惕神秘的力量",
                        content: "在我们头上一直有一股神秘的力量将我们往下压。如果你在空中停留得太久的话，那么那股神秘的力量就会把你压进地里，进而让你丢掉性命。所以，你要当心啊！"
                    }
                },
                // Precept 39
                {
                    en: {
                        title: "Precept Thirty-Nine: 'Eat Quickly and Drink Slowly.'",
                        content: "Your body is a delicate thing and you must fuel it with great deliberation. Food must go in as fast as possible, but fluids at a slower rate."
                    },
                    zh: {
                        title: "戒律三十九: 学会快吃慢饮",
                        content: "我们的身体是一个十分脆弱的东西，所以补充能量的时候，你必须小心谨慎。吃饭时你可以尽量快一点，但喝水的时候你一定要慢一些。"
                    }
                },
                // Precept 40
                {
                    en: {
                        title: "Precept Forty: 'Obey No Law But Your Own.'",
                        content: "Laws written by others may inconvenience you or be a burden. Let your own desires be the only law."
                    },
                    zh: {
                        title: "戒律四十: 随心所欲，随心而动",
                        content: "过分地拘泥于规则反而会成为你的负担，有时候，你需要灵活变通，跟随自己的节奏。"
                    }
                },
                // Precept 41
                {
                    en: {
                        title: "Precept Forty-One: 'Learn to Detect Lies.'",
                        content: "When others speak, they usually lie. Scrutinise and question them relentlessly until they reveal their deceit."
                    },
                    zh: {
                        title: "戒律四十一: 学会分辨谎言",
                        content: "别人会经常撒谎，所以，你要尖锐地指出来，并且当面质疑他们，直到他们承认自己撒谎了。"
                    }
                },
                // Precept 42
                {
                    en: {
                        title: "Precept Forty-Two: 'Spend Geo When You Have It.'",
                        content: "Some will cling onto their Geo, even taking it into the dirt with them when they die. It is better to spend it when you can, so you can enjoy various things in life."
                    },
                    zh: {
                        title: "戒律四十二: 永远不要做守财奴",
                        content: "有些人宁愿将钱带进棺材，也不愿花它们，这就是典型的守财奴。所以，你要及时行乐，能花的时候就花才是聪明人的做法，不然你就享受不到生命中的各种乐趣了。"
                    }
                },
                // Precept 43
                {
                    en: {
                        title: "Precept Forty-Three: 'Never Forgive.'",
                        content: "If someone asks forgiveness of you, for instance a brother of yours, always deny it. That brother, or whoever it is, doesn't deserve such a thing."
                    },
                    zh: {
                        title: "戒律四十三: 永远不要宽恕别人",
                        content: "如果有人恳求你的原谅，比如你的兄弟，一定要拒绝。任何人都不配得到你的原谅，包括你的那个兄弟。"
                    }
                },
                // Precept 44
                {
                    en: {
                        title: "Precept Forty-Four: 'You Can Not Breathe Water.'",
                        content: "Water is refreshing, but if you try to breathe it you are in for a nasty shock."
                    },
                    zh: {
                        title: "戒律四十四: 不要试图在水里呼吸",
                        content: "水是可以用来提神的，但如果你想试图在里面呼吸的话，你会窒息而死的。"
                    }
                },
                // Precept 45
                {
                    en: {
                        title: "Precept Forty-Five: 'One Thing Is Not Another.'",
                        content: "This one should be obvious, but I've had others try to argue that one thing, which is clearly what it is and not something else, is actually some other thing, which it isn't. Stay on your guard!"
                    },
                    zh: {
                        title: "戒律四十五: 谨记一个事物永远不可能变成另外一个事物",
                        content: "这条戒律应该是显而易见的，但总是有人试图指鹿为马，混淆视听。所以，你要小心啊！"
                    }
                },
                // Precept 46
                {
                    en: {
                        title: "Precept Forty-Six: 'The World is Smaller Than You Think.'",
                        content: "When young, you tend to think that the world is vast, huge, gigantic. It's only natural. Unfortunately, it's actually quite a lot smaller than that. I can say this, now having travelled everywhere in the land."
                    },
                    zh: {
                        title: "戒律四十六: 谨记世界没你想象的那么大",
                        content: "年轻时，你认为天广地阔，这是很自然的。但不幸的是，世界实际上要小得多。这是我多年翻山越岭、跋山涉水后的感悟。"
                    }
                },
                // Precept 47
                {
                    en: {
                        title: "Precept Forty-Seven: 'Make Your Own Weapon.'",
                        content: "Only you know exactly what is needed in your weapon. I myself fashioned 'Life Ender' from shellwood at a young age. It has never failed me. Nor I it."
                    },
                    zh: {
                        title: "戒律四十七: 要打造属于你自己的武器",
                        content: "只有你自己知道你想要什么样的武器。在我在很小的时候，我就用壳木制作了一把骨钉——\"生命终结者\"。并且，它从未让我失望过，同样地，我也如此。"
                    }
                },
                // Precept 48
                {
                    en: {
                        title: "Precept Forty-Eight: 'Be Careful With Fire.'",
                        content: "Fire is a type of hot spirit that dances about recklessly. It can warm you and provide light, but it will also singe your shell if it gets too close."
                    },
                    zh: {
                        title: "戒律四十八: 请小心火烛",
                        content: "火是一个可以肆意妄为的精灵。它能温暖你、照亮你，但如果你靠得太近的话，它也会烧焦你。"
                    }
                },
                // Precept 49
                {
                    en: {
                        title: "Precept Forty-Nine: 'Statues are Meaningless.'",
                        content: "Do not honour them! No one has ever made a statue of you or I, so why should we pay them any attention?"
                    },
                    zh: {
                        title: "戒律四十九: 谨记雕像毫无意义",
                        content: "不要去崇拜雕像！况且，从来就没有人为你我立像，那我们为什么还要关注这个玩意？"
                    }
                },
                // Precept 50
                {
                    en: {
                        title: "Precept Fifty: 'Don't Linger on Mysteries.'",
                        content: "Some things in this world appear to us as puzzles. Or enigmas. If the meaning behind something is not immediately evident though, don't waste any time thinking about it. Just move on."
                    },
                    zh: {
                        title: "戒律五十: 不要痴迷于神秘",
                        content: "生活有时候会让我们一头雾水，满脸疑惑。此时，如果你不能立刻明白它背后所暗含的意义，那么就不要浪费时间去刨根究底了，大胆地继续前进就行。"
                    }
                },
                // Precept 51
                {
                    en: {
                        title: "Precept Fifty-One: 'Nothing is Harmless.'",
                        content: "Given the chance, everything in this world will hurt you. Friends, foes, monsters, uneven paths. Be suspicious of them all."
                    },
                    zh: {
                        title: "戒律五十一: 谨记没有什么是无害的",
                        content: "如果有机会，这世界上的一切都会伤害到你，比如朋友、敌人、怪物和不平坦的道路等。所以，你要时刻怀有质疑精神。"
                    }
                },
                // Precept 52
                {
                    en: {
                        title: "Precept Fifty-Two: 'Beware the Jealousy of Fathers.'",
                        content: "Fathers believe that because they created us we must serve them and never exceed their capabilities. If you wish to forge your own path, you must vanquish your father. Or simply abandon him."
                    },
                    zh: {
                        title: "戒律五十二: 谨防父亲的嫉妒",
                        content: "父亲们总是认为，正是由于他们创造了我们，所以我们必须为他们服务，并且决不能有超越他们的地方。如果你想开辟一条属于你自己的道路，就必须先战胜你的父亲，或者干脆离开他。"
                    }
                },
                // Precept 53
                {
                    en: {
                        title: "Precept Fifty-Three: 'Do Not Steal the Desires of Others.'",
                        content: "Every creature keeps their desires locked up inside of themselves. If you catch a glimpse of another's desires, resist the urge to claim them as your own. It will not lead you to happiness."
                    },
                    zh: {
                        title: "戒律五十三: 不要横刀夺爱",
                        content: "不管是谁，都会将自己的挚爱之物埋藏在内心深处。如果你不小心瞥见了它们，就要学会克制住想占为己有的冲动。因为横刀夺爱是不会给你带来任何幸福的。"
                    }
                },
                // Precept 54
                {
                    en: {
                        title: "Precept Fifty-Four: 'If You Lock Something Away, Keep the Key.'",
                        content: "Nothing should be locked away for ever, so hold onto your keys. You will eventually return and unlock everything you hid away."
                    },
                    zh: {
                        title: "戒律五十四: 如果你锁了什么东西，那么请把钥匙保管好",
                        content: "没有什么东西可以永远被锁起来，所以请保管好你的钥匙。因为，总有一天，你会回来取走你锁起来的东西的。"
                    }
                },
                // Precept 55
                {
                    en: {
                        title: "Precept Fifty-Five: 'Bow to No-one.'",
                        content: "There are those in this world who would impose their will on others. They claim ownership over your food, your land, your body, and even your thoughts! They have done nothing to earn these things. Never bow to them, and make sure to disobey their commands."
                    },
                    zh: {
                        title: "戒律五十五: 不要向任何人摧眉折腰",
                        content: "世界上总是有人会把自己的意志强加给别人。他们只会巧取豪夺，却还总无耻地声称你的食物、土地和身体，甚至你的思想都属于他们！所以，请记住：永远不要向他们屈服，更不要任他们摆布。"
                    }
                },
                // Precept 56
                {
                    en: {
                        title: "Precept Fifty-Six: 'Do Not Dream.'",
                        content: "Dreams are dangerous things. Strange ideas, not your own, can worm their way into your mind. But if you resist those ideas, sickness will wrack your body! Best not to dream at all, like me."
                    },
                    zh: {
                        title: "戒律五十六: 永远不要做梦",
                        content: "梦其实是一个很危险的东西，其本质是非你所有的奇怪的想法，并且还会潜入你的大脑。可是，如果你想单方面排斥它的话，又会惹来一身的病！所以，最好就像我一样不要做梦。"
                    }
                },
                // Precept 57
                {
                    en: {
                        title: "Precept Fifty-Seven: 'Obey All Precepts.'",
                        content: "Most importantly, you must commit all of these Precepts to memory and obey them all unfailingly. Including this one!"
                    },
                    zh: {
                        title: "戒律五十七: 请遵守我说的所有戒律",
                        content: "最重要的是要把所有戒律都牢记在心，并且一丝不苟地遵守它们。包括这一条！"
                    }
                }
            ];
            let cyberpunkAudio = null;
        let isAudioPlaying = false;
        let currentAudioIndex = 0;
        
        // Audio playlist - starts empty, populated by easter eggs
        let audioPlaylist = [];
        
        // Play mode control variables
        let playMode = 'stop'; // 'stop', 'repeat-one', 'repeat-all'
        const playModes = {
            'stop': { icon: 'M6 6h12v12H6z', title: '播放完暂停' },
            'repeat-one': { icon: 'M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z M12 10v4l3-2-3-2z', title: '单曲循环' },
            'repeat-all': { icon: 'M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z', title: '列表循环' }
        };

            // HIMYM Quotes System
            const himymQuotes = {
                english: [
                    {
                        text: "The future is scary but you can't just run back to the past because it's familiar.",
                        author: "Robin"
                    },
                    {
                        text: "Because sometimes even if you know how something's gonna end that doesn't mean you can't enjoy the ride.",
                        author: "Ted"
                    },
                    {
                        text: "That's life, you know, we never end up where you thought you wanted to be.",
                        author: "Marshall"
                    },
                    {
                        text: "We're going to get older whether we like it or not, so the only question is whether we get on with our lives, or desperately cling to the past.",
                        author: "Ted"
                    },
                    {
                        text: "Look, you can't design your life like a building. It doesn't work that way. You just have to live it… and it'll design itself.",
                        author: "Lily"
                    },
                    {
                        text: "I realized that I'm searching, searching for what I really want in life. And you know what? I have absolutely no idea what that is.",
                        author: "Barney"
                    },
                    {
                        text: "So really the biggest mistake would be not to make that mistake, because then you'll go your whole life not knowing if something was a mistake or not.",
                        author: "Lily"
                    },
                    {
                        text: "You can't cling to the past, because no matter how tightly you hold on, it's already gone.",
                        author: "Ted"
                    },
                    {
                        text: "My search for truth is finished at last. I'm going home.",
                        author: "Zima Blue"
                    }
                ],
                chinese: [
                    {
                        text: "未来虽然可怕，但你不能因为过去很熟悉很诱人而转身跑回去。",
                        author: "Robin"
                    },
                    {
                        text: "因为有时候，即使你知道事情的结果也不代表你不能享受这个过程。",
                        author: "Ted"
                    },
                    {
                        text: "这就是人生，永远不会尽如人意。",
                        author: "Marshall"
                    },
                    {
                        text: "不管我们喜欢与否，我们都将变老。所以唯一的问题是我们选择继续生活下去还是可怜兮兮的守着过去。",
                        author: "Ted"
                    },
                    {
                        text: "你不能想设计建筑那样去规划自己的人生。生活不需要草图，你只需融入其中，上天自有安排。",
                        author: "Lily"
                    },
                    {
                        text: "我意识到我在寻找，寻找我生活中真正想要的东西。但是我完全不知道自己想要什么。",
                        author: "Barney"
                    },
                    {
                        text: "人生中最大的错误就是不去犯错。因为如果你不去犯错，你一辈子都不会知道它到底是不是一个错误。",
                        author: "Lily"
                    },
                    {
                        text: "你不能对过去念念不忘，因为无论你把回忆抓得多紧，它早已消失。",
                        author: "Ted"
                    },
                    {
                        text: "我对真理的探寻终于结束了。我要回家了。",
                        author: "Zima Blue"
                    }
                ]
            };

            let currentQuoteIndex = 8; // Start with Zima Blue quote
            let touchStartX = 0;
            let touchEndX = 0;



            // Function to update quote section content
            function updateQuoteSection() {
                // Select the correct quote section based on current language
                const quoteSection = isEnglish 
                    ? document.querySelector('#englishContent .quote-section')
                    : document.querySelector('#chineseContent .quote-section');
                    
                if (!quoteSection) return;

                const quoteText = quoteSection.querySelector('.quote-text');
                
                if (!quoteText) return;

                const currentQuotes = isEnglish ? himymQuotes.english : himymQuotes.chinese;
                const quote = currentQuotes[currentQuoteIndex];
                
                // Add fade out effect
                quoteSection.style.opacity = '0.3';
                quoteSection.style.transform = 'translateY(10px)';
                
                setTimeout(() => {
                    quoteText.innerHTML = `"${quote.text}" <span class="quote-author">— ${quote.author}</span>`;
                    
                    // Adapt font size based on content length
                    adaptQuoteFontSize();
                    
                    // Fade back in
                    quoteSection.style.opacity = '1';
                    quoteSection.style.transform = 'translateY(0)';
                }, 200);
            }

            // Function to go to next quote
            function nextQuote() {
                const currentQuotes = isEnglish ? himymQuotes.english : himymQuotes.chinese;
                currentQuoteIndex = (currentQuoteIndex + 1) % currentQuotes.length;
                updateQuoteSection();
            }

            // Function to go to previous quote
            function previousQuote() {
                const currentQuotes = isEnglish ? himymQuotes.english : himymQuotes.chinese;
                currentQuoteIndex = (currentQuoteIndex - 1 + currentQuotes.length) % currentQuotes.length;
                updateQuoteSection();
            }

            // Function to handle touch events
            function handleTouchStart(e) {
                touchStartX = e.touches[0].clientX;
            }

            function handleTouchEnd(e) {
                touchEndX = e.changedTouches[0].clientX;
                handleSwipe();
            }

            function handleSwipe() {
                const swipeThreshold = 50; // Minimum distance for a swipe
                const swipeDistance = touchEndX - touchStartX;
                
                if (Math.abs(swipeDistance) > swipeThreshold) {
                    if (swipeDistance > 0) {
                        // Swipe right - previous quote
                        previousQuote();
                    } else {
                        // Swipe left - next quote
                        nextQuote();
                    }
                }
            }

            // Function to change quote in a card
            function changeQuote(cardIndex) {
                const activeQuotes = isEnglish
                    ? quotes.english
                    : quotes.chinese;
                let newQuoteIndex;
                do {
                    newQuoteIndex = Math.floor(
                        Math.random() * activeQuotes.length,
                    );
                } while (newQuoteIndex === currentQuotes[cardIndex]);

                currentQuotes[cardIndex] = newQuoteIndex;
                const quote = activeQuotes[newQuoteIndex];

                // Update the current language version
                const currentCards = document.querySelectorAll(
                    isEnglish
                        ? "#englishContent .essence-card"
                        : "#chineseContent .essence-card",
                );

                if (currentCards[cardIndex]) {
                    const titleEl =
                        currentCards[cardIndex].querySelector(".essence-title");
                    const descEl =
                        currentCards[cardIndex].querySelector(".essence-desc");

                    if (isEnglish) {
                        titleEl.textContent = quote.en;
                        descEl.textContent = quote.source;
                    } else {
                        titleEl.textContent = quote.zh;
                        descEl.textContent = quote.source;
                    }
                }

                // Re-adapt font sizes after quote change
                setTimeout(() => {
                    adaptFontSizeResponsive();
                }, 50);

                // Check for Cyberpunk 2077 Easter Egg
                setTimeout(() => {
                    checkCyberpunkEasterEgg();
                }, 100);
                
                // Check for Zote Easter Egg
                setTimeout(() => {
                    checkZoteEasterEgg();
                }, 150);

                // Check for Rose Quote Easter Egg (Phase 2)
                setTimeout(() => {
                    checkRoseQuoteEasterEgg();
                }, 100);
            }

            // Function removed - no longer copying quote text

            // Function removed - no longer making text clickable for copying

            // Zima Blue squares system
            let zimaSquares = [];
            let zimaTimer = null;

            function createZimaSquare() {
                // Don't create squares if cyberpunk easter egg is active
                if (cyberpunkEasterEggTriggered) {
                    return;
                }

                const square = document.createElement("div");

                // Random size variation
                const sizeRandom = Math.random();
                let sizeClass = "zima-square";
                let squareSize = 12;

                if (sizeRandom < 0.4) {
                    sizeClass += " zima-square-small";
                    squareSize = 8;
                } else if (sizeRandom < 0.8) {
                    // Default size
                    squareSize = 12;
                } else if (sizeRandom < 0.95) {
                    sizeClass += " zima-square-large";
                    squareSize = 16;
                } else {
                    sizeClass += " zima-square-xl";
                    squareSize = 20;
                }

                square.className = sizeClass;

                // Random position on screen, accounting for square size
                const x = Math.random() * (window.innerWidth - squareSize);
                const y = Math.random() * (window.innerHeight - squareSize);

                square.style.left = x + "px";
                square.style.top = y + "px";

                // Fixed Zima Blue color: RGB(91, 194, 231) = #5BC2E7
                square.style.background = "#5BC2E7";

                // Add click event listener
                square.addEventListener('click', function(e) {
                    e.stopPropagation();
                    handleZimaSquareClick(square);
                });

                document.body.appendChild(square);
                zimaSquares.push(square);

                // Schedule next square (only if cyberpunk easter egg is not active)
                if (!cyberpunkEasterEggTriggered) {
                    scheduleNextZimaSquare();
                }
            }

            function scheduleNextZimaSquare() {
                // Don't schedule if cyberpunk easter egg is active
                if (cyberpunkEasterEggTriggered) {
                    return;
                }

                // Gradually decrease interval as more squares appear
                const baseInterval = Math.max(
                    2000,
                    8000 - zimaSquares.length * 50,
                );
                const randomVariation = Math.random() * baseInterval * 0.5;
                const interval = baseInterval + randomVariation;

                zimaTimer = setTimeout(createZimaSquare, interval);
            }

            function startZimaBlueSystem() {
                // Don't start if cyberpunk easter egg is active
                if (cyberpunkEasterEggTriggered) {
                    return;
                }

                // Start the first square after a random delay
                const initialDelay = Math.random() * 10000 + 5000; // 5-15 seconds
                zimaTimer = setTimeout(createZimaSquare, initialDelay);
            }

            function stopZimaBlueSystem() {
                // Clear the timer to stop generating new squares
                if (zimaTimer) {
                    clearTimeout(zimaTimer);
                    zimaTimer = null;
                }

                // Keep existing squares - don't remove them
                // zimaSquares array is preserved to maintain references
            }

            // Rose Quote Easter Egg variables (Phase 2)
            let roseQuoteEasterEggTriggered = false;
            let zimaSquareClickable = false;
            let roseAudio = null;
            let isRoseAudioPlaying = false;
            let isListeningForSinger = false;

            // Rose Quote Easter Egg function
            function checkRoseQuoteEasterEgg() {
                if (roseQuoteEasterEggTriggered) {
                    return;
                }

                const currentCards = document.querySelectorAll(
                    isEnglish
                        ? "#englishContent .essence-card"
                        : "#chineseContent .essence-card",
                );

                let roseQuoteCount = 0;
                const targetText = isEnglish 
                    ? "It is the time you have wasted for your rose that makes your rose so important"
                    : "正是你为你的玫瑰花费的时光使你的玫瑰变得如此重要";

                currentCards.forEach(card => {
                    const titleEl = card.querySelector(".essence-title");
                    if (titleEl && titleEl.textContent.trim() === targetText) {
                        roseQuoteCount++;
                    }
                });

                if (roseQuoteCount === 3) {
                    console.log("🌹 Rose Quote Easter Egg triggered!");
                    roseQuoteEasterEggTriggered = true;
                    zimaSquareClickable = true;
                    
                    // Enable zima square clicking
                    enableZimaSquareClicking();
                    
                    // Start rose audio and show heart
                    startRoseEasterEgg();
                }
            }

            // Handle zima square click
            function handleZimaSquareClick(square) {
                if (!square || !square.parentNode) return;
                
                if (roseQuoteEasterEggTriggered) {
                    // Rose easter egg is active - play sequence note and square disappears after feebea flash
                    square.classList.add('feebea-flash');
                    
                    // Play the next note in the sequence
                    playSequenceNote();
                    
                    setTimeout(() => {
                        removeZimaSquare(square);
                    }, 900); // Extended feebea time (3x original)
                } else {
                    // Normal behavior - extended feebea flash, then brief red with piano sound, then back to zima blue
                    square.classList.add('feebea-flash');
                    
                    setTimeout(() => {
                        square.classList.remove('feebea-flash');
                        square.classList.add('warning-flash');
                        
                        // Play default piano note when red appears
                        playDefaultPianoNote();
                        
                        setTimeout(() => {
                            square.classList.remove('warning-flash');
                            // Square returns to original zima blue color
                        }, 200); // Brief red flash
                    }, 900); // Extended feebea time (3x original)
                }
            }

            // Global audio context for better performance
            let globalAudioContext = null;
            
            // Initialize audio context
            function initAudioContext() {
                if (!globalAudioContext) {
                    try {
                        globalAudioContext = new (window.AudioContext || window.webkitAudioContext)();
                    } catch (error) {
                        console.log('Audio context initialization failed:', error);
                        return null;
                    }
                }
                
                // Resume context if suspended (autoplay policy)
                if (globalAudioContext.state === 'suspended') {
                    globalAudioContext.resume();
                }
                
                return globalAudioContext;
            }
            
            // Piano note frequencies (Hz)
            const pianoNotes = {
                'E': 1318.51,
                'e': 659.26,
                'D': 1244.51,
                'd': 622.25,
                'C': 1108.73,
                'c': 554.37,
                'A': 880,
                'G': 830.61
            };
            
            // Rose easter egg piano sequence
            const roseSequence = ['E', 'E', 'E', 'e', 'D', 'D', 'D', 'd', 'C', 'C', 'C', 'c', 'A', 'A', 'G', 'E'];
            let sequenceIndex = 0;
            let successfulClicks = 0;
            
            // Play piano note with ADSR envelope
            function playPianoNote(frequency, duration = 1.2) {
                const audioContext = initAudioContext();
                if (!audioContext) return;
                
                try {
                    // Create oscillator and gain node
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    
                    // Connect audio nodes
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    
                    // Set frequency and waveform (triangle for piano-like sound)
                    oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
                    oscillator.type = 'triangle';
                    
                    // ADSR envelope for piano-like sound
                    const now = audioContext.currentTime;
                    const attackTime = 0.1;  // Quick attack
                    const decayTime = 0.3;   // Moderate decay
                    const sustainLevel = 0.3; // Lower sustain
                    const releaseTime = 0.8;  // Longer release
                    
                    // Attack phase
                    gainNode.gain.setValueAtTime(0, now);
                    gainNode.gain.linearRampToValueAtTime(0.8, now + attackTime);
                    
                    // Decay phase
                    gainNode.gain.linearRampToValueAtTime(sustainLevel, now + attackTime + decayTime);
                    
                    // Sustain phase (maintain level)
                    const sustainDuration = duration - attackTime - decayTime - releaseTime;
                    if (sustainDuration > 0) {
                        gainNode.gain.setValueAtTime(sustainLevel, now + attackTime + decayTime + sustainDuration);
                    }
                    
                    // Release phase
                    const releaseStart = now + duration - releaseTime;
                    gainNode.gain.exponentialRampToValueAtTime(0.001, releaseStart + releaseTime);
                    
                    // Start and stop oscillator
                    oscillator.start(now);
                    oscillator.stop(now + duration);
                    
                } catch (error) {
                    console.log('Piano sound failed:', error);
                }
            }
            
            // Play default piano note (E = 1318.51 Hz)
            function playDefaultPianoNote() {
                playPianoNote(pianoNotes.E, 1.2);
            }
            
            // Play sequence note for rose easter egg
            function playSequenceNote() {
                if (sequenceIndex < roseSequence.length) {
                    const note = roseSequence[sequenceIndex];
                    const frequency = pianoNotes[note];
                    playPianoNote(frequency, 1.2);
                    sequenceIndex++;
                    successfulClicks++;
                    
                    // Check if sequence is complete
                    if (successfulClicks === 16) {
                        // Add runaway1.mp3 to playlist after completing the sequence
                        setTimeout(() => {
                            try {
                                const runawayAudioData = {
                                    name: "Runaway",
                                    src: "./phoebe/runaway1.mp3",
                                    type: "Piano Sequence Reward"
                                };
                                addAudioToPlaylist(runawayAudioData);
                                runawayEasterEggTriggered = true;
                                
                                // Change content when runaway easter egg is triggered via piano sequence
                                changeToRunawayContent();
                                
                                console.log("🎹 Piano sequence completed! Added Runaway to playlist");
                                console.log("🎹 Runaway easter egg triggered!");
                            } catch (error) {
                                console.log('Failed to add runaway1.mp3 to playlist:', error);
                            }
                        }, 1200); // Wait for last note to finish
                    }
                } else {
                    // Reset sequence if needed
                    sequenceIndex = 0;
                    successfulClicks = 0;
                }
            }

            // Enable zima square clicking (legacy function for rose easter egg)
            function enableZimaSquareClicking() {
                // This function is now redundant since all squares are clickable by default
                // Keeping it for compatibility with existing rose easter egg code
            }

            // Remove individual zima square
            function removeZimaSquare(square) {
                if (square && square.parentNode) {
                    square.parentNode.removeChild(square);
                    const index = zimaSquares.indexOf(square);
                    if (index > -1) {
                        zimaSquares.splice(index, 1);
                    }
                    
                    // Check if all squares are removed
                    if (zimaSquares.length === 0) {
                        triggerFinalEasterEgg();
                    }
                }
            }

            // Start rose easter egg
            function startRoseEasterEgg() {
                // Create and show heart overlay
                showHeartOverlay();
                
                // Start playing Zelda audio
                startRoseAudio();
            }

            // Show zelda overlay with preloading and 20-second duration
            function showHeartOverlay() {
                // Create loading overlay first
                const loadingOverlay = document.createElement('div');
                loadingOverlay.className = 'cyberpunk-easter-egg zelda-easter-egg';
                loadingOverlay.innerHTML = `
                     <div class="cyberpunk-content zelda-content">
                         <div class="cyberpunk-text zelda-text zelda-loading">Loading...</div>
                     </div>
                 `;
                document.body.appendChild(loadingOverlay);
                loadingOverlay.classList.add('show');
                
                // Preload GIF and audio
                const gifImg = new Image();
                let gifLoaded = false;
                let audioReady = false;
                
                // Preload GIF
                gifImg.onload = () => {
                    gifLoaded = true;
                    checkReadyToShow();
                };
                gifImg.src = './phoebe/zelda.gif';
                
                // Initialize audio system and prepare audio
                if (!cyberpunkAudio) {
                    initializeAudioSystem();
                }
                
                // Prepare audio (mark as ready immediately since we're using remote URL)
                audioReady = true;
                checkReadyToShow();
                
                function checkReadyToShow() {
                    if (gifLoaded && audioReady) {
                        // Remove loading overlay
                        loadingOverlay.classList.remove('show');
                        setTimeout(() => {
                            if (loadingOverlay.parentNode) {
                                loadingOverlay.parentNode.removeChild(loadingOverlay);
                            }
                        }, 500);
                        
                        // Create main overlay
                        const overlay = document.createElement('div');
                        overlay.className = 'cyberpunk-easter-egg zelda-easter-egg';
                        overlay.innerHTML = `
                            <div class="cyberpunk-content zelda-content">
                                <div class="cyberpunk-text zelda-text">The LEGEND OF ZELDA</div>
                                <img src="./phoebe/zelda.gif" alt="The Legend of Zelda" class="cyberpunk-image zelda-image" />
                            </div>
                            <div class="close-easter-egg" onclick="closeZeldaOverlay(this.parentElement)" ontouchend="event.preventDefault(); closeZeldaOverlay(this.parentElement);">×</div>
                        `;
                        
                        document.body.appendChild(overlay);
                        
                        // Add double-click/tap listener to close (support both mouse and touch)
                        let zeldaClickCount = 0;
                        let zeldaClickTimer = null;
                        
                        const handleZeldaDoubleClick = function(e) {
                            e.preventDefault();
                            zeldaClickCount++;
                            if (zeldaClickCount === 1) {
                                zeldaClickTimer = setTimeout(() => {
                                    zeldaClickCount = 0;
                                }, 300); // Reset after 300ms
                            } else if (zeldaClickCount === 2) {
                                clearTimeout(zeldaClickTimer);
                                zeldaClickCount = 0;
                                closeZeldaOverlay(overlay);
                            }
                        };
                        
                        // Add both click and touchend events for cross-platform support
                        overlay.addEventListener('click', handleZeldaDoubleClick);
                        overlay.addEventListener('touchend', handleZeldaDoubleClick);
                        
                        // Show overlay first
                        setTimeout(() => {
                            overlay.classList.add('show');
                            
                            // Wait for GIF to fully load and start playing before starting audio
                            const gifElement = overlay.querySelector('.zelda-image');
                            if (gifElement) {
                                // Add a small delay to ensure GIF starts playing
                                setTimeout(() => {
                                    console.log('🎮 Zelda GIF loaded and displayed, starting audio...');
                                    startRoseAudio();
                                }, 500); // 500ms delay to ensure GIF is playing
                            } else {
                                // Fallback if GIF element not found
                                startRoseAudio();
                            }
                        }, 100);
                        
                        // Auto-hide overlay after 20 seconds
                        setTimeout(() => {
                            closeZeldaOverlay(overlay);
                        }, 20000);
                        
                        // Store overlay reference for manual closing
                         window.currentZeldaOverlay = overlay;
                         
                         // Add keyboard listener for ESC key
                         window.zeldaEscapeHandler = (e) => {
                             if (e.key === 'Escape' && window.currentZeldaOverlay) {
                                 closeZeldaOverlay(window.currentZeldaOverlay);
                             }
                         };
                         document.addEventListener('keydown', window.zeldaEscapeHandler);
                    }
                }
            }
            
            // Function to close Zelda overlay
             function closeZeldaOverlay(overlay) {
                 if (overlay && overlay.classList.contains('show')) {
                     overlay.classList.remove('show');
                     setTimeout(() => {
                         if (overlay.parentNode) {
                             overlay.parentNode.removeChild(overlay);
                         }
                     }, 500);
                     
                     // Clear reference and remove event listeners
                     if (window.currentZeldaOverlay === overlay) {
                         window.currentZeldaOverlay = null;
                         // Remove any existing escape key listeners
                         document.removeEventListener('keydown', window.zeldaEscapeHandler);
                     }
                 }
             }

            // Start rose audio
            function startRoseAudio() {
                // Initialize audio system if not already done
                if (!cyberpunkAudio) {
                    initializeAudioSystem();
                }
                
                // Add Zelda audio to playlist and auto-play
                const zeldaAudioData = {
                    name: "塞尔达传说 - 开场",
                    src: "https://kappa.vgmsite.com/soundtracks/the-legend-of-zelda-breath-of-the-wild/rauxgqyims/1-04.%20Opening.mp3",
                    type: "remote"
                };
                addAudioToPlaylist(zeldaAudioData);
                zeldaEasterEggTriggered = true;
                
                console.log("🌹 Rose Easter Egg: Added Zelda music to playlist");
                console.log("🎵 Zelda easter egg triggered!");
                isRoseAudioPlaying = true;
            }

            // Final easter egg when all zima squares are removed
            function triggerFinalEasterEgg() {
                console.log("🎉 All zima squares removed! Final easter egg triggered!");
                isListeningForSinger = true;
                
                // Show notification
                const message = isEnglish ? "Who's singing?" : "谁在唱歌？";
                showEasterEggNotification(message + " (Click to activate input)");
                
                // Add click listener to activate input
                document.addEventListener('click', activateSingerInput, { once: true });
            }

            // Activate singer input
            function activateSingerInput() {
                const input = prompt(isEnglish ? "Who's singing?" : "谁在唱歌？");
                if (input) {
                    const lowerInput = input.toLowerCase().trim();
                    if (lowerInput === 'xiaop') {
                        // Play tearsicantholdback.mp3
                        playAudio('tearsicantholdback.mp3');
                        showEasterEggNotification(isEnglish ? "Playing tears I can't hold back..." : "播放眼泪止不住...");
                    } else if (lowerInput === 'me') {
                        // Add whenyou.mp3 to playlist
                        const whenyouAudioData = {
                            name: "When You",
                            src: "./phoebe/whenyou.mp3",
                            type: "Singer Response"
                        };
                        addAudioToPlaylist(whenyouAudioData);
                        showEasterEggNotification(isEnglish ? "Playing when you..." : "播放当你...");
                    } else if (lowerInput === 'you') {
                        // Keep original behavior - trigger smelly cat + friends
                        showSmellyCatContent();
                    } else if (lowerInput === 'peng') {
                        // Add badmood.mp3 to playlist
                        const badmoodAudioData = {
                            name: "Bad Mood",
                            src: "./phoebe/badmood.mp3",
                            type: "Singer Response"
                        };
                        addAudioToPlaylist(badmoodAudioData);
                        showEasterEggNotification(isEnglish ? "Playing bad mood..." : "播放坏心情...");
                    } else {
                        showEasterEggNotification(isEnglish ? "Wrong answer!" : "答案错误！");
                    }
                }
                isListeningForSinger = false;
            }

            // Cyberpunk 2077 Easter Egg functions
            function checkCyberpunkEasterEgg() {
                if (cyberpunkEasterEggTriggered) {
                    return;
                }

                const currentCards = document.querySelectorAll(
                    isEnglish
                        ? "#englishContent .essence-card"
                        : "#chineseContent .essence-card",
                );

                const targetTextEn = "You're a natural-born Edgerunner.";
                const targetTextZh = "你是个天生的边缘行者";
                const targetText = isEnglish ? targetTextEn : targetTextZh;

                let matchCount = 0;
                currentCards.forEach(card => {
                    const titleEl = card.querySelector(".essence-title");
                    if (titleEl && titleEl.textContent.trim() === targetText) {
                        matchCount++;
                    }
                });

                if (matchCount === 3) {
                    console.log("🌃 Cyberpunk 2077 Easter Egg triggered!");
                    triggerCyberpunkEasterEgg();
                }
            }

            // Check for Zote Easter Egg
            function checkZoteEasterEgg() {
                if (zoteEasterEggTriggered) {
                    return;
                }

                const currentCards = document.querySelectorAll(
                    isEnglish
                        ? "#englishContent .essence-card"
                        : "#chineseContent .essence-card",
                );

                const targetTextEn = "Precept Fifty-Six: 'Do Not Dream.' Dreams are dangerous things. Strange ideas come from dreams, and strange ideas lead to dangerous actions. You are meant to be like me: not to dream. -Zote";
                const targetTextZh = "戒律五十六: 不要做梦。梦想是危险的东西。奇怪的想法源自梦想，而奇怪的想法会导致危险的行为。你应该像我一样，不要做梦。-左特";
                const targetText = isEnglish ? targetTextEn : targetTextZh;

                let matchCount = 0;
                currentCards.forEach(card => {
                    const titleEl = card.querySelector(".essence-title");
                    if (titleEl && titleEl.textContent.trim() === targetText) {
                        matchCount++;
                    }
                });

                if (matchCount === 3) {
                    console.log("⚔️ Zote Easter Egg triggered!");
                    triggerZoteEasterEgg();
                }
            }

            function triggerCyberpunkEasterEgg() {
                if (cyberpunkEasterEggTriggered) {
                    return;
                }

                cyberpunkEasterEggTriggered = true;

                // Stop Zima Blue system
                stopZimaBlueSystem();

                // Add cyberpunk mode to body
                document.body.classList.add('cyberpunk-mode');

                // Show easter egg overlay
                const easterEgg = document.getElementById('cyberpunkEasterEgg');
                const audioBtn = document.getElementById('audioControlBtn');

                if (easterEgg) {
                    easterEgg.classList.add('show');

                    // Add double-click/tap listener to close (support both mouse and touch)
                    let clickCount = 0;
                    let clickTimer = null;
                    
                    const handleCyberpunkDoubleClick = function(e) {
                        e.preventDefault();
                        clickCount++;
                        if (clickCount === 1) {
                            clickTimer = setTimeout(() => {
                                clickCount = 0;
                            }, 300); // Reset after 300ms
                        } else if (clickCount === 2) {
                            clearTimeout(clickTimer);
                            clickCount = 0;
                            closeCyberpunkEasterEgg();
                        }
                    };
                    
                    setTimeout(() => {
                        // Add both click and touchend events for cross-platform support
                        easterEgg.addEventListener('click', handleCyberpunkDoubleClick);
                        easterEgg.addEventListener('touchend', handleCyberpunkDoubleClick);
                    }, 500);
                }

                // Show and then hide controls during fullscreen display
                const audioPanel = document.getElementById('audioControlPanel');
                const closeBtn = document.getElementById('closeEasterEgg');

                if (audioPanel) {
                    audioPanel.classList.add('hidden-during-fullscreen'); // Hide it during fullscreen
                }

                if (closeBtn) {
                    closeBtn.classList.add('show'); // Make sure it's marked as should be shown
                    closeBtn.classList.add('hidden-during-fullscreen');
                }

                // Initialize button state first
                updateAudioButton();

                // Initialize audio system if not already done
                if (!cyberpunkAudio) {
                    initializeAudioSystem();
                }
                
                // Add Cyberpunk 2077 audio to playlist and auto-play
                const cyberpunkAudioData = {
                    name: "Cyberpunk 2077",
                    src: "https://eta.vgmtreasurechest.com/soundtracks/cyberpunk-2077-radio-vol.-2-original-soundtrack/liojiacuhf/05.%20I%20Really%20Want%20to%20Stay%20at%20Your%20House.mp3",
                    type: "remote"
                };
                addAudioToPlaylist(cyberpunkAudioData);

                // Show controls after a delay (after fullscreen display)
                setTimeout(() => {
                    if (audioPanel) {
                        audioPanel.classList.remove('hidden-during-fullscreen');
                        // Audio panel visibility is now managed by updateAudioPanelVisibility
                    }
                    if (closeBtn) {
                        closeBtn.classList.remove('hidden-during-fullscreen');
                        // Ensure close button stays visible permanently after first trigger
                        closeBtn.classList.add('show');
                    }
                }, 4000); // Show controls after 4 seconds
            }

            function initializeAudioSystem() {
                cyberpunkAudio = document.getElementById('cyberpunkAudio');
                
                if (cyberpunkAudio) {
                    cyberpunkAudio.volume = 0.3;
                    isAudioPlaying = false;
                    updateAudioButton();
                    
                    // Add event listener for auto-playing next track
                    cyberpunkAudio.addEventListener('ended', () => {
                        console.log('🎵 Current track ended, playing next...');
                        playNextTrack();
                    });
                    
                    // Initialize empty playlist UI
                    initializePlaylist();
                }
            }
            
            function addAudioToPlaylist(audioData) {
                // Ensure cyberpunkAudio element is initialized
                if (!cyberpunkAudio) {
                    cyberpunkAudio = document.getElementById('cyberpunkAudio');
                    if (!cyberpunkAudio) {
                        console.error('❌ cyberpunkAudio element not found!');
                        return;
                    }
                }
                
                // Check if audio already exists in playlist to avoid duplicates
                const existingAudio = audioPlaylist.find(audio => 
                    audio.src === audioData.src || audio.name === audioData.name
                );
                
                if (existingAudio) {
                    console.log(`🔄 Audio "${audioData.name}" already in playlist, switching to it instead`);
                    // Find the index and switch to it
                    const existingIndex = audioPlaylist.findIndex(audio => 
                        audio.src === audioData.src || audio.name === audioData.name
                    );
                    loadAudio(existingIndex, true); // Auto-play existing audio
                    return;
                }
                
                audioPlaylist.push(audioData);
                initializePlaylist();
                
                // Switch to the newly added audio and play it
                const newIndex = audioPlaylist.length - 1;
                loadAudio(newIndex, true); // Auto-play new audio
            }
            
            function loadAudio(index, autoPlay = false) {
                // Ensure cyberpunkAudio element is initialized
                if (!cyberpunkAudio) {
                    cyberpunkAudio = document.getElementById('cyberpunkAudio');
                    if (!cyberpunkAudio) {
                        console.error('❌ cyberpunkAudio element not found in loadAudio!');
                        return;
                    }
                }
                
                if (index >= 0 && index < audioPlaylist.length) {
                    const audioData = audioPlaylist[index];
                    currentAudioIndex = index;
                    
                    // Update playlist UI immediately
                    updatePlaylistUI();
                    
                    // Lazy loading: only load audio when needed
                    if (autoPlay) {
                        loadAndPlayAudio(audioData);
                    } else {
                        // Just update the current index, don't load audio yet
                        console.log(`🎵 Selected: ${audioData.name} (will load when played)`);
                    }
                }
            }
            
            function loadAndPlayAudio(audioData) {
                const source = cyberpunkAudio.querySelector('source');
                if (source && source.src !== audioData.src) {
                    source.src = audioData.src;
                    cyberpunkAudio.load();
                    
                    // Set start time when audio can play (only for first play)
                    cyberpunkAudio.addEventListener('canplay', function setStartTime() {
                        // Only set start time if this is the first play
                        if (!audioData.hasPlayedBefore) {
                            if (audioData.name === "Cyberpunk 2077") {
                                cyberpunkAudio.currentTime = 60; // Start at 1 minute
                            } else if (audioData.name === "Runaway") {
                                cyberpunkAudio.currentTime = 38.5; // Start at 38.5 seconds
                            } else if (audioData.name === "Who Is The Best") {
                                cyberpunkAudio.currentTime = 44; // Start at 43 seconds
                            }
                            // Mark as played
                            audioData.hasPlayedBefore = true;
                        }
                        
                        // Auto play after loading
                        cyberpunkAudio.play().then(() => {
                            isAudioPlaying = true;
                            updateAudioButton();
                            console.log(`🎵 Lazy loaded and playing: ${audioData.name}`);
                        }).catch(error => {
                            console.log("❌ Auto-play failed:", error);
                        });
                        
                        cyberpunkAudio.removeEventListener('canplay', setStartTime);
                    }, { once: true });
                } else if (source && source.src === audioData.src) {
                    // Audio already loaded, just play
                    cyberpunkAudio.play().then(() => {
                        isAudioPlaying = true;
                        updateAudioButton();
                        console.log(`🎵 Playing cached: ${audioData.name}`);
                    }).catch(error => {
                        console.log("❌ Play failed:", error);
                    });
                }
            }
            
            function playNextTrack() {
                if (audioPlaylist.length === 0) {
                    console.log('📭 No tracks in playlist');
                    return;
                }
                
                console.log(`🎵 Current play mode: ${playMode}`);
                
                if (playMode === 'stop') {
                    // Stop after current track
                    console.log('⏹️ Stopping playback (stop mode)');
                    isAudioPlaying = false;
                    updateAudioButton();
                    return;
                } else if (playMode === 'repeat-one') {
                    // Repeat current track
                    console.log(`🔂 Repeating current track: ${audioPlaylist[currentAudioIndex].name}`);
                    loadAudio(currentAudioIndex, true); // Auto-play
                } else {
                    // Repeat all (default behavior)
                    const nextIndex = (currentAudioIndex + 1) % audioPlaylist.length;
                    console.log(`🔄 Playing next track: ${nextIndex + 1}/${audioPlaylist.length}`);
                    loadAudio(nextIndex, true); // Auto-play
                }
            }
            
            function initializePlaylist() {
                const playlistContainer = document.getElementById('playlistItems');
                const playlistSidebar = document.getElementById('audioPlaylistSidebar');
                if (!playlistContainer) return;
                
                playlistContainer.innerHTML = '';
                
                // Control sidebar visibility based on playlist content
                if (audioPlaylist.length === 0) {
                    // Hide sidebar when no songs
                    if (playlistSidebar) {
                        playlistSidebar.style.display = 'none';
                    }
                } else {
                    // Show sidebar when there are songs
                    if (playlistSidebar) {
                        playlistSidebar.style.display = 'block';
                    }
                }
                
                audioPlaylist.forEach((audio, index) => {
                    const item = document.createElement('div');
                    item.className = 'playlist-item';
                    item.dataset.index = index;
                    
                    item.innerHTML = `
                        <span class="playlist-item-name">${audio.name}</span>
                        <span class="playlist-item-type">${audio.type}</span>
                    `;
                    
                    const handlePlaylistItemInteraction = () => {
                        // Ensure cyberpunkAudio element is initialized
                        if (!cyberpunkAudio) {
                            cyberpunkAudio = document.getElementById('cyberpunkAudio');
                            if (!cyberpunkAudio) {
                                console.error('❌ cyberpunkAudio element not found in playlist item click!');
                                return;
                            }
                        }
                        
                        if (currentAudioIndex !== index) {
                            const wasPlaying = isAudioPlaying;
                            if (isAudioPlaying) {
                                cyberpunkAudio.pause();
                                isAudioPlaying = false;
                                updateAudioButton();
                            }
                            
                            // Load audio with auto-play if it was playing before
                            loadAudio(index, wasPlaying);
                        }
                    };
                    
                    item.addEventListener('click', handlePlaylistItemInteraction);
                    item.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        handlePlaylistItemInteraction();
                    });
                    
                    playlistContainer.appendChild(item);
                });
                
                updatePlaylistUI();
                
                // Update audio panel visibility based on playlist content
                updateAudioPanelVisibility();
            }
            
            function updatePlaylistUI() {
                const items = document.querySelectorAll('.playlist-item');
                items.forEach((item, index) => {
                    if (index === currentAudioIndex) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            }

            function updateAudioPanelVisibility() {
                const audioPanel = document.getElementById('audioControlPanel');
                if (!audioPanel) return;
                
                // Show panel only if there are songs in the playlist
                if (audioPlaylist.length > 0) {
                    audioPanel.classList.add('show');
                } else {
                    audioPanel.classList.remove('show');
                }
            }
            
            function togglePlayMode() {
                const modes = Object.keys(playModes);
                const currentIndex = modes.indexOf(playMode);
                const nextIndex = (currentIndex + 1) % modes.length;
                playMode = modes[nextIndex];
                
                console.log(`🎵 Play mode changed to: ${playMode}`);
                updatePlayModeButton();
                showNotification(`播放模式: ${playModes[playMode].title}`);
            }
            
            function updatePlayModeButton() {
                const playModeBtn = document.getElementById('playModeBtn');
                if (!playModeBtn) return;
                
                const modeData = playModes[playMode];
                playModeBtn.setAttribute('data-mode', playMode);
                playModeBtn.setAttribute('title', modeData.title);
                
                const iconElement = playModeBtn.querySelector('.mode-icon path');
                if (iconElement) {
                    iconElement.setAttribute('d', modeData.icon);
                }
            }
            
            function setupAudioControl() {
                const audioBtn = document.getElementById('audioControlBtn');
                const audioPanel = document.getElementById('audioControlPanel');
                const playModeBtn = document.getElementById('playModeBtn');

                if (audioBtn && !audioBtn.hasAttribute('data-initialized')) {
                    let longPressTimer;
                    let isLongPressing = false;
                    
                    // Mouse events for desktop
                    audioBtn.addEventListener('mousedown', (e) => {
                        if (window.innerWidth > 768) {
                            isLongPressing = false;
                            longPressTimer = setTimeout(() => {
                                isLongPressing = true;
                                showAudioControls();
                            }, 500); // 500ms for long press
                        }
                    });
                    
                    audioBtn.addEventListener('mouseup', (e) => {
                        if (window.innerWidth > 768) {
                            clearTimeout(longPressTimer);
                            if (!isLongPressing) {
                                toggleAudio();
                            }
                        }
                    });
                    
                    audioBtn.addEventListener('mouseleave', (e) => {
                        if (window.innerWidth > 768) {
                            clearTimeout(longPressTimer);
                        }
                    });
                    
                    // Touch events for mobile
                    audioBtn.addEventListener('touchstart', (e) => {
                        if (window.innerWidth <= 768) {
                            isLongPressing = false;
                            longPressTimer = setTimeout(() => {
                                isLongPressing = true;
                                showAudioControls();
                            }, 500); // 500ms for long press
                        }
                    });
                    
                    audioBtn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        clearTimeout(longPressTimer);
                        if (!isLongPressing) {
                            toggleAudio();
                        }
                    });
                    
                    // Fallback click event for compatibility
                    audioBtn.addEventListener('click', (e) => {
                        // Prevent double triggering on desktop
                        if (window.innerWidth <= 768 && !isLongPressing) {
                            e.preventDefault();
                        }
                    });
                    
                    audioBtn.setAttribute('data-initialized', 'true');
                }
                
                if (playModeBtn && !playModeBtn.hasAttribute('data-initialized')) {
                    playModeBtn.addEventListener('click', togglePlayMode);
                    playModeBtn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        togglePlayMode();
                    });
                    playModeBtn.setAttribute('data-initialized', 'true');
                    updatePlayModeButton();
                }
                
                // Setup mobile and desktop interaction for audio panel
                if (audioPanel && !audioPanel.hasAttribute('data-interaction-initialized')) {
                    let hideTimeout;
                    let touchStartX = 0;
                    let touchStartY = 0;
                    
                    // Desktop: Mouse hover detection for left side
                    const leftTriggerZone = document.createElement('div');
                    leftTriggerZone.style.cssText = `
                        position: fixed;
                        left: 0;
                        top: 35%;
                        width: 100px;
                        height: 30%;
                        z-index: 9998;
                        pointer-events: auto;
                    `;
                    document.body.appendChild(leftTriggerZone);
                    
                    leftTriggerZone.addEventListener('mouseenter', () => {
                        if (window.innerWidth > 768) {
                            audioPanel.classList.add('show');
                            clearTimeout(hideTimeout);
                        }
                    });
                    
                    leftTriggerZone.addEventListener('mouseleave', () => {
                        if (window.innerWidth > 768) {
                            hideTimeout = setTimeout(() => {
                                if (!audioPanel.matches(':hover')) {
                                    audioPanel.classList.remove('show');
                                }
                            }, 500);
                        }
                    });
                    
                    audioPanel.addEventListener('mouseenter', () => {
                        if (window.innerWidth > 768) {
                            clearTimeout(hideTimeout);
                        }
                    });
                    
                    audioPanel.addEventListener('mouseleave', () => {
                        if (window.innerWidth > 768) {
                            hideTimeout = setTimeout(() => {
                                audioPanel.classList.remove('show');
                            }, 500);
                        }
                    });
                    
                    // Mobile: Touch and swipe detection
                    leftTriggerZone.addEventListener('touchstart', (e) => {
                        if (window.innerWidth <= 768) {
                            touchStartX = e.touches[0].clientX;
                            touchStartY = e.touches[0].clientY;
                        }
                    });
                    
                    leftTriggerZone.addEventListener('touchend', (e) => {
                        if (window.innerWidth <= 768) {
                            const touchEndX = e.changedTouches[0].clientX;
                            const touchEndY = e.changedTouches[0].clientY;
                            const deltaX = touchEndX - touchStartX;
                            const deltaY = Math.abs(touchEndY - touchStartY);
                            
                            // Detect right swipe or tap
                            if (deltaX > 20 && deltaY < 60) {
                                // Right swipe
                                audioPanel.classList.add('mobile-show');
                                setTimeout(() => {
                                    audioPanel.classList.remove('mobile-show');
                                }, 4000);
                            } else if (Math.abs(deltaX) < 15 && deltaY < 15) {
                                // Tap
                                audioPanel.classList.add('mobile-show');
                                setTimeout(() => {
                                    audioPanel.classList.remove('mobile-show');
                                }, 3000);
                            }
                        }
                    });
                    
                    audioPanel.setAttribute('data-interaction-initialized', 'true');
                }
                
                // Show audio panel at startup, but control visibility based on playlist
                if (audioPanel) {
                    updateAudioPanelVisibility();
                }
            }

            function setupCloseButton() {
                const closeBtn = document.getElementById('closeEasterEgg');

                if (closeBtn && !closeBtn.hasAttribute('data-initialized')) {
                    closeBtn.addEventListener('click', closeCyberpunkEasterEgg);
                    closeBtn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        closeCyberpunkEasterEgg();
                    });
                    closeBtn.setAttribute('data-initialized', 'true');
                }
            }

            function closeCyberpunkEasterEgg() {
                console.log("🚪 Closing Cyberpunk Easter Egg");

                // Hide easter egg overlay only
                const easterEgg = document.getElementById('cyberpunkEasterEgg');
                const audioPanel = document.getElementById('audioControlPanel');
                const closeBtn = document.getElementById('closeEasterEgg');

                if (easterEgg) {
                    easterEgg.classList.remove('show');
                }

                // Just hide the fullscreen overlay, keep controls visible
                if (audioPanel && audioPanel.classList.contains('hidden-during-fullscreen')) {
                    audioPanel.classList.remove('hidden-during-fullscreen');
                }

                if (closeBtn && closeBtn.classList.contains('hidden-during-fullscreen')) {
                    closeBtn.classList.remove('hidden-during-fullscreen');
                }

                // Keep audio playing and controls visible
                // Remove cyberpunk mode from body
                document.body.classList.remove('cyberpunk-mode');

                // Don't reset easter egg state - keep it triggered so buttons stay visible
                // Don't restart Zima Blue system - keep it stopped permanently
            }
            
            // Zote Easter Egg functions
            function triggerZoteEasterEgg() {
                if (zoteEasterEggTriggered) {
                    return;
                }

                zoteEasterEggTriggered = true;
                console.log("⚔️ Zote Easter Egg activated!");
                
                // Replace Phoebe section with Zote's precepts
                replacePhoebeWithZote();
                
                // Show notification
                showNotification(isEnglish ? "Zote the Mighty has taken over! Click the precept to cycle through his wisdom." : "左特大人已经接管！点击戒律来循环浏览他的智慧。");
            }
            
            function increaseZoteCycle() {
                if (!zoteEasterEggTriggered) {
                    showNotification(isEnglish ? "Zote easter egg must be activated first!" : "必须先激活左特彩蛋！");
                    return;
                }
                
                zoteCycleCount++;
                console.log(`🔄 Zote cycle count increased to: ${zoteCycleCount}`);
                
                // Update the display with new title
                replacePhoebeWithZote();
                
                // Show notification with current cycle info
                const titles = getZoteTitle();
                showNotification(isEnglish ? 
                    `Cycle ${zoteCycleCount}: ${titles.english}` : 
                    `循环 ${zoteCycleCount}: ${titles.chinese}`);
            }
            
            function replacePhoebeWithZote() {
                // Convert precept number to array index: 56->0, 57->1, 1->2
                let arrayIndex;
                if (currentZotePrecept === 56) {
                    arrayIndex = 0;
                } else if (currentZotePrecept === 57) {
                    arrayIndex = 1;
                } else if (currentZotePrecept === 1) {
                    arrayIndex = 2;
                }
                
                const currentPrecept = zotePrecepts[arrayIndex];
                const lang = isEnglish ? 'en' : 'zh';
                
                // Replace English Phoebe section
                const englishPhoebeTitle = document.querySelector('#englishContent .phoebe-title');
                const englishPhoebeQuote = document.querySelector('#englishContent .phoebe-quote');
                
                if (englishPhoebeTitle && englishPhoebeQuote) {
                    const zoteTitle = getZoteTitle(zoteCycleCount);
                    englishPhoebeTitle.textContent = isEnglish ? `${zoteTitle.en}'s Precepts` : "左特的戒律";
                    englishPhoebeQuote.innerHTML = `"${currentPrecept.en.title}<br><br>${currentPrecept.en.content}" <br><br>- ${zoteTitle.en}`;
                    englishPhoebeQuote.style.cursor = 'pointer';
                    englishPhoebeQuote.onclick = () => cycleZotePrecept();
                }
                
                // Replace Chinese Phoebe section
                const chinesePhoebeTitle = document.querySelector('#chineseContent .phoebe-title');
                const chinesePhoebeQuote = document.querySelector('#chineseContent .phoebe-quote');
                
                if (chinesePhoebeTitle && chinesePhoebeQuote) {
                    const zoteTitle = getZoteTitle(zoteCycleCount);
                    chinesePhoebeTitle.textContent = "左特的戒律";
                    chinesePhoebeQuote.innerHTML = `"${currentPrecept.zh.title}<br><br>${currentPrecept.zh.content}" <br><br>-${zoteTitle.zh}`;
                    chinesePhoebeQuote.style.cursor = 'pointer';
                    chinesePhoebeQuote.onclick = () => cycleZotePrecept();
                }
            }
            
            function cycleZotePrecept() {
                // Cycle through precepts: 1 -> 2 -> ... -> 57 -> 1...
                currentZotePrecept++;
                if (currentZotePrecept > 57) {
                    currentZotePrecept = 1;
                    zoteCycleCount++; // Increment cycle count when completing all 57 precepts
                }
                
                // Update the display
                replacePhoebeWithZote();
                
                console.log(`⚔️ Switched to Precept ${currentZotePrecept}, Cycle: ${zoteCycleCount}`);
            }
            
            function getZoteTitle(cycleCount) {
                // Return appropriate title based on cycle count
                // After 9th cycle, always use 9th cycle title
                const effectiveCycle = Math.min(cycleCount, 9);
                
                // Adjectives to add at each cycle
                const chineseAdjectives = [
                    "", // cycle 0: no adjectives
                    "可怕的，漂亮的，强大的灰色王子", // cycle 1
                    "华丽的，激情的", // cycle 2
                    "勤勉的，强势的", // cycle 3
                    "神气的", // cycle 4
                    "迷人的", // cycle 5
                    "神秘的", // cycle 6
                    "性感的", // cycle 7
                    "勇猛的", // cycle 8
                    "无敌的" // cycle 9
                ];
                
                const englishAdjectives = [
                    "", // cycle 0: no adjectives
                    "Terrifying, Beautiful, Powerful, Grey Prince", // cycle 1
                    "Gorgeous, Passionate", // cycle 2
                    "Diligent, Overwhelming", // cycle 3
                    "Vigorous", // cycle 4
                    "Enchanting", // cycle 5
                    "Mysterious", // cycle 6
                    "Sensual", // cycle 7
                    "Fearless", // cycle 8
                    "Invincible" // cycle 9
                ];
                
                // Build cumulative title by adding adjectives from most recent to oldest
                let chineseTitle = "";
                let englishTitle = "";
                
                // Add adjectives from most recent cycle to first cycle (reverse order)
                 for (let i = effectiveCycle; i >= 1; i--) {
                     if (chineseAdjectives[i]) {
                         if (chineseTitle) {
                             chineseTitle += "，" + chineseAdjectives[i];
                         } else {
                             chineseTitle += chineseAdjectives[i];
                         }
                     }
                     if (englishAdjectives[i]) {
                         if (englishTitle) {
                             englishTitle += ", " + englishAdjectives[i];
                         } else {
                             englishTitle += englishAdjectives[i];
                         }
                     }
                 }
                
                // Add base name
                chineseTitle += "左特";
                englishTitle += "Zote the Mighty";
                
                return {
                    zh: chineseTitle,
                    en: englishTitle.trim()
                };
            }

            function toggleAudio() {
                // Ensure cyberpunkAudio element is initialized
                if (!cyberpunkAudio) {
                    cyberpunkAudio = document.getElementById('cyberpunkAudio');
                    if (!cyberpunkAudio) {
                        console.error('❌ cyberpunkAudio element not found in toggleAudio!');
                        return;
                    }
                }

                if (isAudioPlaying) {
                    cyberpunkAudio.pause();
                    isAudioPlaying = false;
                    console.log("⏸️ Audio paused");
                    updateAudioButton();
                } else {
                    // Check if we need to load audio first
                    if (currentAudioIndex >= 0 && currentAudioIndex < audioPlaylist.length) {
                        const currentAudio = audioPlaylist[currentAudioIndex];
                        const source = cyberpunkAudio.querySelector('source');
                        
                        if (!source.src || source.src !== currentAudio.src) {
                            // Need to load audio first
                            loadAndPlayAudio(currentAudio);
                        } else {
                            // Audio already loaded, just play
                            cyberpunkAudio.play().then(() => {
                                isAudioPlaying = true;
                                console.log("▶️ Audio resumed");
                                updateAudioButton();
                            }).catch(error => {
                                console.log("❌ Audio resume failed:", error);
                            });
                        }
                    }
                }
            }

            function updateAudioButton() {
                const audioBtn = document.getElementById('audioControlBtn');
                const playIcon = audioBtn ? audioBtn.querySelector('.play-icon') : null;
                const pauseIcon = audioBtn ? audioBtn.querySelector('.pause-icon') : null;

                if (playIcon && pauseIcon) {
                    if (isAudioPlaying) {
                        playIcon.style.display = 'none';
                        pauseIcon.style.display = 'block';
                    } else {
                        playIcon.style.display = 'block';
                        pauseIcon.style.display = 'none';
                    }
                }
            }

            // Show audio controls (play mode button and playlist) on long press
            function showAudioControls() {
                const audioPanel = document.getElementById('audioControlPanel');
                const playModeBtn = document.getElementById('playModeBtn');
                const playlistSidebar = document.getElementById('audioPlaylistSidebar');
                
                if (audioPanel) {
                    // Show the audio panel
                    if (window.innerWidth <= 768) {
                        audioPanel.classList.add('mobile-show');
                    } else {
                        audioPanel.classList.add('show');
                    }
                    
                    // Force show play mode button
                    if (playModeBtn) {
                        playModeBtn.style.opacity = '1';
                        playModeBtn.style.visibility = 'visible';
                    }
                    
                    // Force show playlist sidebar
                    if (playlistSidebar) {
                        playlistSidebar.style.opacity = '1';
                        playlistSidebar.style.visibility = 'visible';
                        playlistSidebar.style.transform = 'translateY(-50%) translateX(0)';
                    }
                    
                    // Auto hide after 5 seconds (longer duration for long press)
                    setTimeout(() => {
                        if (window.innerWidth <= 768) {
                            audioPanel.classList.remove('mobile-show');
                        } else {
                            audioPanel.classList.remove('show');
                        }
                        
                        // Reset play mode button visibility
                        if (playModeBtn) {
                            playModeBtn.style.opacity = '';
                            playModeBtn.style.visibility = '';
                        }
                        
                        // Reset playlist sidebar visibility
                        if (playlistSidebar) {
                            playlistSidebar.style.opacity = '';
                            playlistSidebar.style.visibility = '';
                            playlistSidebar.style.transform = '';
                        }
                    }, 5000); // 5 seconds for long press display
                }
            }

            // Add keyboard shortcut to close easter egg
            document.addEventListener('keydown', function(e) {
                if (cyberpunkEasterEggTriggered && e.key === 'Escape') {
                    closeCyberpunkEasterEgg();
                }
            });

            // Debug Panel functionality
            let debugPanelVisible = false;
            let debugPermission = false; // 调试权限，只有通过摩尔斯电码彩蛋才能获得
            
            // 摩尔斯电码彩蛋相关变量
            let morseSequence = []; // 当前摩尔斯序列
            let currentMorseChar = []; // 当前字符的摩尔斯码
            let morseTimer = null;
            let pressStartTime = 0;
            let targetMorseSequence = ['-.-.', '.----', '...--', '--...']; // C, 1, 3, 7
            let morseProgress = 0;
            
            // 键盘序列彩蛋相关变量
            let konamiSequence = [];
            let konamiTarget = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA', 'KeyB', 'KeyA'];
            let konamiTimer = null;
            
            // 调试权限序列变量
            let debugSequence = [];
            let debugTarget = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA', 'KeyB', 'KeyA', 'KeyP', 'KeyE', 'KeyN', 'KeyG'];
            let debugTimer = null;

            function setupDebugPanel() {
                const debugToggle = document.getElementById('debugToggle');
                const debugPanel = document.getElementById('debugPanel');

                if (debugToggle && debugPanel) {
                    debugToggle.addEventListener('click', function() {
                        debugPanelVisible = !debugPanelVisible;
                        if (debugPanelVisible) {
                            debugPanel.classList.add('show');
                            updateDebugInfo();
                        } else {
                            debugPanel.classList.remove('show');
                        }
                    });

                    // Update debug info every 2 seconds when visible
                    setInterval(() => {
                        if (debugPanelVisible) {
                            updateDebugInfo();
                        }
                    }, 2000);
                }



                // Add event listeners for quick-set buttons
                const setCyberpunkBtn = document.getElementById('setCyberpunkBtn');
                const setRoseBtn = document.getElementById('setRoseBtn');
                const triggerRunawayBtn = document.getElementById('triggerRunawayBtn');

                if (setCyberpunkBtn) {
                    setCyberpunkBtn.addEventListener('click', setCyberpunkContent);
                }

                if (setRoseBtn) {
                    setRoseBtn.addEventListener('click', setRoseContent);
                }

                if (triggerRunawayBtn) {
                    triggerRunawayBtn.addEventListener('click', triggerRunawayEffect);
                }

                // Add event listeners for easter egg state control buttons
                setupEasterEggStateButtons();
            }

            function setupEasterEggStateButtons() {
                // Phoebe easter egg buttons
                const toggleLangBtn = document.getElementById('toggleLangBtn');
                const togglePengBtn = document.getElementById('togglePengBtn');
                const toggleTributeBtn = document.getElementById('toggleTributeBtn');
                const toggleEssenceBtn = document.getElementById('toggleEssenceBtn');
                const toggleWisdomBtn = document.getElementById('toggleWisdomBtn');
                const toggleBossBtn = document.getElementById('toggleBossBtn');
                const toggleEmailBtn = document.getElementById('toggleEmailBtn');
                const toggleWechatBtn = document.getElementById('toggleWechatBtn');

                // Other easter egg buttons
                const toggleCyberpunkBtn = document.getElementById('toggleCyberpunkBtn');
                const toggleZeldaBtn = document.getElementById('toggleZeldaBtn');
                const toggleRunawayBtn = document.getElementById('toggleRunawayBtn');
                const toggleSmellyCatBtn = document.getElementById('toggleSmellyCatBtn');
                const toggleRoseBtn = document.getElementById('toggleRoseBtn');

                // Control buttons
                const resetAllBtn = document.getElementById('resetAllBtn');
                const triggerAllBtn = document.getElementById('triggerAllBtn');

                // Phoebe easter egg toggles
                if (toggleLangBtn) {
                    toggleLangBtn.addEventListener('click', () => toggleEasterEggState('langToggle', toggleLangBtn));
                }
                if (togglePengBtn) {
                    togglePengBtn.addEventListener('click', () => toggleEasterEggState('pengClick', togglePengBtn));
                }
                if (toggleTributeBtn) {
                    toggleTributeBtn.addEventListener('click', () => toggleEasterEggState('tributeClick', toggleTributeBtn));
                }
                if (toggleEssenceBtn) {
                    toggleEssenceBtn.addEventListener('click', () => toggleEasterEggState('essenceCard', toggleEssenceBtn));
                }
                if (toggleWisdomBtn) {
                    toggleWisdomBtn.addEventListener('click', () => toggleEasterEggState('phoebeWisdom', toggleWisdomBtn));
                }
                if (toggleBossBtn) {
                    toggleBossBtn.addEventListener('click', () => toggleEasterEggState('phoebeWisdomBoss', toggleBossBtn));
                }
                if (toggleEmailBtn) {
                    toggleEmailBtn.addEventListener('click', () => toggleEasterEggState('emailIcon', toggleEmailBtn));
                }
                if (toggleWechatBtn) {
                    toggleWechatBtn.addEventListener('click', () => toggleEasterEggState('wechatIcon', toggleWechatBtn));
                }

                // Other easter egg toggles
                if (toggleCyberpunkBtn) {
                    toggleCyberpunkBtn.addEventListener('click', () => toggleOtherEasterEgg('cyberpunk', toggleCyberpunkBtn));
                }
                const toggleZoteBtn = document.getElementById('toggleZoteBtn');
                if (toggleZoteBtn) {
                    toggleZoteBtn.addEventListener('click', () => toggleOtherEasterEgg('zote', toggleZoteBtn));
                }
                if (toggleZeldaBtn) {
                    toggleZeldaBtn.addEventListener('click', () => toggleOtherEasterEgg('zelda', toggleZeldaBtn));
                }
                if (toggleRunawayBtn) {
                    toggleRunawayBtn.addEventListener('click', () => toggleOtherEasterEgg('runaway', toggleRunawayBtn));
                }
                if (toggleSmellyCatBtn) {
                    toggleSmellyCatBtn.addEventListener('click', () => toggleOtherEasterEgg('smellyCat', toggleSmellyCatBtn));
                }
                if (toggleRoseBtn) {
                    toggleRoseBtn.addEventListener('click', () => toggleOtherEasterEgg('roseQuote', toggleRoseBtn));
                }

                // Control buttons
                if (resetAllBtn) {
                    resetAllBtn.addEventListener('click', resetAllEasterEggs);
                }
                if (triggerAllBtn) {
                    triggerAllBtn.addEventListener('click', triggerAllEasterEggs);
                }
                
                // Individual trigger buttons
                const triggerJojoBtn = document.getElementById('triggerJojoBtn');
                const triggerZoteBtn = document.getElementById('triggerZoteBtn');
                const increaseZoteCycleBtn = document.getElementById('increaseZoteCycleBtn');
                
                if (triggerJojoBtn) {
                    triggerJojoBtn.addEventListener('click', triggerJojoEasterEgg);
                }
                if (triggerZoteBtn) {
                    triggerZoteBtn.addEventListener('click', triggerZoteEasterEgg);
                }
                if (increaseZoteCycleBtn) {
                    increaseZoteCycleBtn.addEventListener('click', increaseZoteCycle);
                }

                // Update button states initially
                updateEasterEggButtonStates();
            }

            function toggleEasterEggState(eggType, buttonElement) {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                easterEggTriggered[eggType] = !easterEggTriggered[eggType];
                updateButtonState(buttonElement, easterEggTriggered[eggType]);
                console.log(`🎯 Debug: ${eggType} easter egg ${easterEggTriggered[eggType] ? 'activated' : 'deactivated'}`);
                
                // Show notification
                showNotification(`${eggType} easter egg ${easterEggTriggered[eggType] ? 'activated' : 'deactivated'}!`);
            }

            function toggleOtherEasterEgg(eggType, buttonElement) {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                switch(eggType) {
                    case 'cyberpunk':
                        cyberpunkEasterEggTriggered = !cyberpunkEasterEggTriggered;
                        updateButtonState(buttonElement, cyberpunkEasterEggTriggered);
                        console.log(`🎯 Debug: Cyberpunk easter egg ${cyberpunkEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Cyberpunk easter egg ${cyberpunkEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                    case 'zote':
                        zoteEasterEggTriggered = !zoteEasterEggTriggered;
                        if (zoteEasterEggTriggered) {
                            triggerZoteEasterEgg();
                        } else {
                            // Restore original Phoebe content
                            restoreOriginalContent();
                        }
                        updateButtonState(buttonElement, zoteEasterEggTriggered);
                        console.log(`🎯 Debug: Zote easter egg ${zoteEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Zote easter egg ${zoteEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                    case 'zelda':
                        zeldaEasterEggTriggered = !zeldaEasterEggTriggered;
                        updateButtonState(buttonElement, zeldaEasterEggTriggered);
                        console.log(`🎯 Debug: Zelda easter egg ${zeldaEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Zelda easter egg ${zeldaEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                    case 'runaway':
                        runawayEasterEggTriggered = !runawayEasterEggTriggered;
                        updateButtonState(buttonElement, runawayEasterEggTriggered);
                        console.log(`🎯 Debug: Runaway easter egg ${runawayEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Runaway easter egg ${runawayEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                    case 'smellyCat':
                        smellyCatEasterEggTriggered = !smellyCatEasterEggTriggered;
                        updateButtonState(buttonElement, smellyCatEasterEggTriggered);
                        console.log(`🎯 Debug: Smelly Cat easter egg ${smellyCatEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Smelly Cat easter egg ${smellyCatEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                    case 'roseQuote':
                        roseQuoteEasterEggTriggered = !roseQuoteEasterEggTriggered;
                        updateButtonState(buttonElement, roseQuoteEasterEggTriggered);
                        console.log(`🎯 Debug: Rose Quote easter egg ${roseQuoteEasterEggTriggered ? 'activated' : 'deactivated'}`);
                        showNotification(`Rose Quote easter egg ${roseQuoteEasterEggTriggered ? 'activated' : 'deactivated'}!`);
                        break;
                }
            }

            function resetAllEasterEggs() {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                // Reset Phoebe easter eggs
                Object.keys(easterEggTriggered).forEach(key => {
                    easterEggTriggered[key] = false;
                });
                
                // Reset other easter eggs
                cyberpunkEasterEggTriggered = false;
                zoteEasterEggTriggered = false;
                zeldaEasterEggTriggered = false;
                runawayEasterEggTriggered = false;
                smellyCatEasterEggTriggered = false;
                roseQuoteEasterEggTriggered = false;
                
                // Restore original content when resetting
                restoreOriginalContent();
                
                // Update all button states
                updateEasterEggButtonStates();
                
                console.log('🔄 Debug: All easter eggs reset');
                showNotification('All easter eggs reset!');
            }

            function triggerAllEasterEggs() {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                // Trigger Phoebe easter eggs
                Object.keys(easterEggTriggered).forEach(key => {
                    easterEggTriggered[key] = true;
                });
                
                // Trigger other easter eggs
                cyberpunkEasterEggTriggered = true;
                zoteEasterEggTriggered = true;
                zeldaEasterEggTriggered = true;
                runawayEasterEggTriggered = true;
                smellyCatEasterEggTriggered = true;
                roseQuoteEasterEggTriggered = true;
                
                // Update all button states
                updateEasterEggButtonStates();
                
                console.log('🎉 Debug: All easter eggs triggered');
                showNotification('All easter eggs triggered!');
            }

            function updateButtonState(buttonElement, isActive) {
                if (buttonElement) {
                    if (isActive) {
                        buttonElement.classList.add('active');
                    } else {
                        buttonElement.classList.remove('active');
                    }
                }
            }

            function updateEasterEggButtonStates() {
                // Update Phoebe easter egg buttons
                updateButtonState(document.getElementById('toggleLangBtn'), easterEggTriggered.langToggle);
                updateButtonState(document.getElementById('togglePengBtn'), easterEggTriggered.pengClick);
                updateButtonState(document.getElementById('toggleTributeBtn'), easterEggTriggered.tributeClick);
                updateButtonState(document.getElementById('toggleEssenceBtn'), easterEggTriggered.essenceCard);
                updateButtonState(document.getElementById('toggleWisdomBtn'), easterEggTriggered.phoebeWisdom);
                updateButtonState(document.getElementById('toggleBossBtn'), easterEggTriggered.phoebeWisdomBoss);
                updateButtonState(document.getElementById('toggleEmailBtn'), easterEggTriggered.emailIcon);
                updateButtonState(document.getElementById('toggleWechatBtn'), easterEggTriggered.wechatIcon);
                
                // Update other easter egg buttons
                updateButtonState(document.getElementById('toggleCyberpunkBtn'), cyberpunkEasterEggTriggered);
                updateButtonState(document.getElementById('toggleZoteBtn'), zoteEasterEggTriggered);
                updateButtonState(document.getElementById('toggleZeldaBtn'), zeldaEasterEggTriggered);
                updateButtonState(document.getElementById('toggleRunawayBtn'), runawayEasterEggTriggered);
                updateButtonState(document.getElementById('toggleSmellyCatBtn'), smellyCatEasterEggTriggered);
                updateButtonState(document.getElementById('toggleRoseBtn'), roseQuoteEasterEggTriggered);
            }

            function updateDebugInfo() {
                const quotesList = document.getElementById('quotesList');
                if (!quotesList) return;

                const currentCards = document.querySelectorAll(
                    isEnglish
                        ? "#englishContent .essence-card"
                        : "#chineseContent .essence-card",
                );

                const targetText = isEnglish
                    ? "You're a natural-born Edgerunner."
                    : "你是个天生的边缘行者。";

                let html = '';
                let matchCount = 0;

                currentCards.forEach((card, index) => {
                    const titleEl = card.querySelector(".essence-title");
                    const title = titleEl ? titleEl.textContent.trim() : '';
                    const isMatch = title === targetText;
                    const isCurrentTarget = false;

                    if (isMatch) matchCount++;

                    html += `<p style="color: ${isMatch ? '#feedea' : 'rgba(254, 237, 234, 0.6)'}; ${isCurrentTarget ? 'background: rgba(254, 237, 234, 0.2); padding: 0.2rem; border-radius: 3px;' : ''}">
                        Card ${index + 1}: ${isMatch ? 'Match' : 'No Match'} ${isCurrentTarget ? 'Target' : ''}<br/>
                        <small>"${title.substring(0, 25)}${title.length > 25 ? '...' : ''}"</small>
                    </p>`;
                });

                html += `<p style="color: #feedea; font-weight: bold; margin-top: 0.5rem;">
                    Progress: ${matchCount}/3 cards match
                </p>`;

                // Add easter egg status display
                html += `<div style="margin-top: 1rem; padding: 0.5rem; background: rgba(0,0,0,0.3); border-radius: 5px;">`;
                html += `<p style="color: #feedea; font-weight: bold; margin: 0 0 0.5rem 0;">Easter Egg Status:</p>`;
                
                // Phoebe easter eggs
                const phoebeEggs = [
                    { key: 'langToggle', name: 'Lang Toggle' },
                    { key: 'pengClick', name: 'Peng Click' },
                    { key: 'tributeClick', name: 'Tribute Click' },
                    { key: 'essenceCard', name: 'Essence Card' },
                    { key: 'phoebeWisdom', name: 'Phoebe Wisdom' },
                    { key: 'phoebeWisdomBoss', name: 'Phoebe Boss' },
                    { key: 'emailIcon', name: 'Email Icon' },
                    { key: 'wechatIcon', name: 'WeChat Icon' },
                ];
                
                let eggNumber = 1;
                phoebeEggs.forEach(egg => {
                    const isTriggered = easterEggTriggered[egg.key];
                    const checkmark = isTriggered ? '✓' : '○';
                    const color = isTriggered ? '#feedea' : 'rgba(254, 237, 234, 0.5)';
                    html += `<div style="color: ${color}; font-size: 0.85rem; margin: 0.2rem 0; line-height: 1.3;">${eggNumber}. ${checkmark} ${egg.name}</div>`;
                    eggNumber++;
                });
                
                // Other easter eggs
                const otherEggs = [
                    { var: cyberpunkEasterEggTriggered, name: 'Cyberpunk' },
                    { var: zeldaEasterEggTriggered, name: 'Zelda' },
                    { var: runawayEasterEggTriggered, name: 'Runaway' },
                    { var: smellyCatEasterEggTriggered, name: 'Smelly Cat' },
                    { var: roseQuoteEasterEggTriggered, name: 'Rose Quote' }
                ];
                
                otherEggs.forEach(egg => {
                    const isTriggered = egg.var;
                    const checkmark = isTriggered ? '✓' : '○';
                    const color = isTriggered ? '#feedea' : 'rgba(254, 237, 234, 0.5)';
                    html += `<div style="color: ${color}; font-size: 0.85rem; margin: 0.2rem 0; line-height: 1.3;">${eggNumber}. ${checkmark} ${egg.name}</div>`;
                    eggNumber++;
                });
                
                html += `</div>`;



                if (matchCount === 3) {
                    html += `<p style="color: #feedea; font-weight: bold; animation: pulse 1s infinite;">
                        🎉 Easter egg will trigger soon!
                    </p>`;
                }

                quotesList.innerHTML = html;
            }











            // Handle window resize to reposition squares if needed
            window.addEventListener("resize", function () {
                zimaSquares.forEach((square) => {
                    const rect = square.getBoundingClientRect();
                    if (
                        rect.right > window.innerWidth ||
                        rect.bottom > window.innerHeight
                    ) {
                        const maxX =
                            window.innerWidth -
                            parseInt(square.style.width || 12);
                        const maxY =
                            window.innerHeight -
                            parseInt(square.style.height || 12);
                        square.style.left = Math.min(rect.left, maxX) + "px";
                        square.style.top = Math.min(rect.top, maxY) + "px";
                    }
                });
            });

            // Initialize quotes and clickable text
            document.addEventListener("DOMContentLoaded", function () {
                // Initialize with random quotes
                for (let i = 0; i < 3; i++) {
                    changeQuote(i);
                }

                // Start Zima Blue system
                startZimaBlueSystem();

                // Setup debug panel
                setupDebugPanel();

                // Setup permanent audio controls (always available after page load)
                setTimeout(() => {
                    setupAudioControl();
                    setupCloseButton();
                    // Initialize empty playlist at startup
                    initializePlaylist();
                }, 100);

                // Note: Close button will only be shown after easter egg is triggered
            });

            // Easter egg: clicking the circle 7 times shows a Phoebe quote
            let clickCount = 0;
            let phoebeAnimationCount = 0;

            // Easter egg event listeners - using event delegation for maximum stability
            let easterEggEventsInitialized = false;
            let colorCircleEventCount = 0;

            function initializeEasterEggEvents() {
                if (easterEggEventsInitialized) {
                    console.log(
                        "⚠️ Easter egg events already initialized, skipping...",
                    );
                    return;
                }
                easterEggEventsInitialized = true;

                console.log(
                    "🎮 Initializing easter egg events with event delegation...",
                );
                console.log(
                    "🔍 Adding single document-level event listener...",
                );

                // Unified event handler for both click and touch
                function handleUnifiedInteraction(e) {
                    const target = e.target;
                    const currentTarget = e.currentTarget;
                    
                    // Prevent double firing for touch events
                    if (e.type === 'touchend') {
                        e.preventDefault();
                    }

                    // 2. Peng triple click - target any .final-text element
                    if (
                        target.classList.contains("final-text") ||
                        target.closest(".final-text")
                    ) {
                        const pengElement = target.classList.contains(
                            "final-text",
                        )
                            ? target
                            : target.closest(".final-text");
                        console.log(
                            "🐧 Peng clicked! Element:",
                            pengElement.textContent,
                        );
                        e.stopPropagation();
                        handleTripleClick(
                            "pengClick",
                            "do-you-have-a-plan.mp3",
                            isEnglish
                                ? "I don't even have a 'pla'."
                                : "计划?我讠都还没有",
                        );
                        return;
                    }

                    // 3. Tribute text triple click - target any .tribute element
                    if (
                        target.classList.contains("tribute") ||
                        target.closest(".tribute")
                    ) {
                        const tributeElement = target.classList.contains(
                            "tribute",
                        )
                            ? target
                            : target.closest(".tribute");
                        console.log(
                            "💝 Tribute clicked! Element:",
                            tributeElement.textContent,
                        );
                        e.stopPropagation();
                        handleTripleClick(
                            "tributeClick",
                            "see-hes-her-lobster.mp3",
                            isEnglish
                                ? "See? He's her lobster!"
                                : "看吧？他是她的龙虾！",
                        );
                        return;
                    }

                    // 4. Essence cards triple click
                    if (
                        target.classList.contains("essence-card") ||
                        target.closest(".essence-card")
                    ) {
                        // Don't interfere with the original quote change functionality
                        const isQuoteClick =
                            target.classList.contains("quote-clickable");
                        if (!isQuoteClick) {
                            console.log(
                                "📝 Essence card clicked for easter egg",
                            );
                            handleTripleClick(
                                "essenceCard",
                                "that-is-brand-new-information.mp3",
                                isEnglish
                                    ? "That is brand new information!"
                                    : "全新的信息！",
                            );
                        }
                        return;
                    }

                    // 5. Phoebe wisdom section triple click
                    if (
                        target.classList.contains("phoebe-title") ||
                        target.closest(".phoebe-title")
                    ) {
                        console.log("👩 Phoebe title clicked!");
                        handleTripleClick(
                            "phoebeWisdom",
                            "i-wish-i-could.mp3",
                            isEnglish
                                ? "Oh, I wish I could, but I don't want to."
                                : "哦，我希望我能去帮忙，但我不想去。",
                        );
                        return;
                    }

                    // 5.1. Phoebe wisdom quote triple click for boss.mp3
                    if (
                        target.classList.contains("phoebe-quote") ||
                        target.closest(".phoebe-quote")
                    ) {
                        console.log("💪 Phoebe quote clicked!");
                        handleTripleClick(
                            "phoebeWisdomBoss",
                            "boss.mp3",
                            isEnglish
                                ? "You are the boss of you!"
                                : "你是你自己的老板！",
                        );
                        return;
                    }

                    // 5.2. Email icon triple click
                    if (
                        target.classList.contains("email-icon") ||
                        target.closest(".email-icon")
                    ) {
                        console.log("📧 Email icon clicked!");
                        handleTripleClick(
                            "emailIcon",
                            "email.mp3",
                            isEnglish
                                ? "Email!"
                                : "邮件！",
                        );
                        return;
                    }

                    // 5.3. WeChat icon triple click
                    if (
                        target.classList.contains("wechat-icon") ||
                        target.closest(".wechat-icon")
                    ) {
                        console.log("💬 WeChat icon clicked!");
                        handleTripleClick(
                            "wechatIcon",
                            "computer.mp3",
                            isEnglish
                                ? "Add me on WeChat (please state your purpose)!"
                                : "如有需要请加微信(请注明来意)！",
                        );
                        return;
                    }

                    // 6. Color circle - final easter egg
                    if (
                        target.classList.contains("color-circle") ||
                        target.closest(".color-circle")
                    ) {
                        colorCircleEventCount++;
                        console.log(
                            `🎨 Color circle clicked! (Event #${colorCircleEventCount})`,
                        );
                        console.log("🎨 Click target:", target);
                        console.log("🎨 Target classes:", target.className);
                        console.log(
                            "🎨 Current language:",
                            isEnglish ? "English" : "Chinese",
                        );

                        // Prevent any other click handlers immediately
                        e.preventDefault();
                        e.stopPropagation();
                        e.stopImmediatePropagation();

                        // Debounce mechanism to prevent multiple rapid calls
                        if (!window.colorCircleProcessing) {
                            window.colorCircleProcessing = true;
                            console.log("🎨 Processing color circle click...");

                            triggerWhoSinging();

                            // Reset processing flag after a short delay
                            setTimeout(() => {
                                window.colorCircleProcessing = false;
                                console.log(
                                    "🎨 Color circle processing flag reset",
                                );
                            }, 1000);
                        } else {
                            console.log(
                                "🎨 Color circle click ignored (already processing)",
                            );
                        }
                        return;
                    }
                }
                
                // Register both click and touch event listeners
                document.addEventListener("click", handleUnifiedInteraction);
                document.addEventListener("touchend", handleUnifiedInteraction, { passive: false });
            }

            // Initialize easter egg events immediately (only once)
            console.log("🚀 About to initialize easter egg events...");
            initializeEasterEggEvents();

            // Prevent any additional initialization
            window.easterEggSystemInitialized = true;

            function handleTripleClick(eggType, audioFile, message) {
                clickCounters[eggType]++;
                console.log(
                    `🎯 ${eggType} clicked, count: ${clickCounters[eggType]}`,
                );
                console.log(`🎯 Audio file: ${audioFile}`);
                console.log(`🎯 Message: ${message}`);

                // Reset timer
                if (clickTimers[eggType]) {
                    clearTimeout(clickTimers[eggType]);
                    console.log(`⏰ ${eggType} timer cleared`);
                }

                // Set timer to reset counter after 1 second
                clickTimers[eggType] = setTimeout(() => {
                    console.log(`⏰ ${eggType} counter reset to 0 (timeout)`);
                    clickCounters[eggType] = 0;
                }, 1000);

                // Check if triple clicked
                if (clickCounters[eggType] === 3) {
                    // Check if this easter egg has reached its trigger limit (3 times)
                    if (easterEggTriggerCounts[eggType] >= 3) {
                        console.log(`${eggType} easter egg has reached maximum triggers (3/3)`);
                        clickCounters[eggType] = 0;
                        return;
                    }
                    
                    console.log(`${eggType} easter egg triggered! (${easterEggTriggerCounts[eggType] + 1}/3)`);
                    easterEggTriggered[eggType] = true;
                    easterEggTriggerCounts[eggType]++;
                    console.log(`Playing audio: ${audioFile}`);
                    playAudio(audioFile);
                    showEasterEggNotification(message);
                    clickCounters[eggType] = 0;
                }
            }

            function triggerWhoSinging() {
                console.log("🎨 triggerWhoSinging() called");
                console.log(
                    "Current language:",
                    isEnglish ? "English" : "Chinese",
                );

                // Check if all easter eggs have been triggered
                const eggStates = Object.entries(easterEggTriggered);
                console.log("🎯 Detailed easter egg states:");
                eggStates.forEach(([key, value]) => {
                    console.log(`  ${key}: ${value ? "✅" : "❌"}`);
                });
                
                // Check additional easter eggs
                console.log(`  cyberpunk: ${cyberpunkEasterEggTriggered ? "✅" : "❌"}`);
                console.log(`  zelda: ${zeldaEasterEggTriggered ? "✅" : "❌"}`);
                console.log(`  runaway: ${runawayEasterEggTriggered ? "✅" : "❌"}`);
                console.log(`  smellyCat: ${smellyCatEasterEggTriggered ? "✅" : "❌"}`);

                const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                // For now, only require Phoebe easter eggs to trigger "Who's singing?"
                const allTriggered = allPhoebe;

                console.log("🎯 All Phoebe easter eggs triggered:", allPhoebe);
                console.log("🎯 All easter eggs triggered:", allTriggered);
                console.log(
                    "🎯 Raw easter egg object:",
                    JSON.stringify(easterEggTriggered),
                );

                if (allTriggered) {
                    console.log(
                        "🎉 ALL CONDITIONS MET! Triggering 'Who's singing?' easter egg",
                    );
                    console.log("🎵 About to play who-singing.mp3");
                    playAudio("who-singing.mp3");

                    const message = isEnglish ? "Who's singing?" : "谁在唱歌？";
                    console.log("💬 Showing notification:", message);
                    showEasterEggNotification(message);

                    // Start listening for "you" input
                    isListeningForYou = true;
                    keySequence = [];
                    console.log(
                        "👂 Now listening for 'you' input for 5 seconds...",
                    );

                    // Stop listening after 5 seconds
                    if (whoSingingTimer) {
                        clearTimeout(whoSingingTimer);
                    }
                    whoSingingTimer = setTimeout(() => {
                        console.log(
                            "⏰ 'You' input timeout - stopped listening",
                        );
                        isListeningForYou = false;
                        keySequence = [];
                    }, 5000);
                } else {
                    const missingEggs = Object.entries(easterEggTriggered)
                        .filter(([key, value]) => !value)
                        .map(([key]) => key);
                    console.log(
                        "❌ Not all easter eggs triggered yet. Missing:",
                        missingEggs,
                    );
                    console.log(
                        `📊 Progress: ${5 - missingEggs.length}/5 easter eggs completed`,
                    );
                    console.log(
                        "💡 You need to trigger these easter eggs first:",
                        missingEggs.join(", "),
                    );
                }
            }

            function showSmellyCatContent() {
                console.log("🎵 Showing Smelly Cat content first");
                smellyCatEasterEggTriggered = true;
                console.log("🐱 Smelly Cat easter egg triggered!");
                playAudio("smelly_cat.mp3");

                // Create Smelly Cat overlay
                const smellyCatOverlay = document.createElement("div");
                smellyCatOverlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: linear-gradient(45deg,
                        rgba(255, 192, 203, 0.9),
                        rgba(254, 235, 234, 0.9),
                        rgba(255, 255, 255, 0.9)
                    );
                    z-index: 20000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    backdrop-filter: blur(20px);
                    animation: fadeIn 1s ease-out;
                `;

                const smellyCatContent = document.createElement("div");
                smellyCatContent.style.cssText = `
                    text-align: center;
                    color: #333;
                    font-family: "Great Vibes", cursive;
                    max-width: 80vw;
                `;

                const smellyCatTitle = "🎵 Smelly Cat 🎵";
                const smellyCatText = isEnglish
                    ? "Smelly Cat, smelly cat<br>What are they feeding you?<br>Smelly cat, smelly cat<br>It's not your fault.<br>They won't take you to the vet<br>You're obviously not their favorite pet<br>You may not be a bed of roses<br>And you're no friend to those with noses"
                    : "臭臭猫啊臭臭猫<br>他们都给你吃什么啊？<br>臭臭猫啊臭臭猫<br>这不是你的错<br>他们不带你看医生<br>很明显你不是他们的最爱<br>你不是一床玫瑰<br>但你也不是这帮长着鼻子的东西的朋友";

                smellyCatContent.innerHTML = `
                    <h1 style="font-size: 4rem; margin-bottom: 2rem; text-shadow: 2px 2px 4px rgba(0,0,0,0.3);">
                        ${smellyCatTitle}
                    </h1>
                    <p style="font-family: 'Dancing Script', cursive; font-size: 2rem; line-height: 1.6; margin-bottom: 3rem;">
                        ${smellyCatText}
                    </p>
                    <p style="font-family: 'Dancing Script', cursive; font-size: 1.8rem; margin-top: 2rem; font-weight: bold;">
                        你找到所有彩蛋了~吗?
                    </p>
                `;

                smellyCatOverlay.appendChild(smellyCatContent);
                document.body.appendChild(smellyCatOverlay);

                // After 8 seconds, transition to Friends typing effect
                setTimeout(() => {
                    smellyCatOverlay.style.animation =
                        "fadeOut 1s ease-out forwards";
                    setTimeout(() => {
                        if (document.body.contains(smellyCatOverlay)) {
                            document.body.removeChild(smellyCatOverlay);
                        }
                        showFriendsTypingEffect();
                    }, 1000);
                }, 8000);

                // Click to skip to typing effect
                smellyCatOverlay.addEventListener("click", () => {
                    smellyCatOverlay.style.animation =
                        "fadeOut 0.5s ease-out forwards";
                    setTimeout(() => {
                        if (document.body.contains(smellyCatOverlay)) {
                            document.body.removeChild(smellyCatOverlay);
                        }
                        showFriendsTypingEffect();
                    }, 500);
                });
            }

            function showFriendsTypingEffect() {
                console.log("🎭 Starting Friends display effect");

                // Add local font face if not already added
                if (!document.getElementById("friendsFontStyle")) {
                    const fontStyle = document.createElement("style");
                    fontStyle.id = "friendsFontStyle";
                    fontStyle.textContent = `
                        @font-face {
                            font-family: 'Gabriel Weiss Friends Font Local';
                            src: url('./phoebe/GABRWFFR.TTF') format('truetype');
                            font-weight: normal;
                            font-style: normal;
                        }
                    `;
                    document.head.appendChild(fontStyle);
                }

                // Create fullscreen overlay for display effect
                const displayOverlay = document.createElement("div");
                displayOverlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: #000;
                    z-index: 25000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    animation: fadeIn 1s ease-out;
                `;

                const displayText = document.createElement("div");
                displayText.style.cssText = `
                    text-align: center;
                    font-family: 'Gabriel Weiss Friends Font Local', 'Gabriel Weiss Friends Font', 'Trebuchet MS', 'Arial Black', 'Helvetica', sans-serif;
                    font-weight: 900;
                    color: #feebea;
                    line-height: 1;
                    animation: scaleIn 1s ease-out;
                    padding: 1rem 2rem;
                    box-sizing: border-box;
                    width: 100%;
                    display: flex;
                    flex-direction: row;
                    align-items: center;
                    justify-content: center;
                    min-height: 100vh;
                    flex-wrap: nowrap;
                    margin: 0 auto;
                `;

                // Adjust font size for different screen sizes with better responsiveness
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const isPortrait = screenHeight > screenWidth;
                let fontSize, letterSpacing;

                if (screenWidth < 480 || isPortrait) {
                    fontSize = "1.5rem";
                    letterSpacing = "0.1rem";
                } else if (screenWidth < 768) {
                    fontSize = "2.5rem";
                    letterSpacing = "0.15rem";
                } else if (screenWidth < 1024) {
                    fontSize = "3.5rem";
                    letterSpacing = "0.2rem";
                } else if (screenWidth < 1440) {
                    fontSize = "4.5rem";
                    letterSpacing = "0.3rem";
                } else {
                    fontSize = "5.5rem";
                    letterSpacing = "0.4rem";
                }

                displayText.style.fontSize = fontSize;
                displayText.style.letterSpacing = letterSpacing;
                displayText.style.gap = "0.05em";
                displayText.style.maxWidth = "90vw";
                displayText.style.overflow = "visible";
                displayText.style.whiteSpace = "nowrap";
                displayText.style.textAlign = "center";

                // Add background glow effect
                const backgroundGlow = document.createElement("div");
                backgroundGlow.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    width: 80vw;
                    height: 40vh;
                    background: radial-gradient(ellipse, rgba(254, 235, 234, 0.1) 0%, transparent 70%);
                    filter: blur(50px);
                    z-index: -1;
                    animation: glowPulse 3s ease-in-out infinite alternate;
                `;

                // Add CSS for animations
                if (!document.getElementById("friendsDisplayStyle")) {
                    const displayStyle = document.createElement("style");
                    displayStyle.id = "friendsDisplayStyle";
                    displayStyle.textContent = `
                        @keyframes glowPulse {
                            0% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
                            100% { opacity: 0.8; transform: translate(-50%, -50%) scale(1.2); }
                        }
                        @keyframes scaleIn {
                            0% { transform: scale(0.5); opacity: 0; }
                            100% { transform: scale(1); opacity: 1; }
                        }
                        @keyframes letterGlow {
                            0% { filter: brightness(1) saturate(1); }
                            100% { filter: brightness(1.3) saturate(1.5); }
                        }
                    `;
                    document.head.appendChild(displayStyle);
                }

                displayOverlay.appendChild(backgroundGlow);
                displayOverlay.appendChild(displayText);
                document.body.appendChild(displayOverlay);

                // Display F·R·I·E·N·D·S with colored dots all at once
                const letters = [
                    { char: "F", color: "#feebea" },
                    { char: "·", color: "rgb(181, 48, 44)" },
                    { char: "R", color: "#feebea" },
                    { char: "·", color: "rgb(102, 186, 229)" },
                    { char: "I", color: "#feebea" },
                    { char: "·", color: "rgb(247, 230, 83)" },
                    { char: "E", color: "#feebea" },
                    { char: "·", color: "rgb(181, 48, 44)" },
                    { char: "N", color: "#feebea" },
                    { char: "·", color: "rgb(247, 230, 83)" },
                    { char: "D", color: "#feebea" },
                    { char: "·", color: "rgb(102, 186, 229)" },
                    { char: "S", color: "#feebea" },
                ];

                // Create all letters at once
                letters.forEach((letter, index) => {
                    const letterElement = document.createElement("span");
                    letterElement.textContent = letter.char;
                    letterElement.style.cssText = `
                        color: ${letter.color};
                        display: inline-block;
                        font-weight: 900;
                        margin: 0 ${letter.char === "·" ? "0.1em" : "0.05em"};
                        transform-origin: center bottom;
                        position: relative;
                    `;

                    displayText.appendChild(letterElement);
                });

                // Keep for 5 seconds then fade out
                setTimeout(() => {
                    displayOverlay.style.transition = "opacity 2s ease-out";
                    displayOverlay.style.opacity = "0";

                    setTimeout(() => {
                        if (document.body.contains(displayOverlay)) {
                            document.body.removeChild(displayOverlay);
                        }
                    }, 2000);
                }, 5000);

                // Click to dismiss immediately
                displayOverlay.addEventListener("click", () => {
                    displayOverlay.style.transition = "opacity 1s ease-out";
                    displayOverlay.style.opacity = "0";
                    setTimeout(() => {
                        if (document.body.contains(displayOverlay)) {
                            document.body.removeChild(displayOverlay);
                        }
                    }, 1000);
                });
            }

            function playAudio(filename) {
                console.log("🎵 Playing audio:", filename);

                // Try multiple possible paths, prioritizing phoebe folder
                const paths = [
                    `./phoebe/${filename}`,
                    `phoebe/${filename}`,
                    `./audio/${filename}`,
                    `audio/${filename}`,
                    filename,
                ];

                let currentPathIndex = 0;

                function tryNextPath() {
                    if (currentPathIndex >= paths.length) {
                        console.error(
                            "❌ All audio paths failed for:",
                            filename,
                        );
                        return;
                    }

                    const currentPath = paths[currentPathIndex];
                    console.log(
                        `🔄 Trying path ${currentPathIndex + 1}:`,
                        currentPath,
                    );

                    const audio = new Audio(currentPath);

                    audio.addEventListener("canplay", () => {
                        console.log("✅ Audio ready to play:", currentPath);
                    });

                    audio.addEventListener("ended", () => {
                        console.log("🎵 Audio finished playing:", currentPath);
                    });

                    audio
                        .play()
                        .then(() => {
                            console.log(
                                "🎉 Audio playing successfully:",
                                currentPath,
                            );
                        })
                        .catch((error) => {
                            console.warn(
                                `⚠️ Path ${currentPathIndex + 1} failed:`,
                                error.message,
                            );
                            currentPathIndex++;
                            tryNextPath();
                        });
                }

                tryNextPath();
            }

            function playAudioFromTime(filename, startTime) {
                console.log(`🎵 Playing audio from ${startTime}s:`, filename);

                // Try multiple possible paths, prioritizing phoebe folder
                const paths = [
                    `./phoebe/${filename}`,
                    `phoebe/${filename}`,
                    `./audio/${filename}`,
                    `audio/${filename}`,
                    filename,
                ];

                let currentPathIndex = 0;

                function tryNextPath() {
                    if (currentPathIndex >= paths.length) {
                        console.error(
                            "❌ All audio paths failed for:",
                            filename,
                        );
                        return;
                    }

                    const currentPath = paths[currentPathIndex];
                    console.log(
                        `🔄 Trying path ${currentPathIndex + 1}:`,
                        currentPath,
                    );

                    const audio = new Audio(currentPath);

                    audio.addEventListener("canplay", () => {
                        console.log("✅ Audio ready to play:", currentPath);
                        // Set the start time when audio is ready
                        audio.currentTime = startTime;
                    });

                    audio.addEventListener("ended", () => {
                        console.log("🎵 Audio finished playing:", currentPath);
                    });

                    audio
                        .play()
                        .then(() => {
                            console.log(
                                `🎉 Audio playing successfully from ${startTime}s:`,
                                currentPath,
                            );
                        })
                        .catch((error) => {
                            console.warn(
                                `⚠️ Path ${currentPathIndex + 1} failed:`,
                                error.message,
                            );
                            currentPathIndex++;
                            tryNextPath();
                        });
                }

                tryNextPath();
            }

            function showEasterEggNotification(message) {
                const notification = document.createElement("div");
                const animationType = Math.floor(Math.random() * 8);
                let animationCSS = "";
                let positionCSS = "";

                // Generate random positions
                const positions = [
                    { top: "20%", left: "20%" },
                    { top: "20%", right: "20%" },
                    { top: "70%", left: "20%" },
                    { top: "70%", right: "20%" },
                    { top: "50%", left: "10%" },
                    { top: "50%", right: "10%" },
                    { top: "30%", left: "50%", transform: "translateX(-50%)" },
                    { top: "60%", left: "50%", transform: "translateX(-50%)" },
                ];

                const randomPosition =
                    positions[Math.floor(Math.random() * positions.length)];

                // Build position CSS
                if (randomPosition.top)
                    positionCSS += `top: ${randomPosition.top}; `;
                if (randomPosition.left)
                    positionCSS += `left: ${randomPosition.left}; `;
                if (randomPosition.right)
                    positionCSS += `right: ${randomPosition.right}; `;
                if (randomPosition.transform)
                    positionCSS += `transform: ${randomPosition.transform}; `;

                switch (animationType) {
                    case 0:
                        animationCSS = `
                            @keyframes fallFromLeft {
                                0% { transform: translateX(-100vw) translateY(-50px) scale(0); opacity: 0; }
                                20% { transform: translateX(0) translateY(0) scale(1.1); opacity: 1; }
                                80% { opacity: 1; transform: scale(1); }
                                100% { transform: translateX(100vw) scale(0); opacity: 0; }
                            }
                            animation: fallFromLeft 4s ease-out forwards;
                        `;
                        break;
                    case 1:
                        animationCSS = `
                            @keyframes bounceIn {
                                0% { transform: scale(0) rotate(0deg); opacity: 0; }
                                50% { transform: scale(1.3) rotate(180deg); opacity: 1; }
                                70% { transform: scale(0.9) rotate(270deg); opacity: 1; }
                                100% { transform: scale(1) rotate(360deg); opacity: 1; }
                            }
                            animation: bounceIn 2s ease-out forwards, fadeOut 2s ease-out 2s forwards;
                        `;
                        break;
                    case 2:
                        animationCSS = `
                            @keyframes slideUp {
                                0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
                                20% { opacity: 1; transform: translateY(0) scale(1.1); }
                                80% { opacity: 1; transform: scale(1); }
                                100% { transform: translateY(-100vh) scale(0.5); opacity: 0; }
                            }
                            animation: slideUp 4s ease-out forwards;
                        `;
                        break;
                    case 3:
                        animationCSS = `
                            @keyframes spiral {
                                0% { transform: scale(0) rotate(0deg); opacity: 0; }
                                25% { transform: scale(1) rotate(90deg) translateX(50px); opacity: 1; }
                                50% { transform: scale(1.2) rotate(180deg) translateX(0); opacity: 1; }
                                75% { transform: scale(1) rotate(270deg) translateX(-50px); opacity: 1; }
                                100% { transform: scale(0) rotate(360deg); opacity: 0; }
                            }
                            animation: spiral 3s ease-out forwards;
                        `;
                        break;
                    case 4:
                        animationCSS = `
                            @keyframes zigzag {
                                0% { transform: translateX(-200px) translateY(-100px) scale(0); opacity: 0; }
                                25% { transform: translateX(100px) translateY(50px) scale(1); opacity: 1; }
                                50% { transform: translateX(-50px) translateY(-30px) scale(1.1); opacity: 1; }
                                75% { transform: translateX(80px) translateY(20px) scale(0.9); opacity: 1; }
                                100% { transform: translateX(300px) translateY(-200px) scale(0); opacity: 0; }
                            }
                            animation: zigzag 3.5s ease-in-out forwards;
                        `;
                        break;
                    case 5:
                        animationCSS = `
                            @keyframes pulse {
                                0% { transform: scale(0); opacity: 0; }
                                20% { transform: scale(1.2); opacity: 1; }
                                40% { transform: scale(0.8); opacity: 1; }
                                60% { transform: scale(1.1); opacity: 1; }
                                80% { transform: scale(0.9); opacity: 1; }
                                100% { transform: scale(1); opacity: 1; }
                            }
                            animation: pulse 1.5s ease-out forwards, fadeOut 2s ease-out 2s forwards;
                        `;
                        break;
                    case 6:
                        animationCSS = `
                            @keyframes flyIn {
                                0% { transform: translateX(100vw) translateY(-100vh) rotate(0deg) scale(0.3); opacity: 0; }
                                30% { transform: translateX(0) translateY(0) rotate(180deg) scale(1.2); opacity: 1; }
                                70% { transform: rotate(360deg) scale(1); opacity: 1; }
                                100% { transform: translateX(-100vw) translateY(100vh) rotate(720deg) scale(0.3); opacity: 0; }
                            }
                            animation: flyIn 4.5s ease-in-out forwards;
                        `;
                        break;
                    case 7:
                        animationCSS = `
                            @keyframes wave {
                                0% { transform: translateY(50px) scale(0); opacity: 0; }
                                25% { transform: translateY(-20px) scale(1); opacity: 1; }
                                50% { transform: translateY(10px) scale(1.1); opacity: 1; }
                                75% { transform: translateY(-5px) scale(0.9); opacity: 1; }
                                100% { transform: translateY(0) scale(1); opacity: 1; }
                            }
                            animation: wave 1.8s ease-out forwards, fadeOut 2s ease-out 2.5s forwards;
                        `;
                        break;
                }

                notification.innerHTML = `
                    <style>
                        ${animationCSS}
                        @keyframes fadeOut {
                            0% { opacity: 1; }
                            100% { opacity: 0; }
                        }
                    </style>
                `;

                notification.style.cssText = `
                    position: fixed;
                    ${positionCSS}
                    background: linear-gradient(45deg, rgba(254, 235, 234, 0.95), rgba(255, 255, 255, 0.95));
                    color: #333;
                    padding: 1.5rem 2.5rem;
                    border-radius: 20px;
                    font-family: "Dancing Script", cursive;
                    font-size: 1.3rem;
                    font-weight: bold;
                    text-align: center;
                    z-index: 10000;
                    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
                    border: 2px solid rgba(254, 235, 234, 0.8);
                    backdrop-filter: blur(10px);
                    max-width: 300px;
                    word-wrap: break-word;
                    pointer-events: none;
                `;

                notification.textContent = message;
                document.body.appendChild(notification);

                // Remove after animation
                setTimeout(() => {
                    if (document.body.contains(notification)) {
                        document.body.removeChild(notification);
                    }
                }, 5000);
            }

            // Simple notification function for general use
            function showNotification(message) {
                const notification = document.createElement("div");
                
                // Detect if message contains Chinese characters
                const isChinese = /[\u4e00-\u9fff]/.test(message);
                const fontSize = window.innerWidth <= 480 ? '0.8rem' : (window.innerWidth <= 768 ? '0.9rem' : '1rem');
                const padding = window.innerWidth <= 480 ? '0.5rem 0.8rem' : (window.innerWidth <= 768 ? '0.6rem 1rem' : '0.7rem 1.2rem');
                const maxWidth = window.innerWidth <= 480 ? '180px' : (window.innerWidth <= 768 ? '200px' : '220px');
                
                notification.style.cssText = `
                    position: fixed;
                    top: 15px;
                    right: 15px;
                    background: linear-gradient(45deg, rgba(254, 235, 234, 0.95), rgba(255, 255, 255, 0.95));
                    color: #333;
                    padding: ${padding};
                    border-radius: 8px;
                    font-family: ${isChinese ? '"PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif' : '"Dancing Script", cursive'};
                    font-size: ${fontSize};
                    font-weight: ${isChinese ? 'normal' : 'bold'};
                    text-align: center;
                    z-index: 10000;
                    box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);
                    border: 1px solid rgba(254, 235, 234, 0.8);
                    backdrop-filter: blur(8px);
                    max-width: ${maxWidth};
                    word-wrap: break-word;
                    pointer-events: none;
                    opacity: 0;
                    transform: translateX(100%) scale(0.9);
                    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                `;

                notification.textContent = message;
                document.body.appendChild(notification);

                // Animate in
                setTimeout(() => {
                    notification.style.opacity = '1';
                    notification.style.transform = 'translateX(0) scale(1)';
                }, 10);

                // Animate out and remove
                setTimeout(() => {
                    notification.style.opacity = '0';
                    notification.style.transform = 'translateX(100%) scale(0.9)';
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 300);
                }, 2200);
            }

            // Keyboard listener for "you" input
            document.addEventListener("keydown", function (e) {
                if (isListeningForYou) {
                    const key = e.key.toLowerCase();
                    keySequence.push(key);

                    // Keep only last 5 characters to accommodate longer sequences
                    if (keySequence.length > 5) {
                        keySequence.shift();
                    }

                    const currentSequence = keySequence.join("");
                    
                    // Check for different input sequences
                    if (currentSequence === "you") {
                        // 'you' only requires Phoebe easter eggs to be triggered
                        const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                        if (allPhoebe) {
                            console.log(
                                "User typed 'you'! Triggering final Friends easter egg!",
                            );
                            clearTimeout(whoSingingTimer);
                            isListeningForYou = false;
                            keySequence = [];
                            triggerFinalFriendsEasterEgg();
                        } else {
                            console.log("❌ 'you' requires all Phoebe easter eggs to be triggered first!");
                            showEasterEggNotification(isEnglish ? "Need all Phoebe easter eggs first!" : "需要先触发所有Phoebe彩蛋！");
                        }
                    } else if (currentSequence.endsWith("me")) {
                        // 'me' requires ALL easter eggs to be triggered
                        const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                        const allOthers = cyberpunkEasterEggTriggered && zeldaEasterEggTriggered && runawayEasterEggTriggered && smellyCatEasterEggTriggered && roseQuoteEasterEggTriggered;
                        if (allPhoebe && allOthers) {
                            console.log(
                                "User typed 'me'! Playing when you...",
                            );
                            clearTimeout(whoSingingTimer);
                            isListeningForYou = false;
                            keySequence = [];
                            const whenyouAudioData = {
                                name: "When You",
                                src: "./phoebe/whenyou.mp3",
                                type: "Keyboard Response"
                            };
                            addAudioToPlaylist(whenyouAudioData);
                            showEasterEggNotification(isEnglish ? "Playing when you..." : "播放当你...");
                        } else {
                            console.log("❌ 'me' requires ALL easter eggs to be triggered first!");
                            showEasterEggNotification(isEnglish ? "Need ALL easter eggs first!" : "需要先触发所有彩蛋！");
                        }
                    } else if (currentSequence.endsWith("dance")) {
                        // 'dance' requires ALL easter eggs to be triggered
                        const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                        const allOthers = cyberpunkEasterEggTriggered && zeldaEasterEggTriggered && runawayEasterEggTriggered && smellyCatEasterEggTriggered && roseQuoteEasterEggTriggered;
                        if (allPhoebe && allOthers) {
                            console.log(
                                "User typed 'dance'! Playing dance music...",
                            );
                            clearTimeout(whoSingingTimer);
                            isListeningForYou = false;
                            keySequence = [];
                            const danceAudioData = {
                                name: "Dance",
                                src: "./phoebe/dance.mp3",
                                type: "Keyboard Response"
                            };
                            addAudioToPlaylist(danceAudioData);
                            showEasterEggNotification(isEnglish ? "Playing dance music..." : "播放舞曲...");
                        } else {
                            console.log("❌ 'dance' requires ALL easter eggs to be triggered first!");
                            showEasterEggNotification(isEnglish ? "Need ALL easter eggs first!" : "需要先触发所有彩蛋！");
                        }
                    } else if (currentSequence.endsWith("xiaop")) {
                        // 'xiaop' requires ALL easter eggs to be triggered
                        const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                        const allOthers = cyberpunkEasterEggTriggered && zeldaEasterEggTriggered && runawayEasterEggTriggered && smellyCatEasterEggTriggered && roseQuoteEasterEggTriggered;
                        if (allPhoebe && allOthers) {
                            console.log(
                                "User typed 'xiaop'! Playing tears I can't hold back...",
                            );
                            clearTimeout(whoSingingTimer);
                            isListeningForYou = false;
                            keySequence = [];
                            const tearsAudioData = {
                                name: "Tears",
                                src: "./phoebe/tears.mp3",
                                type: "Keyboard Response"
                            };
                            addAudioToPlaylist(tearsAudioData);
                            showEasterEggNotification(isEnglish ? "Playing tears I can't hold back..." : "播放眼泪止不住...");
                        } else {
                            console.log("❌ 'xiaop' requires ALL easter eggs to be triggered first!");
                            showEasterEggNotification(isEnglish ? "Need ALL easter eggs first!" : "需要先触发所有彩蛋！");
                        }
                    } else if (currentSequence.endsWith("peng")) {
                        // 'peng' requires ALL easter eggs to be triggered
                        const allPhoebe = Object.values(easterEggTriggered).every((state) => state);
                        const allOthers = cyberpunkEasterEggTriggered && zeldaEasterEggTriggered && runawayEasterEggTriggered && smellyCatEasterEggTriggered && roseQuoteEasterEggTriggered;
                        if (allPhoebe && allOthers) {
                            console.log(
                                "User typed 'peng'! Playing bad mood...",
                            );
                            clearTimeout(whoSingingTimer);
                            isListeningForYou = false;
                            keySequence = [];
                            const badmoodAudioData = {
                                name: "Bad Mood",
                                src: "./phoebe/badmood.mp3",
                                type: "Keyboard Response"
                            };
                            addAudioToPlaylist(badmoodAudioData);
                            showEasterEggNotification(isEnglish ? "Playing bad mood..." : "播放坏心情...");
                        } else {
                            console.log("❌ 'peng' requires ALL easter eggs to be triggered first!");
                            showEasterEggNotification(isEnglish ? "Need ALL easter eggs first!" : "需要先触发所有彩蛋！");
                        }
                    } else {
                        console.log(
                            "Current key sequence:",
                            currentSequence,
                        );
                    }
                }
            });

            // Keyboard listener for "rickrickrick", "picklerick" and konami code input
            document.addEventListener("keydown", function (e) {
                const key = e.key.toLowerCase();
                
                // Handle Konami Code sequence (上上下下左左右右baba)
                konamiSequence.push(e.code);
                
                // Keep only last 12 keys for konami sequence
                if (konamiSequence.length > 12) {
                    konamiSequence.shift();
                }
                
                // Clear timer if exists
                if (konamiTimer) {
                    clearTimeout(konamiTimer);
                }
                
                // Set timer to reset sequence after 3 seconds of inactivity
                konamiTimer = setTimeout(() => {
                    konamiSequence = [];
                    console.log("🎮 Konami sequence reset due to timeout");
                }, 3000);
                
                // Handle Debug Permission sequence (上上下下左右左右baba + peng)
                debugSequence.push(e.code);
                
                // Keep only last 16 keys for debug sequence
                if (debugSequence.length > 16) {
                    debugSequence.shift();
                }
                
                // Clear debug timer if exists
                if (debugTimer) {
                    clearTimeout(debugTimer);
                }
                
                // Set timer to reset debug sequence after 3 seconds of inactivity
                debugTimer = setTimeout(() => {
                    debugSequence = [];
                    console.log("🔧 Debug sequence reset due to timeout");
                }, 3000);
                
                // Check if debug permission sequence matches (上上下下左右左右baba + peng)
                if (debugSequence.length >= debugTarget.length) {
                    const lastKeys = debugSequence.slice(-debugTarget.length);
                    if (JSON.stringify(lastKeys) === JSON.stringify(debugTarget)) {
                        console.log("🔧 Debug Permission Code activated! Full debug access granted");
                        debugSequence = [];
                        
                        // 授予调试权限
                         debugPermission = true;
                        
                        // 显示调试按钮和面板
                        const debugToggle = document.getElementById('debugToggle');
                        const debugPanel = document.getElementById('debugPanel');
                        
                        // 显示调试按钮
                        debugToggle.classList.add('show');
                        
                        if (!debugPanelVisible) {
                            debugPanelVisible = true;
                            debugPanel.classList.add('show');
                            updateDebugInfo();
                        }
                        
                        showEasterEggNotification(
                            isEnglish 
                                ? "🔧 Debug Permission Granted! Full access unlocked" 
                                : "🔧 调试权限已授予！完全访问权限已解锁"
                        );
                        
                        return; // 跳过普通Konami代码检测
                    }
                }
                
                // Check if konami sequence matches
                if (konamiSequence.length >= konamiTarget.length) {
                    const lastKeys = konamiSequence.slice(-konamiTarget.length);
                    if (JSON.stringify(lastKeys) === JSON.stringify(konamiTarget)) {
                        console.log("🎮 Konami Code activated! Debug panel shown (no permission)");
                        konamiSequence = [];
                        
                        // 显示调试按钮和面板但不给权限
                        const debugToggle = document.getElementById('debugToggle');
                        const debugPanel = document.getElementById('debugPanel');
                        
                        // 显示调试按钮
                        debugToggle.classList.add('show');
                        
                        if (!debugPanelVisible) {
                            debugPanelVisible = true;
                            debugPanel.classList.add('show');
                            updateDebugInfo();
                        }
                        
                        showEasterEggNotification(
                            isEnglish 
                                ? "🎮 Debug Panel Unlocked! (No permission - use Morse code on Pickle Rick)" 
                                : "🎮 调试面板已解锁！（无权限 - 请在Pickle Rick上使用摩尔斯电码）"
                        );
                    }
                }
                
                console.log(`🎮 Konami progress: [${konamiSequence.map(code => code.replace('Arrow', '').replace('Key', '')).join(',')}]`);
                console.log(`🔧 Debug permission progress: [${debugSequence.map(code => code.replace('Arrow', '').replace('Key', '')).join(',')}]`);

                // Handle Rick portal sequence
                rickKeySequence.push(key);

                // Keep only last 12 characters for "rickrickrick"
                if (rickKeySequence.length > 12) {
                    rickKeySequence.shift();
                }

                // Check if "rickrickrick" was typed and not already triggered
                if (
                    rickKeySequence.join("") === "rickrickrick" &&
                    !rickPortalTriggered
                ) {
                    console.log(
                        "🎉 User typed 'rickrickrick'! Triggering Rick Portal!",
                    );
                    rickKeySequence = [];
                    rickPortalTriggered = true;
                    triggerRickPortal();
                } else {
                    console.log(
                        "Current rick sequence:",
                        rickKeySequence.join(""),
                    );
                }

                // Handle Pickle Rick sequence
                pickleRickKeySequence.push(key);

                // Keep only last 10 characters for "picklerick"
                if (pickleRickKeySequence.length > 10) {
                    pickleRickKeySequence.shift();
                }

                // Check if "picklerick" was typed and not already triggered
                if (
                    pickleRickKeySequence.join("") === "picklerick" &&
                    !pickleRickTriggered
                ) {
                    console.log(
                        "🥒 User typed 'picklerick'! Triggering Pickle Rick!",
                    );
                    pickleRickKeySequence = [];
                    pickleRickTriggered = true;
                    triggerPickleRick();
                } else {
                    console.log(
                        "Current pickle rick sequence:",
                        pickleRickKeySequence.join(""),
                    );
                }

                // Handle Wubba Lubba Dub Dub sequence
                wubbaKeySequence.push(key);

                // Keep only last 17 characters for "wubbalubbadubdub"
                if (wubbaKeySequence.length > 17) {
                    wubbaKeySequence.shift();
                }

                // Check if "wubbalubbadubdub" was typed
                if (wubbaKeySequence.join("") === "wubbalubbadubdub") {
                    console.log(
                        "🎵 User typed 'wubbalubbadubdub'! Playing random loser audio!",
                    );
                    wubbaKeySequence = [];
                    playRandomLoser();
                } else {
                    console.log(
                        "Current wubba sequence:",
                        wubbaKeySequence.join(""),
                    );
                }

                // Handle Language switching sequences
                languageKeySequence.push(key);

                // Keep only last 10 characters for language commands
                if (languageKeySequence.length > 10) {
                    languageKeySequence.shift();
                }

                const langSequence = languageKeySequence.join("");
                
                // Check for Chinese language triggers
                if (langSequence.includes("zh") || langSequence.includes("putonghua") || langSequence.includes("mandarin")|| langSequence.includes("cn")) {
                    if (!isEnglish) {
                        console.log("Language already set to Chinese");
                    } else {
                        console.log("Switching to Chinese language");
                        toggleLanguage();
                        showEasterEggNotification("语言已切换到中文");
                    }
                    languageKeySequence = [];
                }
                // Check for English language triggers
                else if (langSequence.includes("en") || langSequence.includes("ying")) {
                    if (isEnglish) {
                        console.log("Language already set to English");
                    } else {
                        console.log("Switching to English language");
                        toggleLanguage();
                        showEasterEggNotification("Language switched to English");
                    }
                    languageKeySequence = [];
                }

                // Handle Phoebe easter egg sequences
                phoebeKeySequence.push(key);

                // Keep only last 8 characters for phoebe commands
                if (phoebeKeySequence.length > 8) {
                    phoebeKeySequence.shift();
                }

                const phoebeSeq = phoebeKeySequence.join("");
                
                // Check for Phoebe triggers
                if (phoebeSeq.includes("phoebe") || phoebeSeq.includes("buffay") || phoebeSeq.includes("feebea")) {
                    // Check if keyboard Phoebe easter egg has reached its trigger limit (3 times)
                    if (easterEggTriggerCounts.phoebeKeyboard >= 3) {
                        console.log("Phoebe keyboard easter egg has reached maximum triggers (3/3)");
                        phoebeKeySequence = [];
                        return;
                    }
                    
                    console.log(`Phoebe easter egg triggered! Playing Phoebe audio (${easterEggTriggerCounts.phoebeKeyboard + 1}/3)`);
                    easterEggTriggerCounts.phoebeKeyboard++;
                    playAudio("im-phoebe-buffay-hi.mp3");
                    showEasterEggNotification(
                        isEnglish 
                            ? "I'm Phoebe Buffay, Hi!" 
                            : "嗨，我是菲比·布菲！"
                    );
                    phoebeKeySequence = [];
                }

                // Handle C137 sequence
                c137KeySequence.push(key);

                // Keep only last 4 characters for "c137"
                if (c137KeySequence.length > 4) {
                    c137KeySequence.shift();
                }

                // Check if "c137" was typed and not already triggered
                if (
                    c137KeySequence.join("") === "c137" &&
                    !c137Triggered
                ) {
                    // Check if picklerick easter egg has been triggered first
                    if (pickleRickTriggered) {
                        console.log(
                            "🎯 User typed 'c137'! Triggering C137 easter egg!",
                        );
                        c137KeySequence = [];
                        c137Triggered = true;
                        easterEggTriggerCounts.c137++;
                        triggerC137EasterEgg();
                    } else {
                        console.log(
                            "❌ 'c137' requires picklerick easter egg to be triggered first!",
                        );
                        showEasterEggNotification(
                            isEnglish 
                                ? "Need to trigger picklerick first!" 
                                : "需要先触发picklerick彩蛋！"
                        );
                        c137KeySequence = [];
                    }
                } else {
                    console.log(
                        "Current c137 sequence:",
                        c137KeySequence.join(""),
                    );
                }

                // Reset sequences after 5 seconds of inactivity
                if (rickKeyTimer) {
                    clearTimeout(rickKeyTimer);
                }
                rickKeyTimer = setTimeout(() => {
                    rickKeySequence = [];
                    pickleRickKeySequence = [];
                    wubbaKeySequence = [];
                    languageKeySequence = [];
                    phoebeKeySequence = [];
                    c137KeySequence = [];
                    console.log("Key sequences reset due to timeout");
                }, 5000);
            });

            function triggerFinalFriendsEasterEgg() {
                console.log(
                    "🎉 Triggering final Friends easter egg after 'you' input!",
                );
                // This triggers when user types "you" after "Who's singing?"
                // First show Smelly Cat content, then Friends typing effect
                showSmellyCatContent();
            }

            // Initialize easter egg system on page load
            window.addEventListener("load", function () {
                console.log("🎭 New Phoebe Easter Egg System Loaded!");
                console.log(
                    "🎮 Try triple-clicking various elements to discover easter eggs!",
                );
                console.log(
                    "🎯 Easter egg counters initialized:",
                    clickCounters,
                );
                console.log("📊 Easter egg states:", easterEggTriggered);

                // Check if elements exist
                const pengElements = document.querySelectorAll(".final-text");
                console.log(`🐧 Found ${pengElements.length} Peng elements`);

                const tributeElements = document.querySelectorAll(".tribute");
                console.log(
                    `💝 Found ${tributeElements.length} tribute elements`,
                );

                const essenceCards = document.querySelectorAll(".essence-card");
                console.log(`📝 Found ${essenceCards.length} essence cards`);

                const phoebeTitles = document.querySelectorAll(".phoebe-title");
                console.log(`👩 Found ${phoebeTitles.length} phoebe titles`);

                const colorCircle = document.querySelector(".color-circle");
                console.log(
                    `🎨 Found color circle:`,
                    colorCircle ? "Yes" : "No",
                );

                // Check if easter egg system was already initialized
                console.log(
                    "🔍 Easter egg events initialized:",
                    easterEggEventsInitialized,
                );
                console.log(
                    "🔍 Color circle event count:",
                    colorCircleEventCount,
                );

                // Only initialize if not already done
                if (!window.easterEggSystemInitialized) {
                    console.log(
                        "⚠️ Re-initializing easter egg events from load handler...",
                    );
                    initializeEasterEggEvents();
                }
            });

            function splitTextIntoLetters(element) {
                const text = element.textContent;
                if (!text || text.trim() === "") return;

                const letters = text.split("").map((char) => {
                    const span = document.createElement("span");
                    span.className = "letter-particle";
                    span.textContent = char === " " ? "\u00A0" : char; // Use non-breaking space
                    span.style.cssText = `
                        display: inline-block;
                        will-change: transform, opacity, filter;
                        transform-origin: center center;
                        backface-visibility: hidden;
                        transform: translateZ(0);
                    `;
                    return span;
                });

                // Clear original content and add letter spans
                element.textContent = "";
                letters.forEach((letter) => element.appendChild(letter));
            }

            // Function to play random loser audio
            function playRandomLoser() {
                const loserFiles = ['loser1.mp3', 'loser2.mp3', 'loser3.mp3', 'loser4.mp3', 'loser5.mp3', 'loser6.mp3'];
                const randomIndex = Math.floor(Math.random() * loserFiles.length);
                const selectedFile = loserFiles[randomIndex];
                console.log(`🎵 Playing random loser audio: ${selectedFile}`);
                playAudio(selectedFile);
            }

            function triggerRickPortal() {
                console.log("🎉 RICK PORTAL ACTIVATED! WUBBA LUBBA DUB DUB!");

                // Create portal at screen center, slightly above middle
                const portal = document.createElement("div");
                portal.className = "rick-portal";
                portal.style.left = "50%";
                portal.style.top = "45%"; // Slightly above center (was 50%)
                portal.style.transform = "translate(-50%, -50%)";
                portal.innerHTML = `
                    <img src="./phoebe/rickandmorty.png" alt="Rick Portal" />
                    <div class="rick-message" id="rickMessage"></div>
                `;

                document.body.appendChild(portal);

                setTimeout(() => {
                    portal.classList.add("show");
                }, 100);

                setTimeout(() => {
                    typeMessage(
                        "WUBBA LUBBA DUB DUB!",
                        document.getElementById("rickMessage"),
                        () => {
                            // Play audio after typing completes
                            playAudio("wubba-lubba.mp3");
                        },
                    );
                }, 2000);

                setTimeout(() => {
                    startAdvancedSuckingEffect();
                }, 8000); // Start sucking effect during portal expansion phase
            }

            function typeMessage(text, element, callback) {
                let index = 0;
                element.textContent = "";

                function typeChar() {
                    if (index < text.length) {
                        element.textContent += text.charAt(index);
                        index++;
                        setTimeout(typeChar, 100 + Math.random() * 100);
                    } else if (callback) {
                        // Call callback after typing is complete
                        setTimeout(callback, 500);
                    }
                }
                typeChar();
            }

            function startAdvancedSuckingEffect() {
                // Get portal position (screen center, slightly above middle)
                const portalCenterX = window.innerWidth / 2;
                const portalCenterY = window.innerHeight * 0.45; // Match portal position

                // Split all text elements into letters first
                const textElements = document.querySelectorAll(
                    "h1, h2, h3, h4, h5, h6, p, span:not(.letter-particle):not(.rick-portal *), div:not(.rick-portal):not(.rick-portal *):not(.final-background), a, button, label, li, td, th, blockquote, em, strong, i, b, u, small, code, pre",
                );

                textElements.forEach((element) => {
                    if (
                        element.textContent.trim() &&
                        !element.querySelector(".letter-particle") &&
                        !element.closest(".rick-portal") &&
                        element.children.length === 0 // Only split leaf text elements
                    ) {
                        splitTextIntoLetters(element);
                    }
                });

                // Get all letters and calculate distances from portal center
                const letters = Array.from(
                    document.querySelectorAll(".letter-particle"),
                );
                const letterDistances = letters.map((letter) => {
                    const rect = letter.getBoundingClientRect();
                    const letterCenterX = rect.left + rect.width / 2;
                    const letterCenterY = rect.top + rect.height / 2;
                    const distance = Math.sqrt(
                        Math.pow(portalCenterX - letterCenterX, 2) +
                            Math.pow(portalCenterY - letterCenterY, 2),
                    );
                    return {
                        element: letter,
                        distance,
                        x: letterCenterX,
                        y: letterCenterY,
                    };
                });

                // Sort by distance (nearest first)
                letterDistances.sort((a, b) => a.distance - b.distance);

                // Animate letters with progressive acceleration based on distance
                letterDistances.forEach((letterData, index) => {
                    const letter = letterData.element;
                    const dx = portalCenterX - letterData.x;
                    const dy = portalCenterY - letterData.y;
                    const distance = letterData.distance;

                    // Distance-based timing: closer letters start sooner, but much slower progression
                    const distanceRatio =
                        distance /
                        Math.max(...letterDistances.map((l) => l.distance));
                    const baseDelay = distanceRatio * 1500; // Slower start, max 1500ms delay

                    // Slow start with gradual acceleration
                    const progressRatio = index / letterDistances.length;
                    const accelerationFactor = 0.3 + progressRatio * 1.2; // Start very slow
                    const baseDuration = 5; // Longer base duration for slower effect
                    const duration = Math.max(
                        2,
                        baseDuration / accelerationFactor,
                    );

                    // Distance-based rotation intensity - gentler at start
                    const rotationIntensity = 0.3 + distanceRatio * 1.2;
                    const rotation =
                        (Math.random() * 2 - 1) * rotationIntensity;

                    // Apply optimized styles
                    letter.style.cssText += `
                        --dx: ${dx}px;
                        --dy: ${dy}px;
                        --rotation: ${rotation};
                        --duration: ${duration}s;
                        --delay: ${baseDelay}ms;
                    `;

                    setTimeout(() => {
                        letter.classList.add("letter-exploding");
                    }, baseDelay);
                });

                // Get other elements and sort by distance
                const otherElements = Array.from(
                    document.querySelectorAll(
                        "div:not(.rick-portal):not(.rick-portal *):not(.final-background), img:not(.rick-portal *), svg:not(.rick-portal *), canvas:not(.rick-portal *), video:not(.rick-portal *), audio:not(.rick-portal *), input:not(.rick-portal *), textarea:not(.rick-portal *), select:not(.rick-portal *), form:not(.rick-portal *), table:not(.rick-portal *), section:not(.rick-portal *), article:not(.rick-portal *), aside:not(.rick-portal *), nav:not(.rick-portal *), header:not(.rick-portal *), footer:not(.rick-portal *), main:not(.rick-portal *)",
                    ),
                );

                const elementDistances = otherElements
                    .filter((element) => {
                        // Include elements that have letter particles (already processed text elements)
                        // or elements that are visible and have some content
                        const hasLetterParticles =
                            element.querySelector(".letter-particle");
                        const hasVisibleContent =
                            element.offsetWidth > 0 && element.offsetHeight > 0;
                        const isNotBodyOrHtml =
                            element.tagName !== "BODY" &&
                            element.tagName !== "HTML";
                        const isNotScript =
                            element.tagName !== "SCRIPT" &&
                            element.tagName !== "STYLE";

                        return (
                            (hasLetterParticles || hasVisibleContent) &&
                            isNotBodyOrHtml &&
                            isNotScript
                        );
                    })
                    .map((element) => {
                        const rect = element.getBoundingClientRect();
                        const elementCenterX = rect.left + rect.width / 2;
                        const elementCenterY = rect.top + rect.height / 2;
                        const distance = Math.sqrt(
                            Math.pow(portalCenterX - elementCenterX, 2) +
                                Math.pow(portalCenterY - elementCenterY, 2),
                        );
                        return {
                            element,
                            distance,
                            x: elementCenterX,
                            y: elementCenterY,
                        };
                    });

                // Sort elements by distance (nearest first)
                elementDistances.sort((a, b) => a.distance - b.distance);

                // Animate elements with distance-based timing and 3D effects
                elementDistances.forEach((elementData, index) => {
                    const element = elementData.element;
                    const dx = portalCenterX - elementData.x;
                    const dy = portalCenterY - elementData.y;
                    const distance = elementData.distance;

                    // Elements start after letters finish (around 3-6 seconds)
                    const distanceRatio =
                        distance /
                        Math.max(...elementDistances.map((e) => e.distance));
                    const letterFinishTime = 4000; // Wait for letters to mostly finish
                    const baseDelay = letterFinishTime + distanceRatio * 800; // Start after letters

                    // Slower, more dramatic element animation
                    const accelerationFactor = 0.8 + (1 - distanceRatio) * 1;
                    const baseDuration = 4.5; // Longer duration for element warping
                    const duration = Math.max(
                        3,
                        baseDuration / accelerationFactor,
                    );

                    // Moderate rotation for smooth border warping
                    const rotationIntensity = 0.8 + distanceRatio * 1.5;
                    const rotation =
                        (Math.random() * 2 - 1) * rotationIntensity;

                    // Apply performance optimized styles for border warping
                    element.style.cssText += `
                        will-change: transform, opacity, border-radius, clip-path, filter;
                        transform-origin: center center;
                        backface-visibility: hidden;
                        --dx: ${dx}px;
                        --dy: ${dy}px;
                        --rotation: ${rotation};
                        --duration: ${duration}s;
                        --delay: ${baseDelay}ms;
                    `;

                    setTimeout(() => {
                        element.classList.add("element-sucking");
                    }, baseDelay);
                });

                // Show final background after all elements are absorbed (much longer timing)
                setTimeout(() => {
                    // Hide scrollbars
                    document.body.classList.add("portal-mode");
                    document.documentElement.classList.add("portal-mode");

                    const finalBg = document.createElement("div");
                    finalBg.className = "final-background";
                    document.body.appendChild(finalBg);

                    setTimeout(() => {
                        finalBg.classList.add("show");
                    }, 200);

                    setTimeout(() => {
                        if (document.querySelector(".rick-portal")) {
                            document.querySelector(".rick-portal").remove();
                        }
                    }, 21000); // Remove portal after animation completes (20s + 1s buffer)
                }, 22000); // Extended total duration to accommodate 20s portal animation
            }

            function triggerPickleRick() {
                console.log("🥒 PICKLE RICK ACTIVATED!");

                // First show central text display
                showPickleRickText();

                // Then create persistent Pickle Rick in bottom left after delay
                setTimeout(() => {
                    createPersistentPickleRick();
                }, 3000);
            }

            function triggerC137EasterEgg() {
                console.log("🎯 C137 EASTER EGG ACTIVATED!");
                
                // Show C137 fullscreen text first
                showC137Text();
                
                // Show notification after fullscreen text (3.3s = 2.5s display + 0.8s fadeout)
                setTimeout(() => {
                    showEasterEggNotification(
                        isEnglish
                            ? "Welcome to dimension C-137!"
                            : "欢迎来到C-137维度！"
                    );
                }, 3300);
                
                try {
                    // Initialize audio system if not already done
                    if (!cyberpunkAudio) {
                        initializeAudioSystem();
                    }
                    
                    // Add whoisthebest.mp3 to playlist
                    const c137AudioData = {
                        name: "Who Is The Best",
                        src: "./phoebe/whoisthebest.mp3",
                        type: "C-137 Dimension"
                    };
                    addAudioToPlaylist(c137AudioData);
                    
                    console.log("✅ whoisthebest.mp3 added to playlist successfully!");
                    console.log("🎯 C137 easter egg triggered!");
                } catch (error) {
                    console.log('❌ Failed to add whoisthebest.mp3 to playlist:', error);
                }
                
                
            }
            
            function showC137Text() {
                // Create fullscreen overlay for C137 text
                const overlay = document.createElement("div");
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: #000000;
                    z-index: 15000;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                    justify-content: center;
                    animation: fadeIn 0.8s ease-out;
                `;

                // Create the main text container
                const textContainer = document.createElement("div");
                const isMobile = window.innerWidth <= 768;
                textContainer.style.cssText = `
                    text-align: center;
                    position: relative;
                    padding: ${isMobile ? "20px" : "40px"};
                    transform: rotate(-5deg);
                `;

                // Create C137 text
                const c137Text = document.createElement("div");
                c137Text.style.cssText = `
                    font-family: 'Arial Black', sans-serif;
                    font-size: ${isMobile ? "clamp(3rem, 15vw, 6rem)" : "clamp(4rem, 10vw, 10rem)"};
                    font-weight: 900;
                    color: #FFFFFF;
                    text-transform: uppercase;
                    letter-spacing: ${isMobile ? "0.1em" : "0.15em"};
                    margin-bottom: ${isMobile ? "20px" : "30px"};
                    overflow: hidden;
                    white-space: nowrap;
                `;

                // Create second line text
                const secondText = document.createElement("div");
                secondText.style.cssText = `
                    font-family: 'Arial Black', sans-serif;
                    font-size: ${isMobile ? "clamp(1.5rem, 8vw, 3rem)" : "clamp(2rem, 5vw, 5rem)"};
                    font-weight: 700;
                    color: #FFFFFF;
                    letter-spacing: ${isMobile ? "0.05em" : "0.1em"};
                    overflow: hidden;
                    white-space: nowrap;
                `;

                textContainer.appendChild(c137Text);
                textContainer.appendChild(secondText);
                overlay.appendChild(textContainer);
                document.body.appendChild(overlay);

                // Typewriter effect for C137
                const c137FullText = "C137";
                let c137Index = 0;
                c137Text.textContent = "";
                
                const c137TypeWriter = () => {
                    if (c137Index < c137FullText.length) {
                        c137Text.textContent += c137FullText.charAt(c137Index);
                        c137Index++;
                        setTimeout(c137TypeWriter, 150);
                    } else {
                        // Start second text after C137 is complete
                        setTimeout(startSecondText, 300);
                    }
                };

                // Typewriter effect for second text
                const secondFullText = "怎么可能被干掉";
                let secondIndex = 0;
                secondText.textContent = "";
                
                const startSecondText = () => {
                    const secondTypeWriter = () => {
                        if (secondIndex < secondFullText.length) {
                            secondText.textContent += secondFullText.charAt(secondIndex);
                            secondIndex++;
                            setTimeout(secondTypeWriter, 160);
                        }
                    };
                    secondTypeWriter();
                };

                // Start typewriter effect
                setTimeout(c137TypeWriter, 500);

                // Remove after 2.5 seconds with fade out (extended time for typewriter effect)
                setTimeout(() => {
                    overlay.style.animation = "fadeOut 0.8s ease-out forwards";
                    setTimeout(() => {
                        if (document.body.contains(overlay)) {
                            document.body.removeChild(overlay);
                        }
                    }, 800);
                }, 2500);
            }
            
            function showPickleRickText() {
                // Create fullscreen overlay for Pickle Rick text
                const overlay = document.createElement("div");
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100vw;
                    height: 100vh;
                    background: rgba(0, 0, 0, 0.8);
                    z-index: 15000;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    animation: fadeIn 0.5s ease-out;
                `;

                // Create the main text element
                const textElement = document.createElement("div");
                const isMobile = window.innerWidth <= 768;
                textElement.style.cssText = `
                    font-family: Arial Black, sans-serif;
                    font-size: ${isMobile ? "clamp(2rem, 12vw, 4rem)" : "clamp(3rem, 8vw, 8rem)"};
                    font-weight: 900;
                    color: #4CAF50;
                    text-align: center;
                    text-transform: uppercase;
                    letter-spacing: ${isMobile ? "0.05em" : "0.1em"};
                    transform: rotate(-8deg) skew(-5deg, 0deg);
                    text-shadow:
                        ${isMobile ? "2px 2px 0px #2E7D32, 4px 4px 0px #1B5E20, 6px 6px 0px #0D4E14, 8px 8px 15px rgba(0,0,0,0.4)" : "4px 4px 0px #2E7D32, 8px 8px 0px #1B5E20, 12px 12px 0px #0D4E14, 16px 16px 20px rgba(0,0,0,0.4)"};
                    background: linear-gradient(45deg, #66BB6A 0%, #4CAF50 50%, #388E3C 100%);
                    -webkit-background-clip: text;
                    -webkit-text-fill-color: transparent;
                    background-clip: text;
                    animation: pickleTextGlow 2s ease-in-out infinite alternate;
                    position: relative;
                    padding: ${isMobile ? "10px" : "20px"};
                `;
                textElement.textContent = "I'M PICKLE RICK!";

                // Add background decoration with diagonal stripes
                const decoration = document.createElement("div");
                decoration.style.cssText = `
                    position: absolute;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%) rotate(-8deg);
                    width: 120%;
                    height: 150%;
                    background:
                        repeating-linear-gradient(
                            45deg,
                            rgba(76, 175, 80, 0.8) 0px,
                            rgba(76, 175, 80, 0.8) ${isMobile ? "10px" : "15px"},
                            rgba(129, 199, 132, 0.6) ${isMobile ? "10px" : "15px"},
                            rgba(129, 199, 132, 0.6) ${isMobile ? "20px" : "30px"},
                            rgba(46, 125, 50, 0.7) ${isMobile ? "20px" : "30px"},
                            rgba(46, 125, 50, 0.7) ${isMobile ? "30px" : "45px"}
                        ),
                        linear-gradient(135deg,
                            rgba(76, 175, 80, 0.2) 0%,
                            rgba(129, 199, 132, 0.3) 50%,
                            rgba(46, 125, 50, 0.2) 100%);
                    border: ${isMobile ? "4px" : "6px"} solid #4CAF50;
                    border-radius: ${isMobile ? "15px" : "25px"};
                    z-index: -1;
                    box-shadow:
                        0 0 40px rgba(76, 175, 80, 0.6),
                        inset 0 0 40px rgba(76, 175, 80, 0.2),
                        0 0 80px rgba(76, 175, 80, 0.3);
                `;

                // Add diagonal accent stripes
                for (let i = 0; i < 4; i++) {
                    const stripe = document.createElement("div");
                    stripe.style.cssText = `
                        position: absolute;
                        top: ${-20 + i * 25}%;
                        left: ${-30 + i * 20}%;
                        width: 200%;
                        height: ${isMobile ? "5px" : "8px"};
                        background: linear-gradient(90deg,
                            transparent 0%,
                            rgba(76, 175, 80, 0.8) 20%,
                            rgba(129, 199, 132, 1) 50%,
                            rgba(76, 175, 80, 0.8) 80%,
                            transparent 100%);
                        transform: rotate(${-15 + i * 5}deg);
                        z-index: -1;
                        animation: stripeGlow ${1.5 + i * 0.3}s ease-in-out infinite alternate;
                    `;
                    decoration.appendChild(stripe);
                }

                // Add CSS for the glow and stripe animations
                if (!document.getElementById("pickleTextGlowStyle")) {
                    const glowStyle = document.createElement("style");
                    glowStyle.id = "pickleTextGlowStyle";
                    glowStyle.textContent = `
                        @keyframes pickleTextGlow {
                            0% {
                                filter: brightness(1) drop-shadow(0 0 10px rgba(76, 175, 80, 0.5));
                                transform: rotate(-8deg) skew(-5deg, 0deg) scale(1);
                            }
                            100% {
                                filter: brightness(1.2) drop-shadow(0 0 25px rgba(76, 175, 80, 0.8));
                                transform: rotate(-8deg) skew(-5deg, 0deg) scale(1.02);
                            }
                        }
                        @keyframes stripeGlow {
                            0% {
                                opacity: 0.6;
                                transform: rotate(var(--rotation, 0deg)) scaleX(0.8);
                            }
                            100% {
                                opacity: 1;
                                transform: rotate(var(--rotation, 0deg)) scaleX(1.2);
                            }
                        }
                    `;
                    document.head.appendChild(glowStyle);
                }

                textElement.appendChild(decoration);
                overlay.appendChild(textElement);
                document.body.appendChild(overlay);

                // Play audio immediately
                playAudio("picklerick.mp3");

                // Remove after 2.5 seconds with fade out
                setTimeout(() => {
                    overlay.style.animation = "fadeOut 0.5s ease-out forwards";
                    setTimeout(() => {
                        if (document.body.contains(overlay)) {
                            document.body.removeChild(overlay);
                        }
                    }, 500);
                }, 2500);
            }

            function createPersistentPickleRick() {
                // Create persistent Pickle Rick in bottom right
                const pickleRick = document.createElement("div");
                pickleRick.id = "pickle-rick";
                pickleRick.style.cssText = `
                    position: fixed;
                    bottom: 20px;
                    left: 20px;
                    width: 80px;
                    height: 80px;
                    z-index: 10000;
                    cursor: pointer;
                    transition: transform 0.2s ease;
                `;

                const pickleImg = document.createElement("img");
                pickleImg.src = "./phoebe/picklerick.png";
                pickleImg.alt = "Pickle Rick";
                pickleImg.style.cssText = `
                    width: 100%;
                    height: 100%;
                    object-fit: contain;
                `;

                pickleRick.appendChild(pickleImg);
                document.body.appendChild(pickleRick);

                // Add hover effect
                pickleRick.addEventListener("mouseenter", () => {
                    pickleRick.style.transform = "scale(1.1) rotate(5deg)";
                });

                pickleRick.addEventListener("mouseleave", () => {
                    pickleRick.style.transform = "scale(1) rotate(0deg)";
                });

                // 摩尔斯电码检测事件
                pickleRick.addEventListener("mousedown", (e) => {
                    e.preventDefault();
                    pressStartTime = Date.now();
                    console.log("🥒 Pickle Rick mousedown");
                });
                
                pickleRick.addEventListener("mouseup", (e) => {
                    e.preventDefault();
                    const pressDuration = Date.now() - pressStartTime;
                    const isLongPress = pressDuration > 200; // 长按超过200ms为划(-)
                    const morseSymbol = isLongPress ? '-' : '.';
                    
                    console.log(`🥒 Pickle Rick ${isLongPress ? 'long' : 'short'} press: ${morseSymbol}`);
                    
                    // 添加到当前字符
                    currentMorseChar.push(morseSymbol);
                    
                    // 清除之前的定时器
                    if (morseTimer) {
                        clearTimeout(morseTimer);
                    }
                    
                    // 设置新的定时器，800ms后认为字符结束
                    morseTimer = setTimeout(() => {
                        processMorseCharacter();
                    }, 800);
                    
                    // 视觉反馈
                    pickleRick.style.transform = "scale(0.95) rotate(-5deg)";
                    setTimeout(() => {
                        pickleRick.style.transform = "scale(1.1) rotate(5deg)";
                    }, 150);
                    
                    // 播放音频
                    playAudio("picklerick.mp3");
                });
                
                // 防止拖拽
                pickleRick.addEventListener("dragstart", (e) => {
                    e.preventDefault();
                });

                // Audio is already played in showPickleRickText()
            }
            
            // 摩尔斯电码处理函数
            function processMorseCharacter() {
                const morseChar = currentMorseChar.join('');
                console.log(`🔤 Morse character completed: ${morseChar}`);
                
                // 检查是否匹配目标序列中的当前字符
                if (morseChar === targetMorseSequence[morseProgress]) {
                    morseProgress++;
                    console.log(`✅ Morse progress: ${morseProgress}/${targetMorseSequence.length}`);
                    
                    // 检查是否完成整个序列
                    if (morseProgress >= targetMorseSequence.length) {
                        console.log("🎉 Morse code sequence completed! Debug permission granted!");
                        debugPermission = true;
                        
                        // 显示调试按钮和面板，并给予权限
                        const debugToggle = document.getElementById('debugToggle');
                        const debugPanel = document.getElementById('debugPanel');
                        
                        // 显示调试按钮
                        debugToggle.classList.add('show');
                        
                        // 如果面板还没显示，则显示面板
                        if (!debugPanelVisible) {
                            debugPanelVisible = true;
                            debugPanel.classList.add('show');
                            updateDebugInfo();
                        }
                        
                        showEasterEggNotification(
                            isEnglish 
                                ? "🔓 Debug Permission Granted! Morse code: C-1-3-7" 
                                : "🔓 调试权限已获得！摩尔斯电码：C-1-3-7"
                        );
                        // 重置序列
                        morseProgress = 0;
                        morseSequence = [];
                    }
                } else {
                    // 重置序列
                    console.log(`❌ Wrong morse character. Expected: ${targetMorseSequence[morseProgress]}, Got: ${morseChar}`);
                    morseProgress = 0;
                    morseSequence = [];
                }
                
                // 清空当前字符
                currentMorseChar = [];
            }
            
            // Quick set functions for debug panel
            function setCyberpunkContent() {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                console.log("🤖 Setting all cards to Cyberpunk Edgerunners content...");
                
                // Find the index of the Cyberpunk Edgerunner quote
                const activeQuotes = isEnglish ? quotes.english : quotes.chinese;
                const targetText = isEnglish 
                    ? "You're a natural-born Edgerunner."
                    : "你是个天生的边缘行者";
                
                let targetIndex = -1;
                for (let i = 0; i < activeQuotes.length; i++) {
                    const quoteText = isEnglish ? activeQuotes[i].en : activeQuotes[i].zh;
                    if (quoteText === targetText) {
                        targetIndex = i;
                        break;
                    }
                }
                
                if (targetIndex !== -1) {
                    // Set all three cards to the target quote
                    for (let cardIndex = 0; cardIndex < 3; cardIndex++) {
                        setSpecificQuote(cardIndex, targetIndex);
                    }
                    console.log("✅ All cards set to Cyberpunk content!");
                } else {
                    console.log("❌ Cyberpunk quote not found!");
                }
            }
            
            function setRoseContent() {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                console.log("🌹 Setting all cards to Little Prince rose content...");
                
                // Find the index of the Little Prince rose quote
                const activeQuotes = isEnglish ? quotes.english : quotes.chinese;
                const targetText = isEnglish 
                    ? "It is the time you have wasted for your rose that makes your rose so important"
                    : "正是你为你的玫瑰花费的时光使你的玫瑰变得如此重要";
                
                let targetIndex = -1;
                for (let i = 0; i < activeQuotes.length; i++) {
                    const quoteText = isEnglish ? activeQuotes[i].en : activeQuotes[i].zh;
                    if (quoteText === targetText) {
                        targetIndex = i;
                        break;
                    }
                }
                
                if (targetIndex !== -1) {
                    // Set all three cards to the target quote
                    for (let cardIndex = 0; cardIndex < 3; cardIndex++) {
                        setSpecificQuote(cardIndex, targetIndex);
                    }
                    console.log("✅ All cards set to Rose quote content!");
                } else {
                    console.log("❌ Rose quote not found!");
                }
            }
            
            function triggerRunawayEffect() {
                if (!debugPermission) {
                    showEasterEggNotification(
                        isEnglish 
                            ? "❌ No permission! Use Morse code on Pickle Rick first." 
                            : "❌ 无权限！请先在Pickle Rick上使用摩尔斯电码。"
                    );
                    return;
                }
                
                console.log("🎹 Triggering Runaway effect directly...");
                
                try {
                    const runawayAudioData = {
                        name: "Runaway",
                        src: "./phoebe/runaway1.mp3",
                        type: "Piano Sequence Reward"
                    };
                    addAudioToPlaylist(runawayAudioData);
                    runawayEasterEggTriggered = true;
                    
                    // Change content when runaway easter egg is triggered
                    changeToRunawayContent();
                    
                    console.log("✅ Runaway added to playlist successfully!");
                    console.log("🎹 Runaway easter egg triggered!");
                } catch (error) {
                    console.log('❌ Failed to add runaway1.mp3 to playlist:', error);
                }
            }
            
            function changeToRunawayContent() {
                console.log("🎵 Changing content to Runaway mode...");
                
                // Change Phoebe's Wisdom to Donda's Wisdom for English content
                const englishPhoebeTitle = document.querySelector('#englishContent .phoebe-title');
                const englishPhoebeQuote = document.querySelector('#englishContent .phoebe-quote');
                
                if (englishPhoebeTitle && englishPhoebeQuote) {
                    englishPhoebeTitle.textContent = "Donda's Wisdom";
                    englishPhoebeQuote.innerHTML = `
                        "… you got a lot of confidence that come off a little arrogant even though you're humble and everything –– but it be important to remember that the giant looks himself in the mirror and sees nothing…"
                    `;
                }
                
                // Change Chinese Phoebe section
                const chinesePhoebeTitle = document.querySelector('#chineseContent .phoebe-title');
                const chinesePhoebeQuote = document.querySelector('#chineseContent .phoebe-quote');
                
                if (chinesePhoebeTitle && chinesePhoebeQuote) {
                    chinesePhoebeTitle.textContent = "Donda的智慧";
                    chinesePhoebeQuote.innerHTML = `
                        "你有很多的自信，这让你看起来有点傲慢，虽然你很谦虚。但重要的是要记住，巨人照镜子时什么也看不到。"<br />
                        "… you got a lot of confidence that come off a little arrogant even though you're humble and everything –– but it be important to remember that the giant looks himself in the mirror and sees nothing…"
                    `;
                }
                
                // Change meditation content for English page
                const englishMeditationText = document.querySelector('#englishContent .meditation-text');
                if (englishMeditationText) {
                    englishMeditationText.innerHTML = `
                        And I always find, yeah, I always find somethin' wrong<br />
                        You been puttin' up wit' my shit just way too long<br />
                        I'm so gifted at findin' what I don't like the most<br />
                        So I think it's time for us to have a toast<br />
                        Let's have a toast for the douchebags,<br />
                        Let's have a toast for the assholes<br />
                        Let's have a toast for the scumbags,<br />
                        Every one of them that I know<br />
                        Let's have a toast to the jerkoffs<br />
                        That'll never take work off<br />
                        Baby, I got a plan<br />
                        Run away fast as you can
                    `;
                }
                
                // Change meditation content for Chinese page
                const chineseMeditationText = document.querySelector('#chineseContent .meditation-text');
                if (chineseMeditationText) {
                    chineseMeditationText.innerHTML = `
                        And I always find, yeah, I always find somethin' wrong<br />
                        我总能发现，我总是发现不对劲的事<br />
                        You been puttin' up wit' my shit just way too long<br />
                        你忍受我的胡闹已经太久了<br />
                        I'm so gifted at findin' what I don't like the most<br />
                        我的天赋就是发现自己讨厌什么<br />
                        So I think it's time for us to have a toast<br />
                        所以我觉得,是时候为我们干杯了<br />
                        Let's have a toast for the douchebags,<br />
                        让我们为那些混蛋干杯<br />
                        Let's have a toast for the assholes<br />
                        让我们为那些王八蛋干杯<br />
                        Let's have a toast for the scumbags,<br />
                        让我们为那些人渣干杯<br />
                        Every one of them that I know<br />
                        致每一个他们<br />
                        Let's have a toast to the jerkoffs<br />
                        让我们为那些混球干杯<br />
                        That'll never take work off<br />
                        那些永远都不会奏效<br />
                        Baby, I got a plan<br />
                        宝贝，我有一个计划<br />
                        Run away fast as you can
                        尽你所能快速逃离
                    `;
                }
                
                // Setup audio event listener to trigger LOOK AT YOU effect after 3 seconds delay
                setupRunawayAudioListener();
                
                // Remove all Zima Blue squares
                removeAllZimaBlueSquares();
                
                console.log("✅ Content changed to Runaway mode!");
            }
            
            function setupRunawayAudioListener() {
                console.log("🎵 Setting up Runaway audio listener for LOOK AT YOU effect...");
                
                // Get the audio element
                const audioElement = document.getElementById('cyberpunkAudio');
                if (!audioElement) {
                    console.log("❌ Audio element not found, triggering LOOK AT YOU effect immediately");
                    triggerLookAtYouEffect();
                    return;
                }
                
                // Function to handle audio play event
                const handleAudioPlay = () => {
                    console.log("🎵 Runaway audio started playing, will trigger LOOK AT YOU effect in 3 seconds...");
                    
                    // Remove the event listener to avoid multiple triggers
                    audioElement.removeEventListener('play', handleAudioPlay);
                    
                    // Trigger LOOK AT YOU effect after 3 seconds delay
                    setTimeout(() => {
                        console.log("👀 3 seconds passed, triggering LOOK AT YOU effect now!");
                        triggerLookAtYouEffect();
                    }, 3000);
                };
                
                // Check if audio is already playing
                if (!audioElement.paused && audioElement.currentTime > 0) {
                    console.log("🎵 Audio is already playing, triggering LOOK AT YOU effect in 3 seconds...");
                    setTimeout(() => {
                        console.log("👀 3 seconds passed, triggering LOOK AT YOU effect now!");
                        triggerLookAtYouEffect();
                    }, 3000);
                } else {
                    // Add event listener for when audio starts playing
                    audioElement.addEventListener('play', handleAudioPlay);
                    console.log("🎵 Audio listener added, waiting for runaway1.mp3 to start playing...");
                }
            }
            
            function triggerLookAtYouEffect() {
                console.log("👀 Starting LOOK AT YOU! effect...");
                
                let textCount = 0;
                const maxTexts = 42;
                const interval = 300; // 0.3 seconds
                const textElements = [];
                
                // Function to remove all LOOK AT YOU texts
                const removeAllLookAtYouTexts = () => {
                    textElements.forEach(element => {
                        if (document.body.contains(element)) {
                            element.style.transition = "opacity 0.5s ease-out";
                            element.style.opacity = "0";
                            setTimeout(() => {
                                if (document.body.contains(element)) {
                                    document.body.removeChild(element);
                                }
                            }, 500);
                        }
                    });
                    textElements.length = 0; // Clear the array
                };
                
                // Set up midnight auto-removal
                const setupMidnightRemoval = () => {
                    const now = new Date();
                    const midnight = new Date();
                    midnight.setHours(24, 0, 0, 0); // Next midnight
                    const timeToMidnight = midnight.getTime() - now.getTime();
                    
                    setTimeout(() => {
                        console.log("🕛 Midnight reached, removing all LOOK AT YOU texts...");
                        removeAllLookAtYouTexts();
                    }, timeToMidnight);
                };
                
                const showLookAtYouText = () => {
                    if (textCount >= maxTexts) {
                        console.log("👀 All LOOK AT YOU! texts displayed, starting fade out...");
                        // Start fade out all texts together
                        textElements.forEach((element, index) => {
                            setTimeout(() => {
                                if (document.body.contains(element)) {
                                    element.style.transition = "opacity 2s ease-out";
                                    element.style.opacity = "0";
                                    setTimeout(() => {
                                        if (document.body.contains(element)) {
                                            document.body.removeChild(element);
                                        }
                                    }, 2000);
                                }
                            }, index * 100); // Stagger the fade out slightly
                        });
                        console.log("👀 LOOK AT YOU! effect completed!");
                        return;
                    }
                    
                    // Create random positioned text
                    const lookAtYouText = document.createElement("div");
                    
                    // Responsive design for different screen sizes
                    const isMobile = window.innerWidth <= 768;
                    const isSmallMobile = window.innerWidth <= 480;
                    
                    // Responsive margins and positioning
                    const marginX = isSmallMobile ? 30 : isMobile ? 40 : 50;
                    const marginY = isSmallMobile ? 40 : isMobile ? 50 : 50;
                    const maxWidth = window.innerWidth - (marginX * 2);
                    const maxHeight = window.innerHeight - (marginY * 2);
                    
                    // Weighted random position - favor top, left, and right areas
                    let randomX, randomY;
                    
                    // Generate weighted random position
                    const positionType = Math.random();
                    
                    if (positionType < 0.4) {
                        // 40% chance: Top area (upper 30% of screen)
                        randomX = Math.random() * (maxWidth - 100) + marginX;
                        randomY = Math.random() * (maxHeight * 0.3) + marginY;
                    } else if (positionType < 0.7) {
                        // 30% chance: Left area (left 35% of screen)
                        randomX = Math.random() * (maxWidth * 0.35) + marginX;
                        randomY = Math.random() * (maxHeight - 60) + marginY;
                    } else if (positionType < 0.9) {
                        // 20% chance: Right area (right 35% of screen)
                        randomX = Math.random() * (maxWidth * 0.35) + (maxWidth * 0.65) + marginX;
                        randomY = Math.random() * (maxHeight - 60) + marginY;
                    } else {
                        // 10% chance: Anywhere else (for variety)
                        randomX = Math.random() * (maxWidth - 100) + marginX;
                        randomY = Math.random() * (maxHeight - 60) + marginY;
                    }
                    
                    // Responsive font size
                    let minSize, maxSize;
                    if (isSmallMobile) {
                        minSize = 20;
                        maxSize = 60;
                    } else if (isMobile) {
                        minSize = 30;
                        maxSize = 100;
                    } else {
                        minSize = 40;
                        maxSize = 160;
                    }
                    const randomSize = Math.random() * (maxSize - minSize) + minSize;
                    
                    // Random rotation between -45 and 45 degrees
                    const randomRotation = (Math.random() - 0.5) * 90;
                    
                    // Responsive text shadow
                    const textShadow = isSmallMobile 
                        ? "1px 1px 2px rgba(0,0,0,0.8), 0 0 5px rgba(255,255,255,0.3)"
                        : isMobile 
                        ? "2px 2px 3px rgba(0,0,0,0.8), 0 0 8px rgba(255,255,255,0.3)"
                        : "2px 2px 4px rgba(0,0,0,0.8), 0 0 10px rgba(255,255,255,0.3)";
                    
                    lookAtYouText.style.cssText = `
                        position: fixed;
                        left: ${randomX}px;
                        top: ${randomY}px;
                        color: white;
                        font-family: "Impact", "Arial Black", sans-serif;
                        font-size: ${randomSize}px;
                        font-weight: 900;
                        text-shadow: ${textShadow};
                        z-index: 25000;
                        pointer-events: auto;
                        user-select: none;
                        opacity: 1;
                        transform: rotate(${randomRotation}deg);
                        cursor: pointer;
                        transition: transform 0.2s ease, opacity 0.2s ease;
                        max-width: ${isSmallMobile ? '200px' : isMobile ? '300px' : '400px'};
                        word-wrap: break-word;
                        text-align: center;
                    `;
                    
                    lookAtYouText.textContent = "LOOK AT YOU!";
                    
                    // Add click/touch to remove functionality
                    const removeText = () => {
                        if (document.body.contains(lookAtYouText)) {
                            lookAtYouText.style.transition = "opacity 0.3s ease-out, transform 0.3s ease-out";
                            lookAtYouText.style.opacity = "0";
                            lookAtYouText.style.transform = `rotate(${randomRotation}deg) scale(0.5)`;
                            setTimeout(() => {
                                if (document.body.contains(lookAtYouText)) {
                                    document.body.removeChild(lookAtYouText);
                                    // Remove from textElements array
                                    const index = textElements.indexOf(lookAtYouText);
                                    if (index > -1) {
                                        textElements.splice(index, 1);
                                    }
                                }
                            }, 300);
                        }
                    };
                    
                    // Add click to remove functionality
                    lookAtYouText.addEventListener('click', removeText);
                    
                    // Add hover/touch effects (responsive)
                    if (!isMobile) {
                        // Desktop hover effects
                        lookAtYouText.addEventListener('mouseenter', () => {
                            lookAtYouText.style.transform = `rotate(${randomRotation}deg) scale(1.1)`;
                        });
                        
                        lookAtYouText.addEventListener('mouseleave', () => {
                            lookAtYouText.style.transform = `rotate(${randomRotation}deg) scale(1)`;
                        });
                    } else {
                        // Mobile touch feedback and removal
                        let touchStartTime = 0;
                        
                        lookAtYouText.addEventListener('touchstart', (e) => {
                            touchStartTime = Date.now();
                            lookAtYouText.style.transform = `rotate(${randomRotation}deg) scale(1.05)`;
                        }, { passive: true });
                        
                        lookAtYouText.addEventListener('touchend', (e) => {
                            const touchDuration = Date.now() - touchStartTime;
                            
                            // If it's a quick tap (less than 300ms), remove the text
                            if (touchDuration < 300) {
                                removeText();
                            } else {
                                // Otherwise, just reset the scale
                                setTimeout(() => {
                                    if (document.body.contains(lookAtYouText)) {
                                        lookAtYouText.style.transform = `rotate(${randomRotation}deg) scale(1)`;
                                    }
                                }, 100);
                            }
                        }, { passive: true });
                        
                        // Prevent context menu on long press
                        lookAtYouText.addEventListener('contextmenu', (e) => {
                            e.preventDefault();
                        });
                    }
                    
                    document.body.appendChild(lookAtYouText);
                    textElements.push(lookAtYouText);
                    
                    textCount++;
                    
                    // Schedule next text
                    if (textCount < maxTexts) {
                        setTimeout(showLookAtYouText, interval);
                    }
                };
                
                // Set up midnight removal
                setupMidnightRemoval();
                
                // Start the effect after 3 seconds delay
                setTimeout(() => {
                    console.log("👀 Starting LOOK AT YOU! text display after 3 second delay...");
                    showLookAtYouText();
                }, 3000);
            }
            
            function removeAllZimaBlueSquares() {
                console.log("🔵 Removing all Zima Blue squares...");
                
                // Stop the Zima Blue system
                stopZimaBlueSystem();
                
                // Remove all existing squares from DOM
                const existingSquares = document.querySelectorAll('.zima-square');
                existingSquares.forEach(square => {
                    if (square.parentNode) {
                        square.parentNode.removeChild(square);
                    }
                });
                
                // Clear the zimaSquares array
                if (typeof zimaSquares !== 'undefined') {
                    zimaSquares.length = 0;
                }
                
                console.log("✅ All Zima Blue squares removed!");
            }
            
            function restoreOriginalContent() {
                console.log("🔄 Restoring original content...");
                
                // Restore English Phoebe's Wisdom
                const englishPhoebeTitle = document.querySelector('#englishContent .phoebe-title');
                const englishPhoebeQuote = document.querySelector('#englishContent .phoebe-quote');
                
                if (englishPhoebeTitle && englishPhoebeQuote) {
                    englishPhoebeTitle.textContent = "Phoebe's Wisdom";
                    englishPhoebeQuote.innerHTML = `
                        "Maybe this is what's meant to be.<br />
                        Like, maybe the universe has a plan for us."
                    `;
                }
                
                // Restore Chinese Phoebe section
                const chinesePhoebeTitle = document.querySelector('#chineseContent .phoebe-title');
                const chinesePhoebeQuote = document.querySelector('#chineseContent .phoebe-quote');
                
                if (chinesePhoebeTitle && chinesePhoebeQuote) {
                    chinesePhoebeTitle.textContent = "菲比的智慧";
                    chinesePhoebeQuote.innerHTML = `
                        "Maybe this is what's meant to be.<br />
                        也许这就是命中注定的<br />
                        Like, maybe the universe has a plan for us."<br />
                        也许宇宙对我们有它的安排
                    `;
                }
                
                // Restore English meditation content
                const englishMeditationText = document.querySelector('#englishContent .meditation-text');
                if (englishMeditationText) {
                    englishMeditationText.innerHTML = `
                        "Sometimes, it's difficult even for me<br />
                        to understand what I've become.<br />
                        And harder still to remember what I once was.<br />
                        The blue of the tiles...<br />
                        Zima Blue, the manufacturer called it.<br />
                        The first thing I ever saw.<br />
                        This was where I began.<br />
                        A crude little machine with<br />
                        barely enough intelligence to steer itself.<br />
                        But it was my world.<br />
                        It was all I knew, all I needed to know.<br />
                        And now?<br />
                        I will immerse myself.<br />
                        And as I do, I will slowly shut down my higher brain functions...<br />
                        un-making myself...<br />
                        leaving just enough to appreciate my surroundings...<br />
                        to extract some simple pleasure<br />
                        from the execution of a task well done.<br />
                        My search for truth is finished at last.<br />
                        I'm going home."
                    `;
                }
                
                // Restore Chinese meditation content
                const chineseMeditationText = document.querySelector('#chineseContent .meditation-text');
                if (chineseMeditationText) {
                    chineseMeditationText.innerHTML = `
                        "Sometimes, it's difficult even for me<br />
                        有时候 连我自己都很难理解<br />
                        to understand what I've become.<br />
                        我到底成为了什么<br />
                        And harder still to remember what I once was.<br />
                        更难记清楚我曾经是什么样子<br />
                        The blue of the tiles...<br />
                        瓷砖的蓝色<br />
                        Zima Blue, the manufacturer called it.<br />
                        齐马蓝 制作商这样称呼<br />
                        The first thing I ever saw.<br />
                        我见到的第一件物品<br />
                        This was where I began.<br />
                        一切从这里开始<br />
                        A crude little machine with<br />
                        一个简陋的小机器<br />
                        barely enough intelligence to steer itself.<br />
                        几乎没有足够智能操控自己<br />
                        But it was my world.<br />
                        但那是我的世界<br />
                        It was all I knew, all I needed to know.<br />
                        是我了解的一切 也是我需要了解的一切<br />
                        And now?<br />
                        现在呢<br />
                        I will immerse myself.<br />
                        我将浸入泳池<br />
                        And as I do, I will slowly shut down my higher brain functions...<br />
                        与此同时 我会逐渐关闭我的高级脑功能<br />
                        un-making myself...<br />
                        拆解自己<br />
                        leaving just enough to appreciate my surroundings...<br />
                        只留下必要的组件来欣赏周围环境<br />
                        to extract some simple pleasure<br />
                        从高效完成任务中<br />
                        from the execution of a task well done.<br />
                        感受简单的愉悦<br />
                        My search for truth is finished at last.<br />
                        我对真相的探索终于结束了<br />
                        I'm going home."<br />
                        我要回家了
                    `;
                }
                
                console.log("✅ Original content restored!");
            }
            
            function setSpecificQuote(cardIndex, quoteIndex) {
                const activeQuotes = isEnglish ? quotes.english : quotes.chinese;
                
                if (quoteIndex >= 0 && quoteIndex < activeQuotes.length) {
                    currentQuotes[cardIndex] = quoteIndex;
                    const quote = activeQuotes[quoteIndex];
                    
                    // Update the current language version
                    const currentCards = document.querySelectorAll(
                        isEnglish
                            ? "#englishContent .essence-card"
                            : "#chineseContent .essence-card",
                    );
                    
                    if (currentCards[cardIndex]) {
                        const titleEl = currentCards[cardIndex].querySelector(".essence-title");
                        const descEl = currentCards[cardIndex].querySelector(".essence-desc");
                        
                        if (isEnglish) {
                            titleEl.textContent = quote.en;
                            descEl.textContent = quote.source;
                        } else {
                            titleEl.textContent = quote.zh;
                            descEl.textContent = quote.source;
                        }
                    }
                }
                
                // Re-adapt font sizes after quote change
                setTimeout(() => {
                    adaptFontSizeResponsive();
                }, 100);
                
                // Check for easter eggs
                setTimeout(() => {
                    checkCyberpunkEasterEgg();
                    checkRoseQuoteEasterEgg();
                }, 200);
            }

            // 统一的section查找函数 - 提高代码复用性和解耦
            function findSectionElement(sectionId) {
                // 根据当前语言模式选择正确的容器
                const container = isEnglish ? '#englishContent' : '#chineseContent';
                
                // 对于所有section，都优先在当前语言容器中查找
                let section = document.querySelector(`${container} .${sectionId}`);
                
                // 如果在容器中没找到，尝试其他查找方式
                if (!section) {
                    // 对于带-section后缀的，尝试去掉后缀查找
                    if (sectionId.includes('-section')) {
                        const baseName = sectionId.replace('-section', '');
                        section = document.querySelector(`${container} .${baseName}`);
                    }
                    
                    // 如果还是没找到，尝试直接用ID查找（兼容旧版本）
                    if (!section) {
                        section = document.getElementById(sectionId);
                    }
                }
                
                return section;
            }

            // 无缝滚动功能 - 兼容Firefox和移动端
            function scrollToSection(sectionId) {
                const section = findSectionElement(sectionId);
                
                if (section) {
                    // 检测浏览器是否支持smooth scrolling
                    if ('scrollBehavior' in document.documentElement.style) {
                        section.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    } else {
                        // Firefox兼容性处理
                        const targetPosition = section.offsetTop;
                        smoothScrollTo(targetPosition);
                    }
                }
            }

            // 手动实现平滑滚动 - Firefox兼容
            function smoothScrollTo(targetPosition) {
                const startPosition = window.pageYOffset;
                const distance = targetPosition - startPosition;
                const duration = 800;
                let start = null;

                function animation(currentTime) {
                    if (start === null) start = currentTime;
                    const timeElapsed = currentTime - start;
                    const run = ease(timeElapsed, startPosition, distance, duration);
                    window.scrollTo(0, run);
                    if (timeElapsed < duration) requestAnimationFrame(animation);
                }

                function ease(t, b, c, d) {
                    t /= d / 2;
                    if (t < 1) return c / 2 * t * t + b;
                    t--;
                    return -c / 2 * (t * (t - 2) - 1) + b;
                }

                requestAnimationFrame(animation);
            }

            function scrollToTop() {
                // 检测浏览器是否支持smooth scrolling
                if ('scrollBehavior' in document.documentElement.style) {
                    window.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                } else {
                    // Firefox兼容性处理
                    smoothScrollTo(0);
                }
            }

            // 显示/隐藏回到顶部按钮
            window.addEventListener('scroll', function() {
                const backToTopBtn = document.querySelector('.back-to-top');
                if (backToTopBtn) {
                    if (window.pageYOffset > 300) {
                        backToTopBtn.style.opacity = '1';
                        backToTopBtn.style.visibility = 'visible';
                    } else {
                        backToTopBtn.style.opacity = '0';
                        backToTopBtn.style.visibility = 'hidden';
                    }
                }
            });

            // 导航点高亮 - 使用统一的section查找函数
            window.addEventListener('scroll', function() {
                const sections = ['header', 'color-display', 'quote-section', 'meditation', 'essence', 'phoebe-section'];
                const navDots = document.querySelectorAll('.nav-dot');
                
                let currentSection = '';
                sections.forEach(sectionId => {
                    const section = findSectionElement(sectionId);
                    if (section) {
                        const rect = section.getBoundingClientRect();
                        if (rect.top <= 100 && rect.bottom >= 100) {
                            currentSection = sectionId;
                        }
                    }
                });
                
                navDots.forEach((dot, index) => {
                    if (sections[index] === currentSection) {
                        dot.classList.add('active');
                    } else {
                        dot.classList.remove('active');
                    }
                });
            });

            // Meditation click tracker for JOJO easter egg
            const meditationClickTracker = {
                clicks: [],
                timeWindow: 2000, // 2 seconds
                requiredClicks: 4,
                isJojoPlaying: false,
                delayTimer: null, // Timer for delay check
                delayTime: 500 // 500ms delay to ensure user finished clicking
            };

            // 初始化导航点事件监听器 - 兼容性更好
            document.addEventListener('DOMContentLoaded', function() {
                const navDots = document.querySelectorAll('.nav-dot');
                navDots.forEach(dot => {
                    const sectionId = dot.getAttribute('data-section');
                    if (sectionId) {
                        // 添加点击事件
                        dot.addEventListener('click', function(e) {
                            e.preventDefault();
                            
                            // Special handling for meditation dot (4th dot)
                            if (sectionId === 'meditation') {
                                handleMeditationClick();
                            } else {
                                scrollToSection(sectionId);
                            }
                        });
                        
                        // 添加触屏事件支持 - 移动端兼容
                        dot.addEventListener('touchend', function(e) {
                            e.preventDefault();
                            
                            // Special handling for meditation dot (4th dot)
                            if (sectionId === 'meditation') {
                                handleMeditationClick();
                            } else {
                                scrollToSection(sectionId);
                            }
                        });
                        
                        // 添加键盘支持 - 无障碍访问
                        dot.addEventListener('keydown', function(e) {
                            if (e.key === 'Enter' || e.key === ' ') {
                                e.preventDefault();
                                if (sectionId === 'meditation') {
                                    handleMeditationClick();
                                } else {
                                    scrollToSection(sectionId);
                                }
                            }
                        });
                        
                        // 添加tabindex使其可聚焦
                        dot.setAttribute('tabindex', '0');
                        dot.setAttribute('role', 'button');
                        dot.setAttribute('aria-label', `跳转到${dot.getAttribute('data-tooltip')}部分`);
                    }
                });
                
                // 初始化回到顶部按钮
                const backToTopBtn = document.getElementById('backToTopBtn');
                if (backToTopBtn) {
                    backToTopBtn.addEventListener('click', function(e) {
                        e.preventDefault();
                        scrollToTop();
                    });
                    
                    backToTopBtn.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        scrollToTop();
                    });
                    
                    backToTopBtn.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            scrollToTop();
                        }
                    });
                }
            });
        </script>

        <!-- Cyberpunk 2077 Easter Egg -->
        <div id="cyberpunkEasterEgg" class="cyberpunk-easter-egg">
            <div class="cyberpunk-content">
                <div class="cyberpunk-text">CYBERPUNK: EDGERUNNERS</div>
                <img src="./phoebe/cyberpunk-edgerunners.gif" alt="Cyberpunk Edgerunners" class="cyberpunk-image" />
            </div>
        </div>

        <!-- Audio Control Panel -->
        <div id="audioControlPanel" class="audio-control-panel">
            <!-- Audio Playlist Sidebar -->
            <div id="audioPlaylistSidebar" class="audio-playlist-sidebar">
                <div id="playlistItems" class="playlist-items">
                    <!-- Playlist items will be populated by JavaScript -->
                </div>
            </div>
            
            <button id="audioControlBtn" class="audio-control-btn">
                <svg class="play-icon" viewBox="0 0 24 24">
                    <path d="M8 5v14l11-7z"/>
                </svg>
                <svg class="pause-icon" viewBox="0 0 24 24" style="display: none;">
                    <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
            </button>
            
            <!-- Play Mode Control Button -->
            <button id="playModeBtn" class="audio-control-btn play-mode-btn" title="播放模式" data-mode="stop">
                <svg class="mode-icon" viewBox="0 0 24 24">
                    <path d="M6 6h12v12H6z"/>
                </svg>
            </button>
        </div>

        <!-- Hidden Audio Element -->
        <audio id="cyberpunkAudio" preload="none">
            <source src="" type="audio/mpeg">
        </audio>

        <!-- Virtual Keyboard for Mobile -->
        <div id="virtualKeyboard" class="virtual-keyboard hidden">
            <div class="keyboard-header">
            </div>
            <div class="resize-handle"></div>
            <div class="keyboard-keys">
                <div class="key-row">
                    <button class="key" data-key="1">1</button>
                    <button class="key" data-key="2">2</button>
                    <button class="key" data-key="3">3</button>
                    <button class="key" data-key="4">4</button>
                    <button class="key" data-key="5">5</button>
                    <button class="key" data-key="6">6</button>
                    <button class="key" data-key="7">7</button>
                    <button class="key" data-key="8">8</button>
                    <button class="key" data-key="9">9</button>
                    <button class="key" data-key="0">0</button>
                </div>
                <div class="key-row">
                    <button class="key" data-key="q">Q</button>
                    <button class="key" data-key="w">W</button>
                    <button class="key" data-key="e">E</button>
                    <button class="key" data-key="r">R</button>
                    <button class="key" data-key="t">T</button>
                    <button class="key" data-key="y">Y</button>
                    <button class="key" data-key="u">U</button>
                    <button class="key" data-key="i">I</button>
                    <button class="key" data-key="o">O</button>
                    <button class="key" data-key="p">P</button>
                </div>
                <div class="key-row">
                    <button class="key" data-key="a">A</button>
                    <button class="key" data-key="s">S</button>
                    <button class="key" data-key="d">D</button>
                    <button class="key" data-key="f">F</button>
                    <button class="key" data-key="g">G</button>
                    <button class="key" data-key="h">H</button>
                    <button class="key" data-key="j">J</button>
                    <button class="key" data-key="k">K</button>
                    <button class="key" data-key="l">L</button>
                </div>
                <div class="key-row">
                    <button class="key" data-key="z">Z</button>
                    <button class="key" data-key="x">X</button>
                    <button class="key" data-key="c">C</button>
                    <button class="key" data-key="v">V</button>
                    <button class="key" data-key="b">B</button>
                    <button class="key" data-key="n">N</button>
                    <button class="key" data-key="m">M</button>
                </div>
                <div class="key-row arrow-keys">
                    <button class="key arrow-key" data-key="ArrowUp">↑</button>
                    <button class="key arrow-key" data-key="ArrowDown">↓</button>
                    <button class="key arrow-key" data-key="ArrowLeft">←</button>
                    <button class="key arrow-key" data-key="ArrowRight">→</button>
                </div>
            </div>
        </div>



        <!-- Debug Panel -->
        <button id="debugToggle" class="debug-toggle"><span id="debugButton">Debug</span></button>
        <div id="debugPanel" class="debug-panel">
            <h4>Debug Panel</h4>
            <p><strong>Target:</strong> Match all 3 cards</p>
            <div class="easter-egg-hint">
                Tip: Click cards to change quotes
            </div>

            <div class="quick-set-buttons">
                <button id="setCyberpunkBtn" class="quick-set-btn" title="Set all cards to Cyberpunk content">Set Cyberpunk</button>
                <button id="setRoseBtn" class="quick-set-btn" title="Set all cards to Rose quote content">Set Rose Quote</button>
                <button id="triggerRunawayBtn" class="quick-set-btn" title="Trigger Runaway effect">Trigger Runaway</button>
                <button id="triggerJojoBtn" class="quick-set-btn" title="Trigger Jojo easter egg">Trigger Jojo</button>
                <button id="triggerZoteBtn" class="quick-set-btn" title="Trigger Zote easter egg">Trigger Zote</button>
                <button id="increaseZoteCycleBtn" class="quick-set-btn" title="Increase Zote cycle count">+Zote Cycle</button>
            </div>
            
            <div class="easter-egg-controls">
                <h5>States</h5>
                <div class="egg-state-buttons">
                    <button id="toggleLangBtn" class="state-btn" title="Toggle language switch">Lang</button>
                    <button id="togglePengBtn" class="state-btn" title="Toggle peng click">Peng</button>
                    <button id="toggleTributeBtn" class="state-btn" title="Toggle tribute click">Tribute</button>
                    <button id="toggleEssenceBtn" class="state-btn" title="Toggle essence card">Essence</button>
                    <button id="toggleWisdomBtn" class="state-btn" title="Toggle wisdom">Wisdom</button>
                    <button id="toggleBossBtn" class="state-btn" title="Toggle boss">Boss</button>
                    <button id="toggleEmailBtn" class="state-btn" title="Toggle email">Email</button>
                    <button id="toggleWechatBtn" class="state-btn" title="Toggle wechat">WeChat</button>
                </div>
                <div class="egg-state-buttons">
                    <button id="toggleCyberpunkBtn" class="state-btn" title="Toggle cyberpunk">Cyberpunk</button>
                    <button id="toggleZoteBtn" class="state-btn" title="Toggle zote">Zote</button>
                    <button id="toggleZeldaBtn" class="state-btn" title="Toggle zelda">Zelda</button>
                    <button id="toggleRunawayBtn" class="state-btn" title="Toggle runaway">Runaway</button>
                    <button id="toggleSmellyCatBtn" class="state-btn" title="Toggle smelly cat">Cat</button>
                    <button id="toggleRoseBtn" class="state-btn" title="Toggle rose quote">Rose</button>
                </div>
                <div class="egg-state-buttons">
                    <button id="resetAllBtn" class="state-btn reset-btn" title="Reset all states">Reset</button>
                    <button id="triggerAllBtn" class="state-btn trigger-btn" title="Trigger all states">Trigger</button>
                </div>

            </div>
            
            <div id="currentQuotes" class="current-quotes">
                <p><strong>Cards:</strong></p>
                <div id="quotesList"></div>
            </div>
        </div>

        <script>
            // Virtual Keyboard Functionality
            class VirtualKeyboard {
                constructor() {
                    this.keyboard = document.getElementById('virtualKeyboard');
                    this.keys = document.querySelectorAll('.key');
                    this.mainTitles = document.querySelectorAll('.main-title');
                    
                    this.isVisible = false;
                    this.clickCount = 0;
                    this.clickTimer = null;
                    this.isFirstOpen = true;
                    
                    // Dragging properties
                    this.isDragging = false;
                    this.dragStartX = 0;
                    this.dragStartY = 0;
                    this.keyboardStartX = 0;
                    this.keyboardStartY = 0;
                    
                    // Resizing properties
                    this.isResizing = false;
                    this.resizeStartX = 0;
                    this.keyboardStartWidth = 0;
                    
                    this.init();
                }
                
                init() {
                    // Check if device is mobile
                    this.checkMobileDevice();
                    
                    // Bind events
                    this.bindEvents();
                }
                
                checkMobileDevice() {
                    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                                   (window.matchMedia && window.matchMedia('(hover: none) and (pointer: coarse)').matches);
                    
                    this.isMobileDevice = isMobile;
                    
                    if (isMobile) {
                        console.log('📱 Mobile device detected, virtual keyboard enabled');
                    } else {
                        this.keyboard.classList.add('hidden');
                        this.keyboard.style.display = 'none'; // 完全隐藏虚拟键盘
                        console.log('🖥️ Desktop device detected, virtual keyboard completely disabled');
                    }
                }
                
                bindEvents() {
                    // Only bind events if on mobile device
                    if (!this.isMobileDevice) {
                        console.log('🖥️ Desktop detected: Virtual keyboard events disabled');
                        return;
                    }
                    
                    // Main title triple click for first open, single click for toggle
                    this.mainTitles.forEach(mainTitle => {
                        const handleTitleInteraction = (e) => {
                            e.preventDefault();
                            
                            if (this.isFirstOpen) {
                                // First time: require triple click
                                this.clickCount++;
                                
                                if (this.clickTimer) {
                                    clearTimeout(this.clickTimer);
                                }
                                
                                this.clickTimer = setTimeout(() => {
                                    this.clickCount = 0;
                                }, 500); // Reset after 500ms
                                
                                if (this.clickCount >= 3) {
                                    this.clickCount = 0;
                                    this.isFirstOpen = false;
                                    this.showKeyboard();
                                    console.log('🎹 Virtual keyboard activated with triple click');
                                }
                            } else {
                                // After first open: single click to toggle
                                this.toggleKeyboard();
                            }
                        };
                        
                        mainTitle.addEventListener('click', handleTitleInteraction);
                        mainTitle.addEventListener('touchend', handleTitleInteraction);
                    });
                    
                    // Key clicks
                    this.keys.forEach(key => {
                        key.addEventListener('click', () => {
                            const keyValue = key.getAttribute('data-key');
                            this.simulateKeyPress(keyValue);
                        });
                        
                        key.addEventListener('touchend', (e) => {
                            e.preventDefault();
                            const keyValue = key.getAttribute('data-key');
                            this.simulateKeyPress(keyValue);
                        });
                    });
                    
                    // Dragging events
                    this.bindDragEvents();
                    
                    // Resizing events
                    this.bindResizeEvents();
                    
                    // Click outside to close
                    document.addEventListener('click', (e) => {
                        if (this.isVisible && 
                            !this.keyboard.contains(e.target) && 
                            !Array.from(this.mainTitles).some(title => title.contains(e.target))) {
                            this.hideKeyboard();
                        }
                    });
                    
                    // Prevent keyboard from closing when clicking inside
                    this.keyboard.addEventListener('click', (e) => {
                        e.stopPropagation();
                    });
                }
                
                bindDragEvents() {
                    const header = this.keyboard.querySelector('.keyboard-header');
                    if (!header) return;
                    
                    // Mouse events
                    header.addEventListener('mousedown', (e) => {
                        this.startDrag(e.clientX, e.clientY);
                        e.preventDefault();
                    });
                    
                    document.addEventListener('mousemove', (e) => {
                        if (this.isDragging) {
                            this.drag(e.clientX, e.clientY);
                        }
                    });
                    
                    document.addEventListener('mouseup', () => {
                        this.stopDrag();
                    });
                    
                    // Touch events
                    header.addEventListener('touchstart', (e) => {
                        const touch = e.touches[0];
                        this.startDrag(touch.clientX, touch.clientY);
                        e.preventDefault();
                    }, { passive: false });
                    
                    document.addEventListener('touchmove', (e) => {
                        if (this.isDragging && e.touches.length > 0) {
                            const touch = e.touches[0];
                            this.drag(touch.clientX, touch.clientY);
                            e.preventDefault();
                        }
                    }, { passive: false });
                    
                    document.addEventListener('touchend', () => {
                        this.stopDrag();
                    });
                }
                
                bindResizeEvents() {
                    const resizeHandle = this.keyboard.querySelector('.resize-handle');
                    if (!resizeHandle) return;
                    
                    // Mouse events
                    resizeHandle.addEventListener('mousedown', (e) => {
                        this.startResize(e.clientX);
                        e.preventDefault();
                        e.stopPropagation();
                    });
                    
                    document.addEventListener('mousemove', (e) => {
                        if (this.isResizing) {
                            this.resize(e.clientX);
                        }
                    });
                    
                    document.addEventListener('mouseup', () => {
                        this.stopResize();
                    });
                    
                    // Touch events
                    resizeHandle.addEventListener('touchstart', (e) => {
                        const touch = e.touches[0];
                        this.startResize(touch.clientX);
                        e.preventDefault();
                        e.stopPropagation();
                    }, { passive: false });
                    
                    document.addEventListener('touchmove', (e) => {
                        if (this.isResizing && e.touches.length > 0) {
                            const touch = e.touches[0];
                            this.resize(touch.clientX);
                            e.preventDefault();
                        }
                    }, { passive: false });
                    
                    document.addEventListener('touchend', () => {
                        this.stopResize();
                    });
                }
                
                startDrag(clientX, clientY) {
                    this.isDragging = true;
                    this.dragStartX = clientX;
                    this.dragStartY = clientY;
                    
                    const rect = this.keyboard.getBoundingClientRect();
                    this.keyboardStartX = rect.left;
                    this.keyboardStartY = rect.top;
                    
                    this.keyboard.style.transition = 'none';
                    document.body.style.userSelect = 'none';
                }
                
                drag(clientX, clientY) {
                    if (!this.isDragging) return;
                    
                    const deltaX = clientX - this.dragStartX;
                    const deltaY = clientY - this.dragStartY;
                    
                    let newX = this.keyboardStartX + deltaX;
                    let newY = this.keyboardStartY + deltaY;
                    
                    // Constrain to viewport
                    const rect = this.keyboard.getBoundingClientRect();
                    const maxX = window.innerWidth - rect.width;
                    const maxY = window.innerHeight - rect.height;
                    
                    newX = Math.max(0, Math.min(newX, maxX));
                    newY = Math.max(0, Math.min(newY, maxY));
                    
                    this.keyboard.style.left = newX + 'px';
                    this.keyboard.style.top = newY + 'px';
                    this.keyboard.style.bottom = 'auto';
                }
                
                stopDrag() {
                    if (this.isDragging) {
                        this.isDragging = false;
                        this.keyboard.style.transition = 'transform 0.3s ease-in-out';
                        document.body.style.userSelect = '';
                    }
                }
                
                startResize(clientX) {
                    this.isResizing = true;
                    this.resizeStartX = clientX;
                    this.keyboardStartWidth = this.keyboard.offsetWidth;
                    
                    this.keyboard.style.transition = 'none';
                    document.body.style.userSelect = 'none';
                }
                
                resize(clientX) {
                    if (!this.isResizing) return;
                    
                    const deltaX = clientX - this.resizeStartX;
                    let newWidth = this.keyboardStartWidth + deltaX;
                    
                    // Constrain width
                    const minWidth = 300;
                    const maxWidth = window.innerWidth - 20;
                    
                    newWidth = Math.max(minWidth, Math.min(newWidth, maxWidth));
                    
                    this.keyboard.style.width = newWidth + 'px';
                }
                
                stopResize() {
                    if (this.isResizing) {
                        this.isResizing = false;
                        this.keyboard.style.transition = 'transform 0.3s ease-in-out';
                        document.body.style.userSelect = '';
                    }
                }
                
                toggleKeyboard() {
                    // 只在移动设备上允许切换虚拟键盘
                    if (!this.isMobileDevice) {
                        console.log('🖥️ Desktop detected: Virtual keyboard toggle disabled');
                        return;
                    }
                    
                    if (this.isVisible) {
                        this.hideKeyboard();
                    } else {
                        this.showKeyboard();
                    }
                }
                
                showKeyboard() {
                    // 只在移动设备上显示虚拟键盘
                    if (!this.isMobileDevice) {
                        console.log('🖥️ Desktop detected: Virtual keyboard cannot be shown');
                        return;
                    }
                    
                    this.keyboard.classList.remove('hidden');
                    this.keyboard.style.display = 'block';
                    this.isVisible = true;
                    
                    // Add animation class after a brief delay
                    setTimeout(() => {
                        this.keyboard.style.transform = 'translateY(0)';
                    }, 10);
                    
                    console.log('⌨️ Virtual keyboard shown');
                }
                
                hideKeyboard() {
                    this.keyboard.style.transform = 'translateY(100%)';
                    
                    setTimeout(() => {
                        this.keyboard.classList.add('hidden');
                        this.isVisible = false;
                    }, 300);
                    
                    console.log('⌨️ Virtual keyboard hidden');
                }
                
                simulateKeyPress(keyValue) {
                    // Add visual feedback
                    const keyElement = document.querySelector(`[data-key="${keyValue}"]`);
                    if (keyElement) {
                        keyElement.style.transform = 'scale(0.95)';
                        setTimeout(() => {
                            keyElement.style.transform = '';
                        }, 100);
                    }
                    
                    // Create and dispatch keyboard event
                    let event;
                    
                    if (keyValue.startsWith('Arrow')) {
                        // Handle arrow keys
                        event = new KeyboardEvent('keydown', {
                            key: keyValue,
                            code: keyValue,
                            keyCode: this.getArrowKeyCode(keyValue),
                            which: this.getArrowKeyCode(keyValue),
                            bubbles: true
                        });
                    } else {
                        // Handle letter and number keys
                        const key = keyValue.toLowerCase();
                        event = new KeyboardEvent('keydown', {
                            key: key,
                            code: isNaN(key) ? `Key${key.toUpperCase()}` : `Digit${key}`,
                            keyCode: key.toUpperCase().charCodeAt(0),
                            which: key.toUpperCase().charCodeAt(0),
                            bubbles: true
                        });
                    }
                    
                    // Dispatch the event to trigger existing handlers
                    document.dispatchEvent(event);
                    
                    console.log(`⌨️ Simulated key press: ${keyValue}`);
                }
                
                getArrowKeyCode(arrowKey) {
                    const codes = {
                        'ArrowUp': 38,
                        'ArrowDown': 40,
                        'ArrowLeft': 37,
                        'ArrowRight': 39
                    };
                    return codes[arrowKey] || 0;
                }

            }
            
            // Handle meditation dot clicks for JOJO easter egg
            // 中文模式下复用英文的4下点击逻辑
            function handleMeditationClick() {
                const now = Date.now();
                
                // Add current click time
                meditationClickTracker.clicks.push(now);
                
                // Remove clicks outside the time window
                meditationClickTracker.clicks = meditationClickTracker.clicks.filter(
                    clickTime => now - clickTime <= meditationClickTracker.timeWindow
                );
                
                console.log(`Meditation clicks: ${meditationClickTracker.clicks.length}/${meditationClickTracker.requiredClicks}`);
                
                // Clear any existing delay timer
                if (meditationClickTracker.delayTimer) {
                    clearTimeout(meditationClickTracker.delayTimer);
                    meditationClickTracker.delayTimer = null;
                }
                
                // Check if we have exactly 4 clicks within the time window
                if (meditationClickTracker.clicks.length === meditationClickTracker.requiredClicks) {
                    // Set a delay timer to check if user stops clicking
                    meditationClickTracker.delayTimer = setTimeout(() => {
                        // Double check we still have exactly 4 clicks and no more
                        const currentTime = Date.now();
                        const validClicks = meditationClickTracker.clicks.filter(
                            clickTime => currentTime - clickTime <= meditationClickTracker.timeWindow
                        );
                        
                        if (validClicks.length === meditationClickTracker.requiredClicks && !meditationClickTracker.isJojoPlaying) {
                            // 中文和英文模式统一调用相同的触发函数
                            triggerJojoEasterEgg();
                            // Reset clicks after triggering
                            meditationClickTracker.clicks = [];
                        }
                        meditationClickTracker.delayTimer = null;
                    }, meditationClickTracker.delayTime);
                } else if (meditationClickTracker.clicks.length > meditationClickTracker.requiredClicks) {
                    // Reset if more than 4 clicks
                    meditationClickTracker.clicks = [];
                    console.log('Too many clicks, resetting meditation click tracker');
                } else {
                    // Normal scroll behavior for less than 4 clicks
                    scrollToSection('meditation');
                }
            }
            
            // Trigger JOJO easter egg
            // 中文和英文模式统一使用此函数，确保逻辑一致
            function triggerJojoEasterEgg() {
                meditationClickTracker.isJojoPlaying = true;
                
                // Add JOJO audio to playlist
                const jojoAudioData = {
                    name: "JOJO's Bizarre Adventure",
                    src: "./phoebe/jojo.mp3",
                    type: "Easter Egg"
                };
                
                try {
                    // Add to playlist and it will auto-play
                    addAudioToPlaylist(jojoAudioData);
                    
                    // Ensure we have the audio element
                    if (!cyberpunkAudio) {
                        cyberpunkAudio = document.getElementById('cyberpunkAudio');
                    }
                    
                    // Reset flag when audio ends and add time listener for text effects
                    if (cyberpunkAudio) {
                        // Flag to prevent multiple triggers
                        let jojoTextTriggered = false;
                        
                        cyberpunkAudio.addEventListener('ended', () => {
                             meditationClickTracker.isJojoPlaying = false;
                        firstJojoTextTriggered = false; // Reset for next play
                        secondJojoTextTriggered = false; // Reset for next play
                        });
                        
                        // Add time listener for JOJO text effects at 18.5 and 26 seconds
                        let firstJojoTextTriggered = false;
                        let secondJojoTextTriggered = false;
                        
                        cyberpunkAudio.addEventListener('timeupdate', () => {
                            // Only trigger JOJO text effects when actually playing jojo.mp3
                            const currentAudio = audioPlaylist[currentAudioIndex];
                            if (currentAudio && currentAudio.src === "./phoebe/jojo.mp3") {
                                // First display at 18.5 seconds
                                if (!firstJojoTextTriggered && cyberpunkAudio.currentTime >= 18.5) {
                                    firstJojoTextTriggered = true;
                                    showJojoTextEffects();
                                }
                                // Second display at 25.5 seconds
                                if (!secondJojoTextTriggered && cyberpunkAudio.currentTime >= 25.5) {
                                    secondJojoTextTriggered = true;
                                    showJojoTextEffects();
                                }
                            }
                        });
                    }
                    
                    // Force play if auto-play failed (backup method)
                    setTimeout(() => {
                        if (cyberpunkAudio && cyberpunkAudio.paused) {
                            cyberpunkAudio.play().then(() => {
                                isAudioPlaying = true;
                                updateAudioButton();
                            }).catch(error => {
                                // Silent fail
                            });
                        }
                    }, 200);
                    
                } catch (error) {
                    console.error('Failed to add JOJO audio to playlist:', error);
                    meditationClickTracker.isJojoPlaying = false;
                }
            }
            
            // Show JOJO text effects at 19 seconds
            function showJojoTextEffects() {
                console.log('✨ Showing JOJO text effects at 19 seconds!');
                
                let textCount = 0;
                const maxTexts = 2; // Only show twice
                const interval = 800; // 0.8 seconds between displays
                
                const showJojoText = () => {
                    if (textCount >= maxTexts) {
                        console.log('✨ JOJO text effects completed!');
                        return;
                    }
                    
                    // Create JOJO text element
                    const jojoText = document.createElement('div');
                    
                    // Responsive design
                    const isMobile = window.innerWidth <= 768;
                    const isSmallMobile = window.innerWidth <= 480;
                    
                    // Center positioning
                    const centerX = window.innerWidth / 2;
                    const centerY = window.innerHeight / 2;
                    
                    // Different effects for first and second display
                    let fontSize, animation, duration;
                    
                    if (textCount === 0) {
                        // First display: smaller text with fade effect
                        if (isSmallMobile) {
                            fontSize = 40;
                        } else if (isMobile) {
                            fontSize = 60;
                        } else {
                            fontSize = 80;
                        }
                        animation = 'jojoFadeInOut 1.5s ease-in-out';
                        duration = 1500;
                    } else {
                        // Second display: full screen with explosive shake effect
                        // Calculate font size to fill the entire screen
                        const screenWidth = window.innerWidth;
                        const screenHeight = window.innerHeight;
                        
                        if (isSmallMobile) {
                            // For small mobile, use 60% of screen width or 50% of screen height, whichever is smaller
                            fontSize = Math.min(screenWidth * 0.6, screenHeight * 0.5);
                        } else if (isMobile) {
                            // For mobile, use 70% of screen width or 60% of screen height, whichever is smaller
                            fontSize = Math.min(screenWidth * 0.7, screenHeight * 0.6);
                        } else {
                            // For desktop, use 80% of screen width or 70% of screen height, whichever is smaller
                            fontSize = Math.min(screenWidth * 0.8, screenHeight * 0.7);
                        }
                        
                        // Ensure minimum readable size but allow very large sizes
                        fontSize = Math.max(fontSize, 100);
                        
                        animation = 'jojoExplosiveShake 2s ease-out';
                        duration = 2000;
                    }
                    
                    // Responsive text shadow
                    const textShadow = isSmallMobile 
                        ? "2px 2px 4px rgba(0,0,0,0.8), 0 0 10px rgba(255,255,255,0.5)"
                        : isMobile 
                        ? "3px 3px 6px rgba(0,0,0,0.8), 0 0 15px rgba(255,255,255,0.5)"
                        : "4px 4px 8px rgba(0,0,0,0.8), 0 0 20px rgba(255,255,255,0.5)";
                    
                    jojoText.style.cssText = `
                        position: fixed;
                        left: 50%;
                        top: 50%;
                        transform: translate(-50%, -50%);
                        color: white;
                        font-family: "Impact", "Arial Black", sans-serif;
                        font-size: ${fontSize}px;
                        font-weight: 900;
                        text-shadow: ${textShadow};
                        z-index: 25000;
                        pointer-events: none;
                        user-select: none;
                        opacity: 1;
                        text-align: center;
                        animation: ${animation};
                    `;
                    
                    jojoText.textContent = 'JO!';
                    
                    document.body.appendChild(jojoText);
                    
                    // Remove after animation
                    setTimeout(() => {
                        if (document.body.contains(jojoText)) {
                            document.body.removeChild(jojoText);
                        }
                    }, duration);
                    
                    textCount++;
                    
                    // Schedule next text
                    if (textCount < maxTexts) {
                        setTimeout(showJojoText, interval);
                    }
                };
                
                // Start showing JOJO text
                showJojoText();
            }

            
            // Initialize virtual keyboard when DOM is loaded
            document.addEventListener('DOMContentLoaded', () => {
                const virtualKeyboard = new VirtualKeyboard();
                console.log('🎹 Virtual keyboard initialized');
            });
            
            // Re-check mobile device on window resize
            window.addEventListener('resize', () => {
                const keyboard = document.getElementById('virtualKeyboard');
                
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                               (window.matchMedia && window.matchMedia('(hover: none) and (pointer: coarse)').matches);
                
                if (!isMobile) {
                    keyboard.classList.add('hidden');
                    keyboard.style.display = 'none'; // 完全隐藏虚拟键盘
                    console.log('🖥️ Window resize: Virtual keyboard disabled on desktop');
                } else {
                    keyboard.style.display = 'block'; // 在移动设备上恢复显示
                }
            });
        </script>

        <!-- 无缝滚动JavaScript代码 -->
        <script>
        document.addEventListener('DOMContentLoaded', function () {
            const container = document.getElementById('infinite-scroll-container');
            const content = container.querySelector('.container');
            const contentHTML = content.innerHTML;

            // 在前面复制一份
            const before = document.createElement('div');
            before.className = 'container';
            before.innerHTML = contentHTML;
            container.insertBefore(before, content);

            // 在后面复制一份
            const after = document.createElement('div');
            after.className = 'container';
            after.innerHTML = contentHTML;
            container.appendChild(after);

            // 计算内容高度
            function getContentHeight() {
                return content.offsetHeight;
            }

            // 初始滚动到中间（原始内容位置）
            function setInitialScroll() {
                const contentHeight = getContentHeight();
                container.scrollTop = contentHeight;
            }
            setTimeout(setInitialScroll, 100);

            // 监听滚动，循环调整
            let isJumping = false;
            container.addEventListener('scroll', function () {
                if (isJumping) return;
                
                const contentHeight = getContentHeight();
                const scrollTop = container.scrollTop;
                const containerHeight = container.clientHeight;
                const totalHeight = contentHeight * 3;
                
                // 更精确的边界检测
                if (scrollTop <= 3) {
                    // 滚动到最顶部，跳到第二份内容的相应位置
                    isJumping = true;
                    container.scrollTop = contentHeight * 2 + scrollTop;
                    setTimeout(() => { isJumping = false; }, 30);
                } else if (scrollTop >= totalHeight - containerHeight - 3) {
                    // 滚动到最底部，跳到第一份内容的相应位置
                    isJumping = true;
                    // 计算在当前内容中的相对位置
                    const relativePosition = scrollTop - (contentHeight * 2);
                    container.scrollTop = contentHeight + relativePosition;
                    setTimeout(() => { isJumping = false; }, 30);
                }
            });

            // 窗口大小变化时重新定位
            window.addEventListener('resize', function () {
                setTimeout(setInitialScroll, 100);
            });
        });
        </script>
        </div> <!-- 关闭 infinite-scroll-container -->
    </body>
</html>
</text>
